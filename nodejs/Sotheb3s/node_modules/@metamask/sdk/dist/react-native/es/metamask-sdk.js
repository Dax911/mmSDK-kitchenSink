import e,{Buffer as t}from"buffer";import n from"crypto";import r from"events";import i,{Duplex as o}from"stream";import s from"@react-native-async-storage/async-storage";function a(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function c(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function d(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}"function"==typeof SuppressedError&&SuppressedError;var u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function h(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var f={},l={},A={};const{Buffer:p}=e,{createHash:b,createHmac:m}=n,g={},v=e=>{switch(e){case"sha256":case"sha3-256":case"blake2s256":return 32;case"sha512":case"sha3-512":case"blake2b512":return 64;case"sha224":case"sha3-224":return 28;case"sha384":case"sha3-384":return 48;case"sha1":return 20;case"md5":return 16;default:{let t=g[e];return void 0===t&&(t=b(e).digest().length,g[e]=t),t}}},y=(e,t,n,r)=>{const i=p.isBuffer(n)?n:p.from(n),o=r&&r.length?p.from(r):p.alloc(t,0);return m(e,o).update(i).digest()},w=(e,t,n,r,i)=>{const o=p.isBuffer(i)?i:p.from(i||""),s=o.length,a=Math.ceil(r/t);if(a>255)throw new Error(`OKM length ${r} is too long for ${e} hash`);const c=p.alloc(t*a+s+1);for(let r=1,i=0,d=0;r<=a;++r)o.copy(c,d),c[d+s]=r,m(e,n).update(c.slice(i,d+s+1)).digest().copy(c,d),i=d,d+=t;return c.slice(0,r)};function _(e,t,{salt:n="",info:r="",hash:i="SHA-256"}={}){i=i.toLowerCase().replace("-","");const o=v(i),s=y(i,o,e,n);return w(i,o,s,t,r)}Object.defineProperties(_,{hash_length:{configurable:!1,enumerable:!1,writable:!1,value:v},extract:{configurable:!1,enumerable:!1,writable:!1,value:y},expand:{configurable:!1,enumerable:!1,writable:!1,value:w}});var M=_;const E="Impossible case. Please create issue.",S="The tweak was out of range or the resulted private key is invalid",k="The tweak was out of range or equal to zero",C="Public Key could not be parsed",I="Public Key serialization error",x="Signature could not be parsed";function O(e,t){if(!e)throw new Error(t)}function R(e,t,n){if(O(t instanceof Uint8Array,`Expected ${e} to be an Uint8Array`),void 0!==n)if(Array.isArray(n)){const r=`Expected ${e} to be an Uint8Array with length [${n.join(", ")}]`;O(n.includes(t.length),r)}else{const r=`Expected ${e} to be an Uint8Array with length ${n}`;O(t.length===n,r)}}function P(e){O("Boolean"===N(e),"Expected compressed to be a Boolean")}function T(e=(e=>new Uint8Array(e)),t){return"function"==typeof e&&(e=e(t)),R("output",e,t),e}function N(e){return Object.prototype.toString.call(e).slice(8,-1)}var L={},B={},D={exports:{}},j=function(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n}(Object.freeze({__proto__:null,default:{}}));!function(e,t){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function i(e,t,n){if(i.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(n=t,t=10),this._init(e||0,t||10,n||"be"))}var o;"object"==typeof D?D.exports=i:t.BN=i,i.BN=i,i.wordSize=26;try{o="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:j.Buffer}catch(e){}function s(e,t){var n=e.charCodeAt(t);return n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:n-48&15}function a(e,t,n){var r=s(e,n);return n-1>=t&&(r|=s(e,n-1)<<4),r}function c(e,t,n,r){for(var i=0,o=Math.min(e.length,n),s=t;s<o;s++){var a=e.charCodeAt(s)-48;i*=r,i+=a>=49?a-49+10:a>=17?a-17+10:a}return i}i.isBN=function(e){return e instanceof i||null!==e&&"object"==typeof e&&e.constructor.wordSize===i.wordSize&&Array.isArray(e.words)},i.max=function(e,t){return e.cmp(t)>0?e:t},i.min=function(e,t){return e.cmp(t)<0?e:t},i.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},i.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},i.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,s,a=0;if("be"===r)for(i=e.length-1,o=0;i>=0;i-=3)s=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===r)for(i=0,o=0;i<e.length;i+=3)s=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},i.prototype._parseHex=function(e,t,n){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var i,o=0,s=0;if("be"===n)for(r=e.length-1;r>=t;r-=2)i=a(e,t,r)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;else for(r=(e.length-t)%2==0?t+1:t;r<e.length;r+=2)i=a(e,t,r)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;this.strip()},i.prototype._parseBase=function(e,t,n){this.words=[0],this.length=1;for(var r=0,i=1;i<=67108863;i*=t)r++;r--,i=i/t|0;for(var o=e.length-n,s=o%r,a=Math.min(o,o-s)+n,d=0,u=n;u<a;u+=r)d=c(e,u,u+r,t),this.imuln(i),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(0!==s){var h=1;for(d=c(e,u,e.length,t),u=0;u<s;u++)h*=t;this.imuln(h),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}this.strip()},i.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},i.prototype.clone=function(){var e=new i(null);return this.copy(e),e},i.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},i.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function f(e,t,n){n.negative=t.negative^e.negative;var r=e.length+t.length|0;n.length=r,r=r-1|0;var i=0|e.words[0],o=0|t.words[0],s=i*o,a=67108863&s,c=s/67108864|0;n.words[0]=a;for(var d=1;d<r;d++){for(var u=c>>>26,h=67108863&c,f=Math.min(d,t.length-1),l=Math.max(0,d-e.length+1);l<=f;l++){var A=d-l|0;u+=(s=(i=0|e.words[A])*(o=0|t.words[l])+h)/67108864|0,h=67108863&s}n.words[d]=0|h,c=0|u}return 0!==c?n.words[d]=0|c:n.length--,n.strip()}i.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,o=0,s=0;s<this.length;s++){var a=this.words[s],c=(16777215&(a<<i|o)).toString(16);r=0!=(o=a>>>24-i&16777215)||s!==this.length-1?d[6-c.length]+c+r:c+r,(i+=2)>=26&&(i-=26,s--)}for(0!==o&&(r=o.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var f=u[e],l=h[e];r="";var A=this.clone();for(A.negative=0;!A.isZero();){var p=A.modn(l).toString(e);r=(A=A.idivn(l)).isZero()?p+r:d[f-p.length]+p+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(e,t){return n(void 0!==o),this.toArrayLike(o,e,t)},i.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},i.prototype.toArrayLike=function(e,t,r){var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,c="le"===t,d=new e(o),u=this.clone();if(c){for(a=0;!u.isZero();a++)s=u.andln(255),u.iushrn(8),d[a]=s;for(;a<o;a++)d[a]=0}else{for(a=0;a<o-i;a++)d[a]=0;for(a=0;!u.isZero();a++)s=u.andln(255),u.iushrn(8),d[o-a-1]=s}return d},Math.clz32?i.prototype._countBits=function(e){return 32-Math.clz32(e)}:i.prototype._countBits=function(e){var t=e,n=0;return t>=4096&&(n+=13,t>>>=13),t>=64&&(n+=7,t>>>=7),t>=8&&(n+=4,t>>>=4),t>=2&&(n+=2,t>>>=2),n+t},i.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,n=0;return 0==(8191&t)&&(n+=13,t>>>=13),0==(127&t)&&(n+=7,t>>>=7),0==(15&t)&&(n+=4,t>>>=4),0==(3&t)&&(n+=2,t>>>=2),0==(1&t)&&n++,n},i.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var n=this._zeroBits(this.words[t]);if(e+=n,26!==n)break}return e},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},i.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return 0!==this.negative},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},i.prototype.ior=function(e){return n(0==(this.negative|e.negative)),this.iuor(e)},i.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},i.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},i.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var n=0;n<t.length;n++)this.words[n]=this.words[n]&e.words[n];return this.length=t.length,this.strip()},i.prototype.iand=function(e){return n(0==(this.negative|e.negative)),this.iuand(e)},i.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},i.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},i.prototype.iuxor=function(e){var t,n;this.length>e.length?(t=this,n=e):(t=e,n=this);for(var r=0;r<n.length;r++)this.words[r]=t.words[r]^n.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},i.prototype.ixor=function(e){return n(0==(this.negative|e.negative)),this.iuxor(e)},i.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},i.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},i.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this.strip()},i.prototype.notn=function(e){return this.clone().inotn(e)},i.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this.strip()},i.prototype.iadd=function(e){var t,n,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(n=this,r=e):(n=e,r=this);for(var i=0,o=0;o<r.length;o++)t=(0|n.words[o])+(0|r.words[o])+i,this.words[o]=67108863&t,i=t>>>26;for(;0!==i&&o<n.length;o++)t=(0|n.words[o])+i,this.words[o]=67108863&t,i=t>>>26;if(this.length=n.length,0!==i)this.words[this.length]=i,this.length++;else if(n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this},i.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},i.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var n,r,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(n=this,r=e):(n=e,r=this);for(var o=0,s=0;s<r.length;s++)o=(t=(0|n.words[s])-(0|r.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<n.length;s++)o=(t=(0|n.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<n.length&&n!==this)for(;s<n.length;s++)this.words[s]=n.words[s];return this.length=Math.max(this.length,s),n!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(e){return this.clone().isub(e)};var l=function(e,t,n){var r,i,o,s=e.words,a=t.words,c=n.words,d=0,u=0|s[0],h=8191&u,f=u>>>13,l=0|s[1],A=8191&l,p=l>>>13,b=0|s[2],m=8191&b,g=b>>>13,v=0|s[3],y=8191&v,w=v>>>13,_=0|s[4],M=8191&_,E=_>>>13,S=0|s[5],k=8191&S,C=S>>>13,I=0|s[6],x=8191&I,O=I>>>13,R=0|s[7],P=8191&R,T=R>>>13,N=0|s[8],L=8191&N,B=N>>>13,D=0|s[9],j=8191&D,F=D>>>13,K=0|a[0],q=8191&K,z=K>>>13,V=0|a[1],W=8191&V,U=V>>>13,Q=0|a[2],H=8191&Q,Y=Q>>>13,$=0|a[3],G=8191&$,Z=$>>>13,J=0|a[4],X=8191&J,ee=J>>>13,te=0|a[5],ne=8191&te,re=te>>>13,ie=0|a[6],oe=8191&ie,se=ie>>>13,ae=0|a[7],ce=8191&ae,de=ae>>>13,ue=0|a[8],he=8191&ue,fe=ue>>>13,le=0|a[9],Ae=8191&le,pe=le>>>13;n.negative=e.negative^t.negative,n.length=19;var be=(d+(r=Math.imul(h,q))|0)+((8191&(i=(i=Math.imul(h,z))+Math.imul(f,q)|0))<<13)|0;d=((o=Math.imul(f,z))+(i>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(A,q),i=(i=Math.imul(A,z))+Math.imul(p,q)|0,o=Math.imul(p,z);var me=(d+(r=r+Math.imul(h,W)|0)|0)+((8191&(i=(i=i+Math.imul(h,U)|0)+Math.imul(f,W)|0))<<13)|0;d=((o=o+Math.imul(f,U)|0)+(i>>>13)|0)+(me>>>26)|0,me&=67108863,r=Math.imul(m,q),i=(i=Math.imul(m,z))+Math.imul(g,q)|0,o=Math.imul(g,z),r=r+Math.imul(A,W)|0,i=(i=i+Math.imul(A,U)|0)+Math.imul(p,W)|0,o=o+Math.imul(p,U)|0;var ge=(d+(r=r+Math.imul(h,H)|0)|0)+((8191&(i=(i=i+Math.imul(h,Y)|0)+Math.imul(f,H)|0))<<13)|0;d=((o=o+Math.imul(f,Y)|0)+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(y,q),i=(i=Math.imul(y,z))+Math.imul(w,q)|0,o=Math.imul(w,z),r=r+Math.imul(m,W)|0,i=(i=i+Math.imul(m,U)|0)+Math.imul(g,W)|0,o=o+Math.imul(g,U)|0,r=r+Math.imul(A,H)|0,i=(i=i+Math.imul(A,Y)|0)+Math.imul(p,H)|0,o=o+Math.imul(p,Y)|0;var ve=(d+(r=r+Math.imul(h,G)|0)|0)+((8191&(i=(i=i+Math.imul(h,Z)|0)+Math.imul(f,G)|0))<<13)|0;d=((o=o+Math.imul(f,Z)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(M,q),i=(i=Math.imul(M,z))+Math.imul(E,q)|0,o=Math.imul(E,z),r=r+Math.imul(y,W)|0,i=(i=i+Math.imul(y,U)|0)+Math.imul(w,W)|0,o=o+Math.imul(w,U)|0,r=r+Math.imul(m,H)|0,i=(i=i+Math.imul(m,Y)|0)+Math.imul(g,H)|0,o=o+Math.imul(g,Y)|0,r=r+Math.imul(A,G)|0,i=(i=i+Math.imul(A,Z)|0)+Math.imul(p,G)|0,o=o+Math.imul(p,Z)|0;var ye=(d+(r=r+Math.imul(h,X)|0)|0)+((8191&(i=(i=i+Math.imul(h,ee)|0)+Math.imul(f,X)|0))<<13)|0;d=((o=o+Math.imul(f,ee)|0)+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(k,q),i=(i=Math.imul(k,z))+Math.imul(C,q)|0,o=Math.imul(C,z),r=r+Math.imul(M,W)|0,i=(i=i+Math.imul(M,U)|0)+Math.imul(E,W)|0,o=o+Math.imul(E,U)|0,r=r+Math.imul(y,H)|0,i=(i=i+Math.imul(y,Y)|0)+Math.imul(w,H)|0,o=o+Math.imul(w,Y)|0,r=r+Math.imul(m,G)|0,i=(i=i+Math.imul(m,Z)|0)+Math.imul(g,G)|0,o=o+Math.imul(g,Z)|0,r=r+Math.imul(A,X)|0,i=(i=i+Math.imul(A,ee)|0)+Math.imul(p,X)|0,o=o+Math.imul(p,ee)|0;var we=(d+(r=r+Math.imul(h,ne)|0)|0)+((8191&(i=(i=i+Math.imul(h,re)|0)+Math.imul(f,ne)|0))<<13)|0;d=((o=o+Math.imul(f,re)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(x,q),i=(i=Math.imul(x,z))+Math.imul(O,q)|0,o=Math.imul(O,z),r=r+Math.imul(k,W)|0,i=(i=i+Math.imul(k,U)|0)+Math.imul(C,W)|0,o=o+Math.imul(C,U)|0,r=r+Math.imul(M,H)|0,i=(i=i+Math.imul(M,Y)|0)+Math.imul(E,H)|0,o=o+Math.imul(E,Y)|0,r=r+Math.imul(y,G)|0,i=(i=i+Math.imul(y,Z)|0)+Math.imul(w,G)|0,o=o+Math.imul(w,Z)|0,r=r+Math.imul(m,X)|0,i=(i=i+Math.imul(m,ee)|0)+Math.imul(g,X)|0,o=o+Math.imul(g,ee)|0,r=r+Math.imul(A,ne)|0,i=(i=i+Math.imul(A,re)|0)+Math.imul(p,ne)|0,o=o+Math.imul(p,re)|0;var _e=(d+(r=r+Math.imul(h,oe)|0)|0)+((8191&(i=(i=i+Math.imul(h,se)|0)+Math.imul(f,oe)|0))<<13)|0;d=((o=o+Math.imul(f,se)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(P,q),i=(i=Math.imul(P,z))+Math.imul(T,q)|0,o=Math.imul(T,z),r=r+Math.imul(x,W)|0,i=(i=i+Math.imul(x,U)|0)+Math.imul(O,W)|0,o=o+Math.imul(O,U)|0,r=r+Math.imul(k,H)|0,i=(i=i+Math.imul(k,Y)|0)+Math.imul(C,H)|0,o=o+Math.imul(C,Y)|0,r=r+Math.imul(M,G)|0,i=(i=i+Math.imul(M,Z)|0)+Math.imul(E,G)|0,o=o+Math.imul(E,Z)|0,r=r+Math.imul(y,X)|0,i=(i=i+Math.imul(y,ee)|0)+Math.imul(w,X)|0,o=o+Math.imul(w,ee)|0,r=r+Math.imul(m,ne)|0,i=(i=i+Math.imul(m,re)|0)+Math.imul(g,ne)|0,o=o+Math.imul(g,re)|0,r=r+Math.imul(A,oe)|0,i=(i=i+Math.imul(A,se)|0)+Math.imul(p,oe)|0,o=o+Math.imul(p,se)|0;var Me=(d+(r=r+Math.imul(h,ce)|0)|0)+((8191&(i=(i=i+Math.imul(h,de)|0)+Math.imul(f,ce)|0))<<13)|0;d=((o=o+Math.imul(f,de)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(L,q),i=(i=Math.imul(L,z))+Math.imul(B,q)|0,o=Math.imul(B,z),r=r+Math.imul(P,W)|0,i=(i=i+Math.imul(P,U)|0)+Math.imul(T,W)|0,o=o+Math.imul(T,U)|0,r=r+Math.imul(x,H)|0,i=(i=i+Math.imul(x,Y)|0)+Math.imul(O,H)|0,o=o+Math.imul(O,Y)|0,r=r+Math.imul(k,G)|0,i=(i=i+Math.imul(k,Z)|0)+Math.imul(C,G)|0,o=o+Math.imul(C,Z)|0,r=r+Math.imul(M,X)|0,i=(i=i+Math.imul(M,ee)|0)+Math.imul(E,X)|0,o=o+Math.imul(E,ee)|0,r=r+Math.imul(y,ne)|0,i=(i=i+Math.imul(y,re)|0)+Math.imul(w,ne)|0,o=o+Math.imul(w,re)|0,r=r+Math.imul(m,oe)|0,i=(i=i+Math.imul(m,se)|0)+Math.imul(g,oe)|0,o=o+Math.imul(g,se)|0,r=r+Math.imul(A,ce)|0,i=(i=i+Math.imul(A,de)|0)+Math.imul(p,ce)|0,o=o+Math.imul(p,de)|0;var Ee=(d+(r=r+Math.imul(h,he)|0)|0)+((8191&(i=(i=i+Math.imul(h,fe)|0)+Math.imul(f,he)|0))<<13)|0;d=((o=o+Math.imul(f,fe)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(j,q),i=(i=Math.imul(j,z))+Math.imul(F,q)|0,o=Math.imul(F,z),r=r+Math.imul(L,W)|0,i=(i=i+Math.imul(L,U)|0)+Math.imul(B,W)|0,o=o+Math.imul(B,U)|0,r=r+Math.imul(P,H)|0,i=(i=i+Math.imul(P,Y)|0)+Math.imul(T,H)|0,o=o+Math.imul(T,Y)|0,r=r+Math.imul(x,G)|0,i=(i=i+Math.imul(x,Z)|0)+Math.imul(O,G)|0,o=o+Math.imul(O,Z)|0,r=r+Math.imul(k,X)|0,i=(i=i+Math.imul(k,ee)|0)+Math.imul(C,X)|0,o=o+Math.imul(C,ee)|0,r=r+Math.imul(M,ne)|0,i=(i=i+Math.imul(M,re)|0)+Math.imul(E,ne)|0,o=o+Math.imul(E,re)|0,r=r+Math.imul(y,oe)|0,i=(i=i+Math.imul(y,se)|0)+Math.imul(w,oe)|0,o=o+Math.imul(w,se)|0,r=r+Math.imul(m,ce)|0,i=(i=i+Math.imul(m,de)|0)+Math.imul(g,ce)|0,o=o+Math.imul(g,de)|0,r=r+Math.imul(A,he)|0,i=(i=i+Math.imul(A,fe)|0)+Math.imul(p,he)|0,o=o+Math.imul(p,fe)|0;var Se=(d+(r=r+Math.imul(h,Ae)|0)|0)+((8191&(i=(i=i+Math.imul(h,pe)|0)+Math.imul(f,Ae)|0))<<13)|0;d=((o=o+Math.imul(f,pe)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(j,W),i=(i=Math.imul(j,U))+Math.imul(F,W)|0,o=Math.imul(F,U),r=r+Math.imul(L,H)|0,i=(i=i+Math.imul(L,Y)|0)+Math.imul(B,H)|0,o=o+Math.imul(B,Y)|0,r=r+Math.imul(P,G)|0,i=(i=i+Math.imul(P,Z)|0)+Math.imul(T,G)|0,o=o+Math.imul(T,Z)|0,r=r+Math.imul(x,X)|0,i=(i=i+Math.imul(x,ee)|0)+Math.imul(O,X)|0,o=o+Math.imul(O,ee)|0,r=r+Math.imul(k,ne)|0,i=(i=i+Math.imul(k,re)|0)+Math.imul(C,ne)|0,o=o+Math.imul(C,re)|0,r=r+Math.imul(M,oe)|0,i=(i=i+Math.imul(M,se)|0)+Math.imul(E,oe)|0,o=o+Math.imul(E,se)|0,r=r+Math.imul(y,ce)|0,i=(i=i+Math.imul(y,de)|0)+Math.imul(w,ce)|0,o=o+Math.imul(w,de)|0,r=r+Math.imul(m,he)|0,i=(i=i+Math.imul(m,fe)|0)+Math.imul(g,he)|0,o=o+Math.imul(g,fe)|0;var ke=(d+(r=r+Math.imul(A,Ae)|0)|0)+((8191&(i=(i=i+Math.imul(A,pe)|0)+Math.imul(p,Ae)|0))<<13)|0;d=((o=o+Math.imul(p,pe)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(j,H),i=(i=Math.imul(j,Y))+Math.imul(F,H)|0,o=Math.imul(F,Y),r=r+Math.imul(L,G)|0,i=(i=i+Math.imul(L,Z)|0)+Math.imul(B,G)|0,o=o+Math.imul(B,Z)|0,r=r+Math.imul(P,X)|0,i=(i=i+Math.imul(P,ee)|0)+Math.imul(T,X)|0,o=o+Math.imul(T,ee)|0,r=r+Math.imul(x,ne)|0,i=(i=i+Math.imul(x,re)|0)+Math.imul(O,ne)|0,o=o+Math.imul(O,re)|0,r=r+Math.imul(k,oe)|0,i=(i=i+Math.imul(k,se)|0)+Math.imul(C,oe)|0,o=o+Math.imul(C,se)|0,r=r+Math.imul(M,ce)|0,i=(i=i+Math.imul(M,de)|0)+Math.imul(E,ce)|0,o=o+Math.imul(E,de)|0,r=r+Math.imul(y,he)|0,i=(i=i+Math.imul(y,fe)|0)+Math.imul(w,he)|0,o=o+Math.imul(w,fe)|0;var Ce=(d+(r=r+Math.imul(m,Ae)|0)|0)+((8191&(i=(i=i+Math.imul(m,pe)|0)+Math.imul(g,Ae)|0))<<13)|0;d=((o=o+Math.imul(g,pe)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(j,G),i=(i=Math.imul(j,Z))+Math.imul(F,G)|0,o=Math.imul(F,Z),r=r+Math.imul(L,X)|0,i=(i=i+Math.imul(L,ee)|0)+Math.imul(B,X)|0,o=o+Math.imul(B,ee)|0,r=r+Math.imul(P,ne)|0,i=(i=i+Math.imul(P,re)|0)+Math.imul(T,ne)|0,o=o+Math.imul(T,re)|0,r=r+Math.imul(x,oe)|0,i=(i=i+Math.imul(x,se)|0)+Math.imul(O,oe)|0,o=o+Math.imul(O,se)|0,r=r+Math.imul(k,ce)|0,i=(i=i+Math.imul(k,de)|0)+Math.imul(C,ce)|0,o=o+Math.imul(C,de)|0,r=r+Math.imul(M,he)|0,i=(i=i+Math.imul(M,fe)|0)+Math.imul(E,he)|0,o=o+Math.imul(E,fe)|0;var Ie=(d+(r=r+Math.imul(y,Ae)|0)|0)+((8191&(i=(i=i+Math.imul(y,pe)|0)+Math.imul(w,Ae)|0))<<13)|0;d=((o=o+Math.imul(w,pe)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(j,X),i=(i=Math.imul(j,ee))+Math.imul(F,X)|0,o=Math.imul(F,ee),r=r+Math.imul(L,ne)|0,i=(i=i+Math.imul(L,re)|0)+Math.imul(B,ne)|0,o=o+Math.imul(B,re)|0,r=r+Math.imul(P,oe)|0,i=(i=i+Math.imul(P,se)|0)+Math.imul(T,oe)|0,o=o+Math.imul(T,se)|0,r=r+Math.imul(x,ce)|0,i=(i=i+Math.imul(x,de)|0)+Math.imul(O,ce)|0,o=o+Math.imul(O,de)|0,r=r+Math.imul(k,he)|0,i=(i=i+Math.imul(k,fe)|0)+Math.imul(C,he)|0,o=o+Math.imul(C,fe)|0;var xe=(d+(r=r+Math.imul(M,Ae)|0)|0)+((8191&(i=(i=i+Math.imul(M,pe)|0)+Math.imul(E,Ae)|0))<<13)|0;d=((o=o+Math.imul(E,pe)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(j,ne),i=(i=Math.imul(j,re))+Math.imul(F,ne)|0,o=Math.imul(F,re),r=r+Math.imul(L,oe)|0,i=(i=i+Math.imul(L,se)|0)+Math.imul(B,oe)|0,o=o+Math.imul(B,se)|0,r=r+Math.imul(P,ce)|0,i=(i=i+Math.imul(P,de)|0)+Math.imul(T,ce)|0,o=o+Math.imul(T,de)|0,r=r+Math.imul(x,he)|0,i=(i=i+Math.imul(x,fe)|0)+Math.imul(O,he)|0,o=o+Math.imul(O,fe)|0;var Oe=(d+(r=r+Math.imul(k,Ae)|0)|0)+((8191&(i=(i=i+Math.imul(k,pe)|0)+Math.imul(C,Ae)|0))<<13)|0;d=((o=o+Math.imul(C,pe)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,r=Math.imul(j,oe),i=(i=Math.imul(j,se))+Math.imul(F,oe)|0,o=Math.imul(F,se),r=r+Math.imul(L,ce)|0,i=(i=i+Math.imul(L,de)|0)+Math.imul(B,ce)|0,o=o+Math.imul(B,de)|0,r=r+Math.imul(P,he)|0,i=(i=i+Math.imul(P,fe)|0)+Math.imul(T,he)|0,o=o+Math.imul(T,fe)|0;var Re=(d+(r=r+Math.imul(x,Ae)|0)|0)+((8191&(i=(i=i+Math.imul(x,pe)|0)+Math.imul(O,Ae)|0))<<13)|0;d=((o=o+Math.imul(O,pe)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(j,ce),i=(i=Math.imul(j,de))+Math.imul(F,ce)|0,o=Math.imul(F,de),r=r+Math.imul(L,he)|0,i=(i=i+Math.imul(L,fe)|0)+Math.imul(B,he)|0,o=o+Math.imul(B,fe)|0;var Pe=(d+(r=r+Math.imul(P,Ae)|0)|0)+((8191&(i=(i=i+Math.imul(P,pe)|0)+Math.imul(T,Ae)|0))<<13)|0;d=((o=o+Math.imul(T,pe)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(j,he),i=(i=Math.imul(j,fe))+Math.imul(F,he)|0,o=Math.imul(F,fe);var Te=(d+(r=r+Math.imul(L,Ae)|0)|0)+((8191&(i=(i=i+Math.imul(L,pe)|0)+Math.imul(B,Ae)|0))<<13)|0;d=((o=o+Math.imul(B,pe)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863;var Ne=(d+(r=Math.imul(j,Ae))|0)+((8191&(i=(i=Math.imul(j,pe))+Math.imul(F,Ae)|0))<<13)|0;return d=((o=Math.imul(F,pe))+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,c[0]=be,c[1]=me,c[2]=ge,c[3]=ve,c[4]=ye,c[5]=we,c[6]=_e,c[7]=Me,c[8]=Ee,c[9]=Se,c[10]=ke,c[11]=Ce,c[12]=Ie,c[13]=xe,c[14]=Oe,c[15]=Re,c[16]=Pe,c[17]=Te,c[18]=Ne,0!==d&&(c[19]=d,n.length++),n};function A(e,t,n){return(new p).mulp(e,t,n)}function p(e,t){this.x=e,this.y=t}Math.imul||(l=f),i.prototype.mulTo=function(e,t){var n,r=this.length+e.length;return n=10===this.length&&10===e.length?l(this,e,t):r<63?f(this,e,t):r<1024?function(e,t,n){n.negative=t.negative^e.negative,n.length=e.length+t.length;for(var r=0,i=0,o=0;o<n.length-1;o++){var s=i;i=0;for(var a=67108863&r,c=Math.min(o,t.length-1),d=Math.max(0,o-e.length+1);d<=c;d++){var u=o-d,h=(0|e.words[u])*(0|t.words[d]),f=67108863&h;a=67108863&(f=f+a|0),i+=(s=(s=s+(h/67108864|0)|0)+(f>>>26)|0)>>>26,s&=67108863}n.words[o]=a,r=s,s=i}return 0!==r?n.words[o]=r:n.length--,n.strip()}(this,e,t):A(this,e,t),n},p.prototype.makeRBT=function(e){for(var t=new Array(e),n=i.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,n,e);return t},p.prototype.revBin=function(e,t,n){if(0===e||e===n-1)return e;for(var r=0,i=0;i<t;i++)r|=(1&e)<<t-i-1,e>>=1;return r},p.prototype.permute=function(e,t,n,r,i,o){for(var s=0;s<o;s++)r[s]=t[e[s]],i[s]=n[e[s]]},p.prototype.transform=function(e,t,n,r,i,o){this.permute(o,e,t,n,r,i);for(var s=1;s<i;s<<=1)for(var a=s<<1,c=Math.cos(2*Math.PI/a),d=Math.sin(2*Math.PI/a),u=0;u<i;u+=a)for(var h=c,f=d,l=0;l<s;l++){var A=n[u+l],p=r[u+l],b=n[u+l+s],m=r[u+l+s],g=h*b-f*m;m=h*m+f*b,b=g,n[u+l]=A+b,r[u+l]=p+m,n[u+l+s]=A-b,r[u+l+s]=p-m,l!==a&&(g=c*h-d*f,f=c*f+d*h,h=g)}},p.prototype.guessLen13b=function(e,t){var n=1|Math.max(t,e),r=1&n,i=0;for(n=n/2|0;n;n>>>=1)i++;return 1<<i+1+r},p.prototype.conjugate=function(e,t,n){if(!(n<=1))for(var r=0;r<n/2;r++){var i=e[r];e[r]=e[n-r-1],e[n-r-1]=i,i=t[r],t[r]=-t[n-r-1],t[n-r-1]=-i}},p.prototype.normalize13b=function(e,t){for(var n=0,r=0;r<t/2;r++){var i=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+n;e[r]=67108863&i,n=i<67108864?0:i/67108864|0}return e},p.prototype.convert13b=function(e,t,r,i){for(var o=0,s=0;s<t;s++)o+=0|e[s],r[2*s]=8191&o,o>>>=13,r[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<i;++s)r[s]=0;n(0===o),n(0==(-8192&o))},p.prototype.stub=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t},p.prototype.mulp=function(e,t,n){var r=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(r),o=this.stub(r),s=new Array(r),a=new Array(r),c=new Array(r),d=new Array(r),u=new Array(r),h=new Array(r),f=n.words;f.length=r,this.convert13b(e.words,e.length,s,r),this.convert13b(t.words,t.length,d,r),this.transform(s,o,a,c,r,i),this.transform(d,o,u,h,r,i);for(var l=0;l<r;l++){var A=a[l]*u[l]-c[l]*h[l];c[l]=a[l]*h[l]+c[l]*u[l],a[l]=A}return this.conjugate(a,c,r),this.transform(a,c,f,o,r,i),this.conjugate(f,o,r),this.normalize13b(f,r),n.negative=e.negative^t.negative,n.length=e.length+t.length,n.strip()},i.prototype.mul=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},i.prototype.mulf=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),A(this,e,t)},i.prototype.imul=function(e){return this.clone().mulTo(e,this)},i.prototype.imuln=function(e){n("number"==typeof e),n(e<67108864);for(var t=0,r=0;r<this.length;r++){var i=(0|this.words[r])*e,o=(67108863&i)+(67108863&t);t>>=26,t+=i/67108864|0,t+=o>>>26,this.words[r]=67108863&o}return 0!==t&&(this.words[r]=t,this.length++),this},i.prototype.muln=function(e){return this.clone().imuln(e)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),n=0;n<t.length;n++){var r=n/26|0,i=n%26;t[n]=(e.words[r]&1<<i)>>>i}return t}(e);if(0===t.length)return new i(1);for(var n=this,r=0;r<t.length&&0===t[r];r++,n=n.sqr());if(++r<t.length)for(var o=n.sqr();r<t.length;r++,o=o.sqr())0!==t[r]&&(n=n.mul(o));return n},i.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,c=(0|this.words[t])-a<<r;this.words[t]=c|s,s=a>>>26-r}s&&(this.words[t]=s,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this.strip()},i.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},i.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,c=r;if(i-=s,i=Math.max(0,i),c){for(var d=0;d<s;d++)c.words[d]=this.words[d];c.length=s}if(0===s);else if(this.length>s)for(this.length-=s,d=0;d<this.length;d++)this.words[d]=this.words[d+s];else this.words[0]=0,this.length=1;var u=0;for(d=this.length-1;d>=0&&(0!==u||d>=i);d--){var h=0|this.words[d];this.words[d]=u<<26-o|h>>>o,u=h&a}return c&&0!==u&&(c.words[c.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},i.prototype.shln=function(e){return this.clone().ishln(e)},i.prototype.ushln=function(e){return this.clone().iushln(e)},i.prototype.shrn=function(e){return this.clone().ishrn(e)},i.prototype.ushrn=function(e){return this.clone().iushrn(e)},i.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r||!(this.words[r]&i))},i.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this.strip()},i.prototype.maskn=function(e){return this.clone().imaskn(e)},i.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},i.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},i.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},i.prototype.addn=function(e){return this.clone().iaddn(e)},i.prototype.subn=function(e){return this.clone().isubn(e)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(e,t,r){var i,o,s=e.length+r;this._expand(s);var a=0;for(i=0;i<e.length;i++){o=(0|this.words[i+r])+a;var c=(0|e.words[i])*t;a=((o-=67108863&c)>>26)-(c/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)a=(o=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(o=-(0|this.words[i])+a)>>26,this.words[i]=67108863&o;return this.negative=1,this.strip()},i.prototype._wordDiv=function(e,t){var n=(this.length,e.length),r=this.clone(),o=e,s=0|o.words[o.length-1];0!=(n=26-this._countBits(s))&&(o=o.ushln(n),r.iushln(n),s=0|o.words[o.length-1]);var a,c=r.length-o.length;if("mod"!==t){(a=new i(null)).length=c+1,a.words=new Array(a.length);for(var d=0;d<a.length;d++)a.words[d]=0}var u=r.clone()._ishlnsubmul(o,1,c);0===u.negative&&(r=u,a&&(a.words[c]=1));for(var h=c-1;h>=0;h--){var f=67108864*(0|r.words[o.length+h])+(0|r.words[o.length+h-1]);for(f=Math.min(f/s|0,67108863),r._ishlnsubmul(o,f,h);0!==r.negative;)f--,r.negative=0,r._ishlnsubmul(o,1,h),r.isZero()||(r.negative^=1);a&&(a.words[h]=f)}return a&&a.strip(),r.strip(),"div"!==t&&0!==n&&r.iushrn(n),{div:a||null,mod:r}},i.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(o=a.div.neg()),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.iadd(e)),{div:o,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(o=a.div.neg()),{div:o,mod:a.mod}):0!=(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new i(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new i(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new i(this.modn(e.words[0]))}:this._wordDiv(e,t);var o,s,a},i.prototype.div=function(e){return this.divmod(e,"div",!1).div},i.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},i.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},i.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var n=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),i=e.andln(1),o=n.cmp(r);return o<0||1===i&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},i.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,r=0,i=this.length-1;i>=0;i--)r=(t*r+(0|this.words[i]))%e;return r},i.prototype.idivn=function(e){n(e<=67108863);for(var t=0,r=this.length-1;r>=0;r--){var i=(0|this.words[r])+67108864*t;this.words[r]=i/e|0,t=i%e}return this.strip()},i.prototype.divn=function(e){return this.clone().idivn(e)},i.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var o=new i(1),s=new i(0),a=new i(0),c=new i(1),d=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++d;for(var u=r.clone(),h=t.clone();!t.isZero();){for(var f=0,l=1;0==(t.words[0]&l)&&f<26;++f,l<<=1);if(f>0)for(t.iushrn(f);f-- >0;)(o.isOdd()||s.isOdd())&&(o.iadd(u),s.isub(h)),o.iushrn(1),s.iushrn(1);for(var A=0,p=1;0==(r.words[0]&p)&&A<26;++A,p<<=1);if(A>0)for(r.iushrn(A);A-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(u),c.isub(h)),a.iushrn(1),c.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(a),s.isub(c)):(r.isub(t),a.isub(o),c.isub(s))}return{a:a,b:c,gcd:r.iushln(d)}},i.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var o,s=new i(1),a=new i(0),c=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var d=0,u=1;0==(t.words[0]&u)&&d<26;++d,u<<=1);if(d>0)for(t.iushrn(d);d-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);for(var h=0,f=1;0==(r.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(r.iushrn(h);h-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),s.isub(a)):(r.isub(t),a.isub(s))}return(o=0===t.cmpn(1)?s:a).cmpn(0)<0&&o.iadd(e),o},i.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),n=e.clone();t.negative=0,n.negative=0;for(var r=0;t.isEven()&&n.isEven();r++)t.iushrn(1),n.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;n.isEven();)n.iushrn(1);var i=t.cmp(n);if(i<0){var o=t;t=n,n=o}else if(0===i||0===n.cmpn(1))break;t.isub(n)}return n.iushln(r)},i.prototype.invm=function(e){return this.egcd(e).a.umod(e)},i.prototype.isEven=function(){return 0==(1&this.words[0])},i.prototype.isOdd=function(){return 1==(1&this.words[0])},i.prototype.andln=function(e){return this.words[0]&e},i.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,s=r;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},i.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},i.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},i.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},i.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,n=this.length-1;n>=0;n--){var r=0|this.words[n],i=0|e.words[n];if(r!==i){r<i?t=-1:r>i&&(t=1);break}}return t},i.prototype.gtn=function(e){return 1===this.cmpn(e)},i.prototype.gt=function(e){return 1===this.cmp(e)},i.prototype.gten=function(e){return this.cmpn(e)>=0},i.prototype.gte=function(e){return this.cmp(e)>=0},i.prototype.ltn=function(e){return-1===this.cmpn(e)},i.prototype.lt=function(e){return-1===this.cmp(e)},i.prototype.lten=function(e){return this.cmpn(e)<=0},i.prototype.lte=function(e){return this.cmp(e)<=0},i.prototype.eqn=function(e){return 0===this.cmpn(e)},i.prototype.eq=function(e){return 0===this.cmp(e)},i.red=function(e){return new _(e)},i.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},i.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(e){return this.red=e,this},i.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},i.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},i.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},i.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},i.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},i.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},i.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},i.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},i.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var b={k256:null,p224:null,p192:null,p25519:null};function m(e,t){this.name=e,this.p=new i(t,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function g(){m.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function v(){m.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function y(){m.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){m.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function _(e){if("string"==typeof e){var t=i._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function M(e){_.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}m.prototype._tmp=function(){var e=new i(null);return e.words=new Array(Math.ceil(this.n/13)),e},m.prototype.ireduce=function(e){var t,n=e;do{this.split(n,this.tmp),t=(n=(n=this.imulK(n)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:n.ucmp(this.p);return 0===r?(n.words[0]=0,n.length=1):r>0?n.isub(this.p):void 0!==n.strip?n.strip():n._strip(),n},m.prototype.split=function(e,t){e.iushrn(this.n,0,t)},m.prototype.imulK=function(e){return e.imul(this.k)},r(g,m),g.prototype.split=function(e,t){for(var n=4194303,r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&n,i=10;i<e.length;i++){var s=0|e.words[i];e.words[i-10]=(s&n)<<4|o>>>22,o=s}o>>>=22,e.words[i-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},g.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,n=0;n<e.length;n++){var r=0|e.words[n];t+=977*r,e.words[n]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(v,m),r(y,m),r(w,m),w.prototype.imulK=function(e){for(var t=0,n=0;n<e.length;n++){var r=19*(0|e.words[n])+t,i=67108863&r;r>>>=26,e.words[n]=i,t=r}return 0!==t&&(e.words[e.length++]=t),e},i._prime=function(e){if(b[e])return b[e];var t;if("k256"===e)t=new g;else if("p224"===e)t=new v;else if("p192"===e)t=new y;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new w}return b[e]=t,t},_.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},_.prototype._verify2=function(e,t){n(0==(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},_.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},_.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},_.prototype.add=function(e,t){this._verify2(e,t);var n=e.add(t);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},_.prototype.iadd=function(e,t){this._verify2(e,t);var n=e.iadd(t);return n.cmp(this.m)>=0&&n.isub(this.m),n},_.prototype.sub=function(e,t){this._verify2(e,t);var n=e.sub(t);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},_.prototype.isub=function(e,t){this._verify2(e,t);var n=e.isub(t);return n.cmpn(0)<0&&n.iadd(this.m),n},_.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},_.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},_.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},_.prototype.isqr=function(e){return this.imul(e,e.clone())},_.prototype.sqr=function(e){return this.mul(e,e)},_.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new i(1)).iushrn(2);return this.pow(e,r)}for(var o=this.m.subn(1),s=0;!o.isZero()&&0===o.andln(1);)s++,o.iushrn(1);n(!o.isZero());var a=new i(1).toRed(this),c=a.redNeg(),d=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new i(2*u*u).toRed(this);0!==this.pow(u,d).cmp(c);)u.redIAdd(c);for(var h=this.pow(u,o),f=this.pow(e,o.addn(1).iushrn(1)),l=this.pow(e,o),A=s;0!==l.cmp(a);){for(var p=l,b=0;0!==p.cmp(a);b++)p=p.redSqr();n(b<A);var m=this.pow(h,new i(1).iushln(A-b-1));f=f.redMul(m),h=m.redSqr(),l=l.redMul(h),A=b}return f},_.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},_.prototype.pow=function(e,t){if(t.isZero())return new i(1).toRed(this);if(0===t.cmpn(1))return e.clone();var n=new Array(16);n[0]=new i(1).toRed(this),n[1]=e;for(var r=2;r<n.length;r++)n[r]=this.mul(n[r-1],e);var o=n[0],s=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),r=t.length-1;r>=0;r--){for(var d=t.words[r],u=c-1;u>=0;u--){var h=d>>u&1;o!==n[0]&&(o=this.sqr(o)),0!==h||0!==s?(s<<=1,s|=h,(4==++a||0===r&&0===u)&&(o=this.mul(o,n[s]),a=0,s=0)):a=0}c=26}return o},_.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},_.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},i.mont=function(e){return new M(e)},r(M,_),M.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},M.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},M.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var n=e.imul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},M.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new i(0)._forceRed(this);var n=e.mul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),o=n.isub(r).iushrn(this.shift),s=o;return o.cmp(this.m)>=0?s=o.isub(this.m):o.cmpn(0)<0&&(s=o.iadd(this.m)),s._forceRed(this)},M.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(0,u);var F=D.exports,K=q;function q(e,t){if(!e)throw new Error(t||"Assertion failed")}q.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)};var z={};!function(e){var t=z;function n(e){return 1===e.length?"0"+e:e}function r(e){for(var t="",r=0;r<e.length;r++)t+=n(e[r].toString(16));return t}t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"!=typeof e){for(var r=0;r<e.length;r++)n[r]=0|e[r];return n}if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),r=0;r<e.length;r+=2)n.push(parseInt(e[r]+e[r+1],16));else for(r=0;r<e.length;r++){var i=e.charCodeAt(r),o=i>>8,s=255&i;o?n.push(o,s):n.push(s)}return n},t.zero2=n,t.toHex=r,t.encode=function(e,t){return"hex"===t?r(e):e}}(),function(e){var t=B,n=F,r=K,i=z;t.assert=r,t.toArray=i.toArray,t.zero2=i.zero2,t.toHex=i.toHex,t.encode=i.encode,t.getNAF=function(e,t,n){var r=new Array(Math.max(e.bitLength(),n)+1);r.fill(0);for(var i=1<<t+1,o=e.clone(),s=0;s<r.length;s++){var a,c=o.andln(i-1);o.isOdd()?(a=c>(i>>1)-1?(i>>1)-c:c,o.isubn(a)):a=0,r[s]=a,o.iushrn(1)}return r},t.getJSF=function(e,t){var n=[[],[]];e=e.clone(),t=t.clone();for(var r,i=0,o=0;e.cmpn(-i)>0||t.cmpn(-o)>0;){var s,a,c=e.andln(3)+i&3,d=t.andln(3)+o&3;3===c&&(c=-1),3===d&&(d=-1),s=0==(1&c)?0:3!=(r=e.andln(7)+i&7)&&5!==r||2!==d?c:-c,n[0].push(s),a=0==(1&d)?0:3!=(r=t.andln(7)+o&7)&&5!==r||2!==c?d:-d,n[1].push(a),2*i===s+1&&(i=1-i),2*o===a+1&&(o=1-o),e.iushrn(1),t.iushrn(1)}return n},t.cachedProperty=function(e,t,n){var r="_"+t;e.prototype[t]=function(){return void 0!==this[r]?this[r]:this[r]=n.call(this)}},t.parseBytes=function(e){return"string"==typeof e?t.toArray(e,"hex"):e},t.intFromLE=function(e){return new n(e,"hex","le")}}();var V,W={exports:{}};function U(e){this.rand=e}if(W.exports=function(e){return V||(V=new U(null)),V.generate(e)},W.exports.Rand=U,U.prototype.generate=function(e){return this._rand(e)},U.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),n=0;n<t.length;n++)t[n]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?U.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?U.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(U.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var Q=j;if("function"!=typeof Q.randomBytes)throw new Error("Not supported");U.prototype._rand=function(e){return Q.randomBytes(e)}}catch(xr){}var H=W.exports,Y={},$=F,G=B,Z=G.getNAF,J=G.getJSF,X=G.assert;function ee(e,t){this.type=e,this.p=new $(t.p,16),this.red=t.prime?$.red(t.prime):$.mont(this.p),this.zero=new $(0).toRed(this.red),this.one=new $(1).toRed(this.red),this.two=new $(2).toRed(this.red),this.n=t.n&&new $(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var n=this.n&&this.p.div(this.n);!n||n.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var te=ee;function ne(e,t){this.curve=e,this.type=t,this.precomputed=null}ee.prototype.point=function(){throw new Error("Not implemented")},ee.prototype.validate=function(){throw new Error("Not implemented")},ee.prototype._fixedNafMul=function(e,t){X(e.precomputed);var n=e._getDoubles(),r=Z(t,1,this._bitLength),i=(1<<n.step+1)-(n.step%2==0?2:1);i/=3;var o,s,a=[];for(o=0;o<r.length;o+=n.step){s=0;for(var c=o+n.step-1;c>=o;c--)s=(s<<1)+r[c];a.push(s)}for(var d=this.jpoint(null,null,null),u=this.jpoint(null,null,null),h=i;h>0;h--){for(o=0;o<a.length;o++)(s=a[o])===h?u=u.mixedAdd(n.points[o]):s===-h&&(u=u.mixedAdd(n.points[o].neg()));d=d.add(u)}return d.toP()},ee.prototype._wnafMul=function(e,t){var n=4,r=e._getNAFPoints(n);n=r.wnd;for(var i=r.points,o=Z(t,n,this._bitLength),s=this.jpoint(null,null,null),a=o.length-1;a>=0;a--){for(var c=0;a>=0&&0===o[a];a--)c++;if(a>=0&&c++,s=s.dblp(c),a<0)break;var d=o[a];X(0!==d),s="affine"===e.type?d>0?s.mixedAdd(i[d-1>>1]):s.mixedAdd(i[-d-1>>1].neg()):d>0?s.add(i[d-1>>1]):s.add(i[-d-1>>1].neg())}return"affine"===e.type?s.toP():s},ee.prototype._wnafMulAdd=function(e,t,n,r,i){var o,s,a,c=this._wnafT1,d=this._wnafT2,u=this._wnafT3,h=0;for(o=0;o<r;o++){var f=(a=t[o])._getNAFPoints(e);c[o]=f.wnd,d[o]=f.points}for(o=r-1;o>=1;o-=2){var l=o-1,A=o;if(1===c[l]&&1===c[A]){var p=[t[l],null,null,t[A]];0===t[l].y.cmp(t[A].y)?(p[1]=t[l].add(t[A]),p[2]=t[l].toJ().mixedAdd(t[A].neg())):0===t[l].y.cmp(t[A].y.redNeg())?(p[1]=t[l].toJ().mixedAdd(t[A]),p[2]=t[l].add(t[A].neg())):(p[1]=t[l].toJ().mixedAdd(t[A]),p[2]=t[l].toJ().mixedAdd(t[A].neg()));var b=[-3,-1,-5,-7,0,7,5,1,3],m=J(n[l],n[A]);for(h=Math.max(m[0].length,h),u[l]=new Array(h),u[A]=new Array(h),s=0;s<h;s++){var g=0|m[0][s],v=0|m[1][s];u[l][s]=b[3*(g+1)+(v+1)],u[A][s]=0,d[l]=p}}else u[l]=Z(n[l],c[l],this._bitLength),u[A]=Z(n[A],c[A],this._bitLength),h=Math.max(u[l].length,h),h=Math.max(u[A].length,h)}var y=this.jpoint(null,null,null),w=this._wnafT4;for(o=h;o>=0;o--){for(var _=0;o>=0;){var M=!0;for(s=0;s<r;s++)w[s]=0|u[s][o],0!==w[s]&&(M=!1);if(!M)break;_++,o--}if(o>=0&&_++,y=y.dblp(_),o<0)break;for(s=0;s<r;s++){var E=w[s];0!==E&&(E>0?a=d[s][E-1>>1]:E<0&&(a=d[s][-E-1>>1].neg()),y="affine"===a.type?y.mixedAdd(a):y.add(a))}}for(o=0;o<r;o++)d[o]=null;return i?y:y.toP()},ee.BasePoint=ne,ne.prototype.eq=function(){throw new Error("Not implemented")},ne.prototype.validate=function(){return this.curve.validate(this)},ee.prototype.decodePoint=function(e,t){e=G.toArray(e,t);var n=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*n)return 6===e[0]?X(e[e.length-1]%2==0):7===e[0]&&X(e[e.length-1]%2==1),this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));if((2===e[0]||3===e[0])&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),3===e[0]);throw new Error("Unknown point format")},ne.prototype.encodeCompressed=function(e){return this.encode(e,!0)},ne.prototype._encode=function(e){var t=this.curve.p.byteLength(),n=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",t))},ne.prototype.encode=function(e,t){return G.encode(this._encode(t),e)},ne.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},ne.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},ne.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],r=this,i=0;i<t;i+=e){for(var o=0;o<e;o++)r=r.dbl();n.push(r)}return{step:e,points:n}},ne.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],n=(1<<e)-1,r=1===n?null:this.dbl(),i=1;i<n;i++)t[i]=t[i-1].add(r);return{wnd:e,points:t}},ne.prototype._getBeta=function(){return null},ne.prototype.dblp=function(e){for(var t=this,n=0;n<e;n++)t=t.dbl();return t};var re={exports:{}};"function"==typeof Object.create?re.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:re.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}};var ie=re.exports,oe=F,se=ie,ae=te,ce=B.assert;function de(e){ae.call(this,"short",e),this.a=new oe(e.a,16).toRed(this.red),this.b=new oe(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}se(de,ae);var ue=de;function he(e,t,n,r){ae.BasePoint.call(this,e,"affine"),null===t&&null===n?(this.x=null,this.y=null,this.inf=!0):(this.x=new oe(t,16),this.y=new oe(n,16),r&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function fe(e,t,n,r){ae.BasePoint.call(this,e,"jacobian"),null===t&&null===n&&null===r?(this.x=this.curve.one,this.y=this.curve.one,this.z=new oe(0)):(this.x=new oe(t,16),this.y=new oe(n,16),this.z=new oe(r,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}de.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,n;if(e.beta)t=new oe(e.beta,16).toRed(this.red);else{var r=this._getEndoRoots(this.p);t=(t=r[0].cmp(r[1])<0?r[0]:r[1]).toRed(this.red)}if(e.lambda)n=new oe(e.lambda,16);else{var i=this._getEndoRoots(this.n);0===this.g.mul(i[0]).x.cmp(this.g.x.redMul(t))?n=i[0]:(n=i[1],ce(0===this.g.mul(n).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:n,basis:e.basis?e.basis.map((function(e){return{a:new oe(e.a,16),b:new oe(e.b,16)}})):this._getEndoBasis(n)}}},de.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:oe.mont(e),n=new oe(2).toRed(t).redInvm(),r=n.redNeg(),i=new oe(3).toRed(t).redNeg().redSqrt().redMul(n);return[r.redAdd(i).fromRed(),r.redSub(i).fromRed()]},de.prototype._getEndoBasis=function(e){for(var t,n,r,i,o,s,a,c,d,u=this.n.ushrn(Math.floor(this.n.bitLength()/2)),h=e,f=this.n.clone(),l=new oe(1),A=new oe(0),p=new oe(0),b=new oe(1),m=0;0!==h.cmpn(0);){var g=f.div(h);c=f.sub(g.mul(h)),d=p.sub(g.mul(l));var v=b.sub(g.mul(A));if(!r&&c.cmp(u)<0)t=a.neg(),n=l,r=c.neg(),i=d;else if(r&&2==++m)break;a=c,f=h,h=c,p=l,l=d,b=A,A=v}o=c.neg(),s=d;var y=r.sqr().add(i.sqr());return o.sqr().add(s.sqr()).cmp(y)>=0&&(o=t,s=n),r.negative&&(r=r.neg(),i=i.neg()),o.negative&&(o=o.neg(),s=s.neg()),[{a:r,b:i},{a:o,b:s}]},de.prototype._endoSplit=function(e){var t=this.endo.basis,n=t[0],r=t[1],i=r.b.mul(e).divRound(this.n),o=n.b.neg().mul(e).divRound(this.n),s=i.mul(n.a),a=o.mul(r.a),c=i.mul(n.b),d=o.mul(r.b);return{k1:e.sub(s).sub(a),k2:c.add(d).neg()}},de.prototype.pointFromX=function(e,t){(e=new oe(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),r=n.redSqrt();if(0!==r.redSqr().redSub(n).cmp(this.zero))throw new Error("invalid point");var i=r.fromRed().isOdd();return(t&&!i||!t&&i)&&(r=r.redNeg()),this.point(e,r)},de.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,n=e.y,r=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(r).redIAdd(this.b);return 0===n.redSqr().redISub(i).cmpn(0)},de.prototype._endoWnafMulAdd=function(e,t,n){for(var r=this._endoWnafT1,i=this._endoWnafT2,o=0;o<e.length;o++){var s=this._endoSplit(t[o]),a=e[o],c=a._getBeta();s.k1.negative&&(s.k1.ineg(),a=a.neg(!0)),s.k2.negative&&(s.k2.ineg(),c=c.neg(!0)),r[2*o]=a,r[2*o+1]=c,i[2*o]=s.k1,i[2*o+1]=s.k2}for(var d=this._wnafMulAdd(1,r,i,2*o,n),u=0;u<2*o;u++)r[u]=null,i[u]=null;return d},se(he,ae.BasePoint),de.prototype.point=function(e,t,n){return new he(this,e,t,n)},de.prototype.pointFromJSON=function(e,t){return he.fromJSON(this,e,t)},he.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,r=function(e){return n.point(e.x.redMul(n.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(r)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(r)}}}return t}},he.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},he.fromJSON=function(e,t,n){"string"==typeof t&&(t=JSON.parse(t));var r=e.point(t[0],t[1],n);if(!t[2])return r;function i(t){return e.point(t[0],t[1],n)}var o=t[2];return r.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[r].concat(o.doubles.points.map(i))},naf:o.naf&&{wnd:o.naf.wnd,points:[r].concat(o.naf.points.map(i))}},r},he.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},he.prototype.isInfinity=function(){return this.inf},he.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var n=t.redSqr().redISub(this.x).redISub(e.x),r=t.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,r)},he.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,n=this.x.redSqr(),r=e.redInvm(),i=n.redAdd(n).redIAdd(n).redIAdd(t).redMul(r),o=i.redSqr().redISub(this.x.redAdd(this.x)),s=i.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,s)},he.prototype.getX=function(){return this.x.fromRed()},he.prototype.getY=function(){return this.y.fromRed()},he.prototype.mul=function(e){return e=new oe(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},he.prototype.mulAdd=function(e,t,n){var r=[this,t],i=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i):this.curve._wnafMulAdd(1,r,i,2)},he.prototype.jmulAdd=function(e,t,n){var r=[this,t],i=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i,!0):this.curve._wnafMulAdd(1,r,i,2,!0)},he.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},he.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,r=function(e){return e.neg()};t.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(r)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(r)}}}return t},he.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},se(fe,ae.BasePoint),de.prototype.jpoint=function(e,t,n){return new fe(this,e,t,n)},fe.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),n=this.x.redMul(t),r=this.y.redMul(t).redMul(e);return this.curve.point(n,r)},fe.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},fe.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),n=this.z.redSqr(),r=this.x.redMul(t),i=e.x.redMul(n),o=this.y.redMul(t.redMul(e.z)),s=e.y.redMul(n.redMul(this.z)),a=r.redSub(i),c=o.redSub(s);if(0===a.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var d=a.redSqr(),u=d.redMul(a),h=r.redMul(d),f=c.redSqr().redIAdd(u).redISub(h).redISub(h),l=c.redMul(h.redISub(f)).redISub(o.redMul(u)),A=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(f,l,A)},fe.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),n=this.x,r=e.x.redMul(t),i=this.y,o=e.y.redMul(t).redMul(this.z),s=n.redSub(r),a=i.redSub(o);if(0===s.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=s.redSqr(),d=c.redMul(s),u=n.redMul(c),h=a.redSqr().redIAdd(d).redISub(u).redISub(u),f=a.redMul(u.redISub(h)).redISub(i.redMul(d)),l=this.z.redMul(s);return this.curve.jpoint(h,f,l)},fe.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var n=this;for(t=0;t<e;t++)n=n.dbl();return n}var r=this.curve.a,i=this.curve.tinv,o=this.x,s=this.y,a=this.z,c=a.redSqr().redSqr(),d=s.redAdd(s);for(t=0;t<e;t++){var u=o.redSqr(),h=d.redSqr(),f=h.redSqr(),l=u.redAdd(u).redIAdd(u).redIAdd(r.redMul(c)),A=o.redMul(h),p=l.redSqr().redISub(A.redAdd(A)),b=A.redISub(p),m=l.redMul(b);m=m.redIAdd(m).redISub(f);var g=d.redMul(a);t+1<e&&(c=c.redMul(f)),o=p,a=g,d=m}return this.curve.jpoint(o,d.redMul(i),a)},fe.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},fe.prototype._zeroDbl=function(){var e,t,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),s=this.x.redAdd(i).redSqr().redISub(r).redISub(o);s=s.redIAdd(s);var a=r.redAdd(r).redIAdd(r),c=a.redSqr().redISub(s).redISub(s),d=o.redIAdd(o);d=(d=d.redIAdd(d)).redIAdd(d),e=c,t=a.redMul(s.redISub(c)).redISub(d),n=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),h=this.y.redSqr(),f=h.redSqr(),l=this.x.redAdd(h).redSqr().redISub(u).redISub(f);l=l.redIAdd(l);var A=u.redAdd(u).redIAdd(u),p=A.redSqr(),b=f.redIAdd(f);b=(b=b.redIAdd(b)).redIAdd(b),e=p.redISub(l).redISub(l),t=A.redMul(l.redISub(e)).redISub(b),n=(n=this.y.redMul(this.z)).redIAdd(n)}return this.curve.jpoint(e,t,n)},fe.prototype._threeDbl=function(){var e,t,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),s=this.x.redAdd(i).redSqr().redISub(r).redISub(o);s=s.redIAdd(s);var a=r.redAdd(r).redIAdd(r).redIAdd(this.curve.a),c=a.redSqr().redISub(s).redISub(s);e=c;var d=o.redIAdd(o);d=(d=d.redIAdd(d)).redIAdd(d),t=a.redMul(s.redISub(c)).redISub(d),n=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),h=this.y.redSqr(),f=this.x.redMul(h),l=this.x.redSub(u).redMul(this.x.redAdd(u));l=l.redAdd(l).redIAdd(l);var A=f.redIAdd(f),p=(A=A.redIAdd(A)).redAdd(A);e=l.redSqr().redISub(p),n=this.y.redAdd(this.z).redSqr().redISub(h).redISub(u);var b=h.redSqr();b=(b=(b=b.redIAdd(b)).redIAdd(b)).redIAdd(b),t=l.redMul(A.redISub(e)).redISub(b)}return this.curve.jpoint(e,t,n)},fe.prototype._dbl=function(){var e=this.curve.a,t=this.x,n=this.y,r=this.z,i=r.redSqr().redSqr(),o=t.redSqr(),s=n.redSqr(),a=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(i)),c=t.redAdd(t),d=(c=c.redIAdd(c)).redMul(s),u=a.redSqr().redISub(d.redAdd(d)),h=d.redISub(u),f=s.redSqr();f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var l=a.redMul(h).redISub(f),A=n.redAdd(n).redMul(r);return this.curve.jpoint(u,l,A)},fe.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr(),r=t.redSqr(),i=e.redAdd(e).redIAdd(e),o=i.redSqr(),s=this.x.redAdd(t).redSqr().redISub(e).redISub(r),a=(s=(s=(s=s.redIAdd(s)).redAdd(s).redIAdd(s)).redISub(o)).redSqr(),c=r.redIAdd(r);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var d=i.redIAdd(s).redSqr().redISub(o).redISub(a).redISub(c),u=t.redMul(d);u=(u=u.redIAdd(u)).redIAdd(u);var h=this.x.redMul(a).redISub(u);h=(h=h.redIAdd(h)).redIAdd(h);var f=this.y.redMul(d.redMul(c.redISub(d)).redISub(s.redMul(a)));f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var l=this.z.redAdd(s).redSqr().redISub(n).redISub(a);return this.curve.jpoint(h,f,l)},fe.prototype.mul=function(e,t){return e=new oe(e,t),this.curve._wnafMul(this,e)},fe.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),n=e.z.redSqr();if(0!==this.x.redMul(n).redISub(e.x.redMul(t)).cmpn(0))return!1;var r=t.redMul(this.z),i=n.redMul(e.z);return 0===this.y.redMul(i).redISub(e.y.redMul(r)).cmpn(0)},fe.prototype.eqXToP=function(e){var t=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(n))return!0;for(var r=e.clone(),i=this.curve.redN.redMul(t);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(i),0===this.x.cmp(n))return!0}},fe.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},fe.prototype.isInfinity=function(){return 0===this.z.cmpn(0)};var le=F,Ae=ie,pe=te,be=B;function me(e){pe.call(this,"mont",e),this.a=new le(e.a,16).toRed(this.red),this.b=new le(e.b,16).toRed(this.red),this.i4=new le(4).toRed(this.red).redInvm(),this.two=new le(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}Ae(me,pe);var ge=me;function ve(e,t,n){pe.BasePoint.call(this,e,"projective"),null===t&&null===n?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new le(t,16),this.z=new le(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}me.prototype.validate=function(e){var t=e.normalize().x,n=t.redSqr(),r=n.redMul(t).redAdd(n.redMul(this.a)).redAdd(t);return 0===r.redSqrt().redSqr().cmp(r)},Ae(ve,pe.BasePoint),me.prototype.decodePoint=function(e,t){return this.point(be.toArray(e,t),1)},me.prototype.point=function(e,t){return new ve(this,e,t)},me.prototype.pointFromJSON=function(e){return ve.fromJSON(this,e)},ve.prototype.precompute=function(){},ve.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},ve.fromJSON=function(e,t){return new ve(e,t[0],t[1]||e.one)},ve.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},ve.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},ve.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),n=e.redSub(t),r=e.redMul(t),i=n.redMul(t.redAdd(this.curve.a24.redMul(n)));return this.curve.point(r,i)},ve.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},ve.prototype.diffAdd=function(e,t){var n=this.x.redAdd(this.z),r=this.x.redSub(this.z),i=e.x.redAdd(e.z),o=e.x.redSub(e.z).redMul(n),s=i.redMul(r),a=t.z.redMul(o.redAdd(s).redSqr()),c=t.x.redMul(o.redISub(s).redSqr());return this.curve.point(a,c)},ve.prototype.mul=function(e){for(var t=e.clone(),n=this,r=this.curve.point(null,null),i=[];0!==t.cmpn(0);t.iushrn(1))i.push(t.andln(1));for(var o=i.length-1;o>=0;o--)0===i[o]?(n=n.diffAdd(r,this),r=r.dbl()):(r=n.diffAdd(r,this),n=n.dbl());return r},ve.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},ve.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},ve.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},ve.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},ve.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var ye=F,we=ie,_e=te,Me=B.assert;function Ee(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,_e.call(this,"edwards",e),this.a=new ye(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new ye(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new ye(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),Me(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}we(Ee,_e);var Se,ke=Ee;function Ce(e,t,n,r,i){_e.BasePoint.call(this,e,"projective"),null===t&&null===n&&null===r?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new ye(t,16),this.y=new ye(n,16),this.z=r?new ye(r,16):this.curve.one,this.t=i&&new ye(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}Ee.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},Ee.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},Ee.prototype.jpoint=function(e,t,n,r){return this.point(e,t,n,r)},Ee.prototype.pointFromX=function(e,t){(e=new ye(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr(),r=this.c2.redSub(this.a.redMul(n)),i=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=r.redMul(i.redInvm()),s=o.redSqrt();if(0!==s.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");var a=s.fromRed().isOdd();return(t&&!a||!t&&a)&&(s=s.redNeg()),this.point(e,s)},Ee.prototype.pointFromY=function(e,t){(e=new ye(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr(),r=n.redSub(this.c2),i=n.redMul(this.d).redMul(this.c2).redSub(this.a),o=r.redMul(i.redInvm());if(0===o.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var s=o.redSqrt();if(0!==s.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");return s.fromRed().isOdd()!==t&&(s=s.redNeg()),this.point(s,e)},Ee.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),n=e.y.redSqr(),r=t.redMul(this.a).redAdd(n),i=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(n)));return 0===r.cmp(i)},we(Ce,_e.BasePoint),Ee.prototype.pointFromJSON=function(e){return Ce.fromJSON(this,e)},Ee.prototype.point=function(e,t,n,r){return new Ce(this,e,t,n,r)},Ce.fromJSON=function(e,t){return new Ce(e,t[0],t[1],t[2])},Ce.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Ce.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},Ce.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var r=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),o=r.redAdd(t),s=o.redSub(n),a=r.redSub(t),c=i.redMul(s),d=o.redMul(a),u=i.redMul(a),h=s.redMul(o);return this.curve.point(c,d,h,u)},Ce.prototype._projDbl=function(){var e,t,n,r,i,o,s=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),c=this.y.redSqr();if(this.curve.twisted){var d=(r=this.curve._mulA(a)).redAdd(c);this.zOne?(e=s.redSub(a).redSub(c).redMul(d.redSub(this.curve.two)),t=d.redMul(r.redSub(c)),n=d.redSqr().redSub(d).redSub(d)):(i=this.z.redSqr(),o=d.redSub(i).redISub(i),e=s.redSub(a).redISub(c).redMul(o),t=d.redMul(r.redSub(c)),n=d.redMul(o))}else r=a.redAdd(c),i=this.curve._mulC(this.z).redSqr(),o=r.redSub(i).redSub(i),e=this.curve._mulC(s.redISub(r)).redMul(o),t=this.curve._mulC(r).redMul(a.redISub(c)),n=r.redMul(o);return this.curve.point(e,t,n)},Ce.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},Ce.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),r=this.t.redMul(this.curve.dd).redMul(e.t),i=this.z.redMul(e.z.redAdd(e.z)),o=n.redSub(t),s=i.redSub(r),a=i.redAdd(r),c=n.redAdd(t),d=o.redMul(s),u=a.redMul(c),h=o.redMul(c),f=s.redMul(a);return this.curve.point(d,u,f,h)},Ce.prototype._projAdd=function(e){var t,n,r=this.z.redMul(e.z),i=r.redSqr(),o=this.x.redMul(e.x),s=this.y.redMul(e.y),a=this.curve.d.redMul(o).redMul(s),c=i.redSub(a),d=i.redAdd(a),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(o).redISub(s),h=r.redMul(c).redMul(u);return this.curve.twisted?(t=r.redMul(d).redMul(s.redSub(this.curve._mulA(o))),n=c.redMul(d)):(t=r.redMul(d).redMul(s.redSub(o)),n=this.curve._mulC(c).redMul(d)),this.curve.point(h,t,n)},Ce.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},Ce.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},Ce.prototype.mulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!1)},Ce.prototype.jmulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!0)},Ce.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},Ce.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},Ce.prototype.getX=function(){return this.normalize(),this.x.fromRed()},Ce.prototype.getY=function(){return this.normalize(),this.y.fromRed()},Ce.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},Ce.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var n=e.clone(),r=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(r),0===this.x.cmp(t))return!0}},Ce.prototype.toP=Ce.prototype.normalize,Ce.prototype.mixedAdd=Ce.prototype.add,(Se=Y).base=te,Se.short=ue,Se.mont=ge,Se.edwards=ke;var Ie={},xe={},Oe={},Re=K,Pe=ie;function Te(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function Ne(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function Le(e){return 1===e.length?"0"+e:e}function Be(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}Oe.inherits=Pe,Oe.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)n.push(parseInt(e[i]+e[i+1],16))}else for(var r=0,i=0;i<e.length;i++){var o=e.charCodeAt(i);o<128?n[r++]=o:o<2048?(n[r++]=o>>6|192,n[r++]=63&o|128):Te(e,i)?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++i)),n[r++]=o>>18|240,n[r++]=o>>12&63|128,n[r++]=o>>6&63|128,n[r++]=63&o|128):(n[r++]=o>>12|224,n[r++]=o>>6&63|128,n[r++]=63&o|128)}else for(i=0;i<e.length;i++)n[i]=0|e[i];return n},Oe.toHex=function(e){for(var t="",n=0;n<e.length;n++)t+=Le(e[n].toString(16));return t},Oe.htonl=Ne,Oe.toHex32=function(e,t){for(var n="",r=0;r<e.length;r++){var i=e[r];"little"===t&&(i=Ne(i)),n+=Be(i.toString(16))}return n},Oe.zero2=Le,Oe.zero8=Be,Oe.join32=function(e,t,n,r){var i=n-t;Re(i%4==0);for(var o=new Array(i/4),s=0,a=t;s<o.length;s++,a+=4){var c;c="big"===r?e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3]:e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a],o[s]=c>>>0}return o},Oe.split32=function(e,t){for(var n=new Array(4*e.length),r=0,i=0;r<e.length;r++,i+=4){var o=e[r];"big"===t?(n[i]=o>>>24,n[i+1]=o>>>16&255,n[i+2]=o>>>8&255,n[i+3]=255&o):(n[i+3]=o>>>24,n[i+2]=o>>>16&255,n[i+1]=o>>>8&255,n[i]=255&o)}return n},Oe.rotr32=function(e,t){return e>>>t|e<<32-t},Oe.rotl32=function(e,t){return e<<t|e>>>32-t},Oe.sum32=function(e,t){return e+t>>>0},Oe.sum32_3=function(e,t,n){return e+t+n>>>0},Oe.sum32_4=function(e,t,n,r){return e+t+n+r>>>0},Oe.sum32_5=function(e,t,n,r,i){return e+t+n+r+i>>>0},Oe.sum64=function(e,t,n,r){var i=e[t],o=r+e[t+1]>>>0,s=(o<r?1:0)+n+i;e[t]=s>>>0,e[t+1]=o},Oe.sum64_hi=function(e,t,n,r){return(t+r>>>0<t?1:0)+e+n>>>0},Oe.sum64_lo=function(e,t,n,r){return t+r>>>0},Oe.sum64_4_hi=function(e,t,n,r,i,o,s,a){var c=0,d=t;return c+=(d=d+r>>>0)<t?1:0,c+=(d=d+o>>>0)<o?1:0,e+n+i+s+(c+=(d=d+a>>>0)<a?1:0)>>>0},Oe.sum64_4_lo=function(e,t,n,r,i,o,s,a){return t+r+o+a>>>0},Oe.sum64_5_hi=function(e,t,n,r,i,o,s,a,c,d){var u=0,h=t;return u+=(h=h+r>>>0)<t?1:0,u+=(h=h+o>>>0)<o?1:0,u+=(h=h+a>>>0)<a?1:0,e+n+i+s+c+(u+=(h=h+d>>>0)<d?1:0)>>>0},Oe.sum64_5_lo=function(e,t,n,r,i,o,s,a,c,d){return t+r+o+a+d>>>0},Oe.rotr64_hi=function(e,t,n){return(t<<32-n|e>>>n)>>>0},Oe.rotr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0},Oe.shr64_hi=function(e,t,n){return e>>>n},Oe.shr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0};var De={},je=Oe,Fe=K;function Ke(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}De.BlockHash=Ke,Ke.prototype.update=function(e,t){if(e=je.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var n=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=je.join32(e,0,e.length-n,this.endian);for(var r=0;r<e.length;r+=this._delta32)this._update(e,r,r+this._delta32)}return this},Ke.prototype.digest=function(e){return this.update(this._pad()),Fe(null===this.pending),this._digest(e)},Ke.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,r=new Array(n+this.padLength);r[0]=128;for(var i=1;i<n;i++)r[i]=0;if(e<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)r[i++]=0;r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=e>>>24&255,r[i++]=e>>>16&255,r[i++]=e>>>8&255,r[i++]=255&e}else for(r[i++]=255&e,r[i++]=e>>>8&255,r[i++]=e>>>16&255,r[i++]=e>>>24&255,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,o=8;o<this.padLength;o++)r[i++]=0;return r};var qe={},ze={},Ve=Oe.rotr32;function We(e,t,n){return e&t^~e&n}function Ue(e,t,n){return e&t^e&n^t&n}function Qe(e,t,n){return e^t^n}ze.ft_1=function(e,t,n,r){return 0===e?We(t,n,r):1===e||3===e?Qe(t,n,r):2===e?Ue(t,n,r):void 0},ze.ch32=We,ze.maj32=Ue,ze.p32=Qe,ze.s0_256=function(e){return Ve(e,2)^Ve(e,13)^Ve(e,22)},ze.s1_256=function(e){return Ve(e,6)^Ve(e,11)^Ve(e,25)},ze.g0_256=function(e){return Ve(e,7)^Ve(e,18)^e>>>3},ze.g1_256=function(e){return Ve(e,17)^Ve(e,19)^e>>>10};var He=Oe,Ye=De,$e=ze,Ge=He.rotl32,Ze=He.sum32,Je=He.sum32_5,Xe=$e.ft_1,et=Ye.BlockHash,tt=[1518500249,1859775393,2400959708,3395469782];function nt(){if(!(this instanceof nt))return new nt;et.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}He.inherits(nt,et);var rt=nt;nt.blockSize=512,nt.outSize=160,nt.hmacStrength=80,nt.padLength=64,nt.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=Ge(n[r-3]^n[r-8]^n[r-14]^n[r-16],1);var i=this.h[0],o=this.h[1],s=this.h[2],a=this.h[3],c=this.h[4];for(r=0;r<n.length;r++){var d=~~(r/20),u=Je(Ge(i,5),Xe(d,o,s,a),c,n[r],tt[d]);c=a,a=s,s=Ge(o,30),o=i,i=u}this.h[0]=Ze(this.h[0],i),this.h[1]=Ze(this.h[1],o),this.h[2]=Ze(this.h[2],s),this.h[3]=Ze(this.h[3],a),this.h[4]=Ze(this.h[4],c)},nt.prototype._digest=function(e){return"hex"===e?He.toHex32(this.h,"big"):He.split32(this.h,"big")};var it=Oe,ot=De,st=ze,at=K,ct=it.sum32,dt=it.sum32_4,ut=it.sum32_5,ht=st.ch32,ft=st.maj32,lt=st.s0_256,At=st.s1_256,pt=st.g0_256,bt=st.g1_256,mt=ot.BlockHash,gt=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function vt(){if(!(this instanceof vt))return new vt;mt.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=gt,this.W=new Array(64)}it.inherits(vt,mt);var yt=vt;vt.blockSize=512,vt.outSize=256,vt.hmacStrength=192,vt.padLength=64,vt.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=dt(bt(n[r-2]),n[r-7],pt(n[r-15]),n[r-16]);var i=this.h[0],o=this.h[1],s=this.h[2],a=this.h[3],c=this.h[4],d=this.h[5],u=this.h[6],h=this.h[7];for(at(this.k.length===n.length),r=0;r<n.length;r++){var f=ut(h,At(c),ht(c,d,u),this.k[r],n[r]),l=ct(lt(i),ft(i,o,s));h=u,u=d,d=c,c=ct(a,f),a=s,s=o,o=i,i=ct(f,l)}this.h[0]=ct(this.h[0],i),this.h[1]=ct(this.h[1],o),this.h[2]=ct(this.h[2],s),this.h[3]=ct(this.h[3],a),this.h[4]=ct(this.h[4],c),this.h[5]=ct(this.h[5],d),this.h[6]=ct(this.h[6],u),this.h[7]=ct(this.h[7],h)},vt.prototype._digest=function(e){return"hex"===e?it.toHex32(this.h,"big"):it.split32(this.h,"big")};var wt=Oe,_t=yt;function Mt(){if(!(this instanceof Mt))return new Mt;_t.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}wt.inherits(Mt,_t);var Et=Mt;Mt.blockSize=512,Mt.outSize=224,Mt.hmacStrength=192,Mt.padLength=64,Mt.prototype._digest=function(e){return"hex"===e?wt.toHex32(this.h.slice(0,7),"big"):wt.split32(this.h.slice(0,7),"big")};var St=Oe,kt=De,Ct=K,It=St.rotr64_hi,xt=St.rotr64_lo,Ot=St.shr64_hi,Rt=St.shr64_lo,Pt=St.sum64,Tt=St.sum64_hi,Nt=St.sum64_lo,Lt=St.sum64_4_hi,Bt=St.sum64_4_lo,Dt=St.sum64_5_hi,jt=St.sum64_5_lo,Ft=kt.BlockHash,Kt=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function qt(){if(!(this instanceof qt))return new qt;Ft.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=Kt,this.W=new Array(160)}St.inherits(qt,Ft);var zt=qt;function Vt(e,t,n,r,i){var o=e&n^~e&i;return o<0&&(o+=4294967296),o}function Wt(e,t,n,r,i,o){var s=t&r^~t&o;return s<0&&(s+=4294967296),s}function Ut(e,t,n,r,i){var o=e&n^e&i^n&i;return o<0&&(o+=4294967296),o}function Qt(e,t,n,r,i,o){var s=t&r^t&o^r&o;return s<0&&(s+=4294967296),s}function Ht(e,t){var n=It(e,t,28)^It(t,e,2)^It(t,e,7);return n<0&&(n+=4294967296),n}function Yt(e,t){var n=xt(e,t,28)^xt(t,e,2)^xt(t,e,7);return n<0&&(n+=4294967296),n}function $t(e,t){var n=It(e,t,14)^It(e,t,18)^It(t,e,9);return n<0&&(n+=4294967296),n}function Gt(e,t){var n=xt(e,t,14)^xt(e,t,18)^xt(t,e,9);return n<0&&(n+=4294967296),n}function Zt(e,t){var n=It(e,t,1)^It(e,t,8)^Ot(e,t,7);return n<0&&(n+=4294967296),n}function Jt(e,t){var n=xt(e,t,1)^xt(e,t,8)^Rt(e,t,7);return n<0&&(n+=4294967296),n}function Xt(e,t){var n=It(e,t,19)^It(t,e,29)^Ot(e,t,6);return n<0&&(n+=4294967296),n}function en(e,t){var n=xt(e,t,19)^xt(t,e,29)^Rt(e,t,6);return n<0&&(n+=4294967296),n}qt.blockSize=1024,qt.outSize=512,qt.hmacStrength=192,qt.padLength=128,qt.prototype._prepareBlock=function(e,t){for(var n=this.W,r=0;r<32;r++)n[r]=e[t+r];for(;r<n.length;r+=2){var i=Xt(n[r-4],n[r-3]),o=en(n[r-4],n[r-3]),s=n[r-14],a=n[r-13],c=Zt(n[r-30],n[r-29]),d=Jt(n[r-30],n[r-29]),u=n[r-32],h=n[r-31];n[r]=Lt(i,o,s,a,c,d,u,h),n[r+1]=Bt(i,o,s,a,c,d,u,h)}},qt.prototype._update=function(e,t){this._prepareBlock(e,t);var n=this.W,r=this.h[0],i=this.h[1],o=this.h[2],s=this.h[3],a=this.h[4],c=this.h[5],d=this.h[6],u=this.h[7],h=this.h[8],f=this.h[9],l=this.h[10],A=this.h[11],p=this.h[12],b=this.h[13],m=this.h[14],g=this.h[15];Ct(this.k.length===n.length);for(var v=0;v<n.length;v+=2){var y=m,w=g,_=$t(h,f),M=Gt(h,f),E=Vt(h,0,l,0,p),S=Wt(0,f,0,A,0,b),k=this.k[v],C=this.k[v+1],I=n[v],x=n[v+1],O=Dt(y,w,_,M,E,S,k,C,I,x),R=jt(y,w,_,M,E,S,k,C,I,x);y=Ht(r,i),w=Yt(r,i),_=Ut(r,0,o,0,a),M=Qt(0,i,0,s,0,c);var P=Tt(y,w,_,M),T=Nt(y,w,_,M);m=p,g=b,p=l,b=A,l=h,A=f,h=Tt(d,u,O,R),f=Nt(u,u,O,R),d=a,u=c,a=o,c=s,o=r,s=i,r=Tt(O,R,P,T),i=Nt(O,R,P,T)}Pt(this.h,0,r,i),Pt(this.h,2,o,s),Pt(this.h,4,a,c),Pt(this.h,6,d,u),Pt(this.h,8,h,f),Pt(this.h,10,l,A),Pt(this.h,12,p,b),Pt(this.h,14,m,g)},qt.prototype._digest=function(e){return"hex"===e?St.toHex32(this.h,"big"):St.split32(this.h,"big")};var tn=Oe,nn=zt;function rn(){if(!(this instanceof rn))return new rn;nn.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}tn.inherits(rn,nn);var on=rn;rn.blockSize=1024,rn.outSize=384,rn.hmacStrength=192,rn.padLength=128,rn.prototype._digest=function(e){return"hex"===e?tn.toHex32(this.h.slice(0,12),"big"):tn.split32(this.h.slice(0,12),"big")},qe.sha1=rt,qe.sha224=Et,qe.sha256=yt,qe.sha384=on,qe.sha512=zt;var sn={},an=Oe,cn=De,dn=an.rotl32,un=an.sum32,hn=an.sum32_3,fn=an.sum32_4,ln=cn.BlockHash;function An(){if(!(this instanceof An))return new An;ln.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function pn(e,t,n,r){return e<=15?t^n^r:e<=31?t&n|~t&r:e<=47?(t|~n)^r:e<=63?t&r|n&~r:t^(n|~r)}function bn(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function mn(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}an.inherits(An,ln),sn.ripemd160=An,An.blockSize=512,An.outSize=160,An.hmacStrength=192,An.padLength=64,An.prototype._update=function(e,t){for(var n=this.h[0],r=this.h[1],i=this.h[2],o=this.h[3],s=this.h[4],a=n,c=r,d=i,u=o,h=s,f=0;f<80;f++){var l=un(dn(fn(n,pn(f,r,i,o),e[gn[f]+t],bn(f)),yn[f]),s);n=s,s=o,o=dn(i,10),i=r,r=l,l=un(dn(fn(a,pn(79-f,c,d,u),e[vn[f]+t],mn(f)),wn[f]),h),a=h,h=u,u=dn(d,10),d=c,c=l}l=hn(this.h[1],i,u),this.h[1]=hn(this.h[2],o,h),this.h[2]=hn(this.h[3],s,a),this.h[3]=hn(this.h[4],n,c),this.h[4]=hn(this.h[0],r,d),this.h[0]=l},An.prototype._digest=function(e){return"hex"===e?an.toHex32(this.h,"little"):an.split32(this.h,"little")};var gn=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],vn=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],yn=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],wn=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],_n=Oe,Mn=K;function En(e,t,n){if(!(this instanceof En))return new En(e,t,n);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(_n.toArray(t,n))}var Sn,kn,Cn=En;En.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),Mn(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},En.prototype.update=function(e,t){return this.inner.update(e,t),this},En.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)},function(e){var t=xe;t.utils=Oe,t.common=De,t.sha=qe,t.ripemd=sn,t.hmac=Cn,t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160}(),function(e){var t,n=Ie,r=xe,i=Y,o=B.assert;function s(e){"short"===e.type?this.curve=new i.short(e):"edwards"===e.type?this.curve=new i.edwards(e):this.curve=new i.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,o(this.g.validate(),"Invalid curve"),o(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function a(e,t){Object.defineProperty(n,e,{configurable:!0,enumerable:!0,get:function(){var r=new s(t);return Object.defineProperty(n,e,{configurable:!0,enumerable:!0,value:r}),r}})}n.PresetCurve=s,a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{t=kn?Sn:(kn=1,Sn={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}})}catch(e){t=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",t]})}();var In=xe,xn=z,On=K;function Rn(e){if(!(this instanceof Rn))return new Rn(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=xn.toArray(e.entropy,e.entropyEnc||"hex"),n=xn.toArray(e.nonce,e.nonceEnc||"hex"),r=xn.toArray(e.pers,e.persEnc||"hex");On(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,n,r)}var Pn=Rn;Rn.prototype._init=function(e,t,n){var r=e.concat(t).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(r),this._reseed=1,this.reseedInterval=281474976710656},Rn.prototype._hmac=function(){return new In.hmac(this.hash,this.K)},Rn.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},Rn.prototype.reseed=function(e,t,n,r){"string"!=typeof t&&(r=n,n=t,t=null),e=xn.toArray(e,t),n=xn.toArray(n,r),On(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this._reseed=1},Rn.prototype.generate=function(e,t,n,r){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(r=n,n=t,t=null),n&&(n=xn.toArray(n,r||"hex"),this._update(n));for(var i=[];i.length<e;)this.V=this._hmac().update(this.V).digest(),i=i.concat(this.V);var o=i.slice(0,e);return this._update(n),this._reseed++,xn.encode(o,t)};var Tn=F,Nn=B.assert;function Ln(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var Bn=Ln;Ln.fromPublic=function(e,t,n){return t instanceof Ln?t:new Ln(e,{pub:t,pubEnc:n})},Ln.fromPrivate=function(e,t,n){return t instanceof Ln?t:new Ln(e,{priv:t,privEnc:n})},Ln.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},Ln.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},Ln.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},Ln.prototype._importPrivate=function(e,t){this.priv=new Tn(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},Ln.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?Nn(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||Nn(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},Ln.prototype.derive=function(e){return e.validate()||Nn(e.validate(),"public point not validated"),e.mul(this.priv).getX()},Ln.prototype.sign=function(e,t,n){return this.ec.sign(e,this,t,n)},Ln.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},Ln.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var Dn=F,jn=B,Fn=jn.assert;function Kn(e,t){if(e instanceof Kn)return e;this._importDER(e,t)||(Fn(e.r&&e.s,"Signature without r or s"),this.r=new Dn(e.r,16),this.s=new Dn(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}var qn=Kn;function zn(){this.place=0}function Vn(e,t){var n=e[t.place++];if(!(128&n))return n;var r=15&n;if(0===r||r>4)return!1;for(var i=0,o=0,s=t.place;o<r;o++,s++)i<<=8,i|=e[s],i>>>=0;return!(i<=127)&&(t.place=s,i)}function Wn(e){for(var t=0,n=e.length-1;!e[t]&&!(128&e[t+1])&&t<n;)t++;return 0===t?e:e.slice(t)}function Un(e,t){if(t<128)e.push(t);else{var n=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|n);--n;)e.push(t>>>(n<<3)&255);e.push(t)}}Kn.prototype._importDER=function(e,t){e=jn.toArray(e,t);var n=new zn;if(48!==e[n.place++])return!1;var r=Vn(e,n);if(!1===r)return!1;if(r+n.place!==e.length)return!1;if(2!==e[n.place++])return!1;var i=Vn(e,n);if(!1===i)return!1;var o=e.slice(n.place,i+n.place);if(n.place+=i,2!==e[n.place++])return!1;var s=Vn(e,n);if(!1===s)return!1;if(e.length!==s+n.place)return!1;var a=e.slice(n.place,s+n.place);if(0===o[0]){if(!(128&o[1]))return!1;o=o.slice(1)}if(0===a[0]){if(!(128&a[1]))return!1;a=a.slice(1)}return this.r=new Dn(o),this.s=new Dn(a),this.recoveryParam=null,!0},Kn.prototype.toDER=function(e){var t=this.r.toArray(),n=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&n[0]&&(n=[0].concat(n)),t=Wn(t),n=Wn(n);!(n[0]||128&n[1]);)n=n.slice(1);var r=[2];Un(r,t.length),(r=r.concat(t)).push(2),Un(r,n.length);var i=r.concat(n),o=[48];return Un(o,i.length),o=o.concat(i),jn.encode(o,e)};var Qn=F,Hn=Pn,Yn=Ie,$n=H,Gn=B.assert,Zn=Bn,Jn=qn;function Xn(e){if(!(this instanceof Xn))return new Xn(e);"string"==typeof e&&(Gn(Object.prototype.hasOwnProperty.call(Yn,e),"Unknown curve "+e),e=Yn[e]),e instanceof Yn.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}var er=Xn;Xn.prototype.keyPair=function(e){return new Zn(this,e)},Xn.prototype.keyFromPrivate=function(e,t){return Zn.fromPrivate(this,e,t)},Xn.prototype.keyFromPublic=function(e,t){return Zn.fromPublic(this,e,t)},Xn.prototype.genKeyPair=function(e){e||(e={});for(var t=new Hn({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||$n(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),r=this.n.sub(new Qn(2));;){var i=new Qn(t.generate(n));if(!(i.cmp(r)>0))return i.iaddn(1),this.keyFromPrivate(i)}},Xn.prototype._truncateToN=function(e,t){var n=8*e.byteLength()-this.n.bitLength();return n>0&&(e=e.ushrn(n)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},Xn.prototype.sign=function(e,t,n,r){"object"==typeof n&&(r=n,n=null),r||(r={}),t=this.keyFromPrivate(t,n),e=this._truncateToN(new Qn(e,16));for(var i=this.n.byteLength(),o=t.getPrivate().toArray("be",i),s=e.toArray("be",i),a=new Hn({hash:this.hash,entropy:o,nonce:s,pers:r.pers,persEnc:r.persEnc||"utf8"}),c=this.n.sub(new Qn(1)),d=0;;d++){var u=r.k?r.k(d):new Qn(a.generate(this.n.byteLength()));if(!((u=this._truncateToN(u,!0)).cmpn(1)<=0||u.cmp(c)>=0)){var h=this.g.mul(u);if(!h.isInfinity()){var f=h.getX(),l=f.umod(this.n);if(0!==l.cmpn(0)){var A=u.invm(this.n).mul(l.mul(t.getPrivate()).iadd(e));if(0!==(A=A.umod(this.n)).cmpn(0)){var p=(h.getY().isOdd()?1:0)|(0!==f.cmp(l)?2:0);return r.canonical&&A.cmp(this.nh)>0&&(A=this.n.sub(A),p^=1),new Jn({r:l,s:A,recoveryParam:p})}}}}}},Xn.prototype.verify=function(e,t,n,r){e=this._truncateToN(new Qn(e,16)),n=this.keyFromPublic(n,r);var i=(t=new Jn(t,"hex")).r,o=t.s;if(i.cmpn(1)<0||i.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var s,a=o.invm(this.n),c=a.mul(e).umod(this.n),d=a.mul(i).umod(this.n);return this.curve._maxwellTrick?!(s=this.g.jmulAdd(c,n.getPublic(),d)).isInfinity()&&s.eqXToP(i):!(s=this.g.mulAdd(c,n.getPublic(),d)).isInfinity()&&0===s.getX().umod(this.n).cmp(i)},Xn.prototype.recoverPubKey=function(e,t,n,r){Gn((3&n)===n,"The recovery param is more than two bits"),t=new Jn(t,r);var i=this.n,o=new Qn(e),s=t.r,a=t.s,c=1&n,d=n>>1;if(s.cmp(this.curve.p.umod(this.curve.n))>=0&&d)throw new Error("Unable to find sencond key candinate");s=d?this.curve.pointFromX(s.add(this.curve.n),c):this.curve.pointFromX(s,c);var u=t.r.invm(i),h=i.sub(o).mul(u).umod(i),f=a.mul(u).umod(i);return this.g.mulAdd(h,s,f)},Xn.prototype.getKeyRecoveryParam=function(e,t,n,r){if(null!==(t=new Jn(t,r)).recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var o;try{o=this.recoverPubKey(e,t,i)}catch(e){continue}if(o.eq(n))return i}throw new Error("Unable to find valid recovery factor")};var tr=B,nr=tr.assert,rr=tr.parseBytes,ir=tr.cachedProperty;function or(e,t){this.eddsa=e,this._secret=rr(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=rr(t.pub)}or.fromPublic=function(e,t){return t instanceof or?t:new or(e,{pub:t})},or.fromSecret=function(e,t){return t instanceof or?t:new or(e,{secret:t})},or.prototype.secret=function(){return this._secret},ir(or,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),ir(or,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),ir(or,"privBytes",(function(){var e=this.eddsa,t=this.hash(),n=e.encodingLength-1,r=t.slice(0,e.encodingLength);return r[0]&=248,r[n]&=127,r[n]|=64,r})),ir(or,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),ir(or,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),ir(or,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),or.prototype.sign=function(e){return nr(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},or.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},or.prototype.getSecret=function(e){return nr(this._secret,"KeyPair is public only"),tr.encode(this.secret(),e)},or.prototype.getPublic=function(e){return tr.encode(this.pubBytes(),e)};var sr=or,ar=F,cr=B,dr=cr.assert,ur=cr.cachedProperty,hr=cr.parseBytes;function fr(e,t){this.eddsa=e,"object"!=typeof t&&(t=hr(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),dr(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof ar&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}ur(fr,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),ur(fr,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),ur(fr,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),ur(fr,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),fr.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},fr.prototype.toHex=function(){return cr.encode(this.toBytes(),"hex").toUpperCase()};var lr=fr,Ar=xe,pr=Ie,br=B,mr=br.assert,gr=br.parseBytes,vr=sr,yr=lr;function wr(e){if(mr("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof wr))return new wr(e);e=pr[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=Ar.sha512}var _r=wr;wr.prototype.sign=function(e,t){e=gr(e);var n=this.keyFromSecret(t),r=this.hashInt(n.messagePrefix(),e),i=this.g.mul(r),o=this.encodePoint(i),s=this.hashInt(o,n.pubBytes(),e).mul(n.priv()),a=r.add(s).umod(this.curve.n);return this.makeSignature({R:i,S:a,Rencoded:o})},wr.prototype.verify=function(e,t,n){e=gr(e),t=this.makeSignature(t);var r=this.keyFromPublic(n),i=this.hashInt(t.Rencoded(),r.pubBytes(),e),o=this.g.mul(t.S());return t.R().add(r.pub().mul(i)).eq(o)},wr.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return br.intFromLE(e.digest()).umod(this.curve.n)},wr.prototype.keyFromPublic=function(e){return vr.fromPublic(this,e)},wr.prototype.keyFromSecret=function(e){return vr.fromSecret(this,e)},wr.prototype.makeSignature=function(e){return e instanceof yr?e:new yr(this,e)},wr.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},wr.prototype.decodePoint=function(e){var t=(e=br.parseBytes(e)).length-1,n=e.slice(0,t).concat(-129&e[t]),r=0!=(128&e[t]),i=br.intFromLE(n);return this.curve.pointFromY(i,r)},wr.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},wr.prototype.decodeInt=function(e){return br.intFromLE(e)},wr.prototype.isPoint=function(e){return e instanceof this.pointClass},function(e){var t=L;t.version="6.5.4",t.utils=B,t.rand=H,t.curve=Y,t.curves=Ie,t.ec=er,t.eddsa=_r}();const Mr=new L.ec("secp256k1"),Er=Mr.curve,Sr=Er.n.constructor;function kr(e){const t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){let n=new Sr(t);if(n.cmp(Er.p)>=0)return null;n=n.toRed(Er.red);let r=n.redSqr().redIMul(n).redIAdd(Er.b).redSqrt();return 3===e!==r.isOdd()&&(r=r.redNeg()),Mr.keyPair({pub:{x:n,y:r}})}(t,e.subarray(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,n){let r=new Sr(t),i=new Sr(n);if(r.cmp(Er.p)>=0||i.cmp(Er.p)>=0)return null;if(r=r.toRed(Er.red),i=i.toRed(Er.red),(6===e||7===e)&&i.isOdd()!==(7===e))return null;const o=r.redSqr().redIMul(r);return i.redSqr().redISub(o.redIAdd(Er.b)).isZero()?Mr.keyPair({pub:{x:r,y:i}}):null}(t,e.subarray(1,33),e.subarray(33,65));default:return null}}function Cr(e,t){const n=t.encode(null,33===e.length);for(let t=0;t<e.length;++t)e[t]=n[t]}var Ir,xr,Or={contextRandomize:()=>0,privateKeyVerify(e){const t=new Sr(e);return t.cmp(Er.n)<0&&!t.isZero()?0:1},privateKeyNegate(e){const t=new Sr(e),n=Er.n.sub(t).umod(Er.n).toArrayLike(Uint8Array,"be",32);return e.set(n),0},privateKeyTweakAdd(e,t){const n=new Sr(t);if(n.cmp(Er.n)>=0)return 1;if(n.iadd(new Sr(e)),n.cmp(Er.n)>=0&&n.isub(Er.n),n.isZero())return 1;const r=n.toArrayLike(Uint8Array,"be",32);return e.set(r),0},privateKeyTweakMul(e,t){let n=new Sr(t);if(n.cmp(Er.n)>=0||n.isZero())return 1;n.imul(new Sr(e)),n.cmp(Er.n)>=0&&(n=n.umod(Er.n));const r=n.toArrayLike(Uint8Array,"be",32);return e.set(r),0},publicKeyVerify:e=>null===kr(e)?1:0,publicKeyCreate(e,t){const n=new Sr(t);return n.cmp(Er.n)>=0||n.isZero()?1:(Cr(e,Mr.keyFromPrivate(t).getPublic()),0)},publicKeyConvert(e,t){const n=kr(t);return null===n?1:(Cr(e,n.getPublic()),0)},publicKeyNegate(e,t){const n=kr(t);if(null===n)return 1;const r=n.getPublic();return r.y=r.y.redNeg(),Cr(e,r),0},publicKeyCombine(e,t){const n=new Array(t.length);for(let e=0;e<t.length;++e)if(n[e]=kr(t[e]),null===n[e])return 1;let r=n[0].getPublic();for(let e=1;e<n.length;++e)r=r.add(n[e].pub);return r.isInfinity()?2:(Cr(e,r),0)},publicKeyTweakAdd(e,t,n){const r=kr(t);if(null===r)return 1;if((n=new Sr(n)).cmp(Er.n)>=0)return 2;const i=r.getPublic().add(Er.g.mul(n));return i.isInfinity()?2:(Cr(e,i),0)},publicKeyTweakMul(e,t,n){const r=kr(t);return null===r?1:(n=new Sr(n)).cmp(Er.n)>=0||n.isZero()?2:(Cr(e,r.getPublic().mul(n)),0)},signatureNormalize(e){const t=new Sr(e.subarray(0,32)),n=new Sr(e.subarray(32,64));return t.cmp(Er.n)>=0||n.cmp(Er.n)>=0?1:(1===n.cmp(Mr.nh)&&e.set(Er.n.sub(n).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){const n=t.subarray(0,32),r=t.subarray(32,64);if(new Sr(n).cmp(Er.n)>=0)return 1;if(new Sr(r).cmp(Er.n)>=0)return 1;const{output:i}=e;let o=i.subarray(4,37);o[0]=0,o.set(n,1);let s=33,a=0;for(;s>1&&0===o[a]&&!(128&o[a+1]);--s,++a);if(o=o.subarray(a),128&o[0])return 1;if(s>1&&0===o[0]&&!(128&o[1]))return 1;let c=i.subarray(39,72);c[0]=0,c.set(r,1);let d=33,u=0;for(;d>1&&0===c[u]&&!(128&c[u+1]);--d,++u);return c=c.subarray(u),128&c[0]||d>1&&0===c[0]&&!(128&c[1])?1:(e.outputlen=6+s+d,i[0]=48,i[1]=e.outputlen-2,i[2]=2,i[3]=o.length,i.set(o,4),i[4+s]=2,i[5+s]=c.length,i.set(c,6+s),0)},signatureImport(e,t){if(t.length<8)return 1;if(t.length>72)return 1;if(48!==t[0])return 1;if(t[1]!==t.length-2)return 1;if(2!==t[2])return 1;const n=t[3];if(0===n)return 1;if(5+n>=t.length)return 1;if(2!==t[4+n])return 1;const r=t[5+n];if(0===r)return 1;if(6+n+r!==t.length)return 1;if(128&t[4])return 1;if(n>1&&0===t[4]&&!(128&t[5]))return 1;if(128&t[n+6])return 1;if(r>1&&0===t[n+6]&&!(128&t[n+7]))return 1;let i=t.subarray(4,4+n);if(33===i.length&&0===i[0]&&(i=i.subarray(1)),i.length>32)return 1;let o=t.subarray(6+n);if(33===o.length&&0===o[0]&&(o=o.slice(1)),o.length>32)throw new Error("S length is too long");let s=new Sr(i);s.cmp(Er.n)>=0&&(s=new Sr(0));let a=new Sr(t.subarray(6+n));return a.cmp(Er.n)>=0&&(a=new Sr(0)),e.set(s.toArrayLike(Uint8Array,"be",32),0),e.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t,n,r,i){if(i){const e=i;i=i=>{const o=e(t,n,null,r,i);if(!(o instanceof Uint8Array&&32===o.length))throw new Error("This is the way");return new Sr(o)}}const o=new Sr(n);if(o.cmp(Er.n)>=0||o.isZero())return 1;let s;try{s=Mr.sign(t,n,{canonical:!0,k:i,pers:r})}catch(e){return 1}return e.signature.set(s.r.toArrayLike(Uint8Array,"be",32),0),e.signature.set(s.s.toArrayLike(Uint8Array,"be",32),32),e.recid=s.recoveryParam,0},ecdsaVerify(e,t,n){const r={r:e.subarray(0,32),s:e.subarray(32,64)},i=new Sr(r.r),o=new Sr(r.s);if(i.cmp(Er.n)>=0||o.cmp(Er.n)>=0)return 1;if(1===o.cmp(Mr.nh)||i.isZero()||o.isZero())return 3;const s=kr(n);if(null===s)return 2;const a=s.getPublic();return Mr.verify(t,r,a)?0:3},ecdsaRecover(e,t,n,r){const i={r:t.slice(0,32),s:t.slice(32,64)},o=new Sr(i.r),s=new Sr(i.s);if(o.cmp(Er.n)>=0||s.cmp(Er.n)>=0)return 1;if(o.isZero()||s.isZero())return 2;let a;try{a=Mr.recoverPubKey(r,i,n)}catch(e){return 2}return Cr(e,a),0},ecdh(e,t,n,r,i,o,s){const a=kr(t);if(null===a)return 1;const c=new Sr(n);if(c.cmp(Er.n)>=0||c.isZero())return 2;const d=a.getPublic().mul(c);if(void 0===i){const t=d.encode(null,!0),n=Mr.hash().update(t).digest();for(let t=0;t<32;++t)e[t]=n[t]}else{o||(o=new Uint8Array(32));const t=d.getX().toArray("be",32);for(let e=0;e<32;++e)o[e]=t[e];s||(s=new Uint8Array(32));const n=d.getY().toArray("be",32);for(let e=0;e<32;++e)s[e]=n[e];const a=i(o,s,r);if(!(a instanceof Uint8Array&&a.length===e.length))return 2;e.set(a)}return 0}},Rr=(xr=Or,{contextRandomize(e){if(O(null===e||e instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),null!==e&&R("seed",e,32),1===xr.contextRandomize(e))throw new Error("Unknow error on context randomization")},privateKeyVerify:e=>(R("private key",e,32),0===xr.privateKeyVerify(e)),privateKeyNegate(e){switch(R("private key",e,32),xr.privateKeyNegate(e)){case 0:return e;case 1:throw new Error(E)}},privateKeyTweakAdd(e,t){switch(R("private key",e,32),R("tweak",t,32),xr.privateKeyTweakAdd(e,t)){case 0:return e;case 1:throw new Error(S)}},privateKeyTweakMul(e,t){switch(R("private key",e,32),R("tweak",t,32),xr.privateKeyTweakMul(e,t)){case 0:return e;case 1:throw new Error(k)}},publicKeyVerify:e=>(R("public key",e,[33,65]),0===xr.publicKeyVerify(e)),publicKeyCreate(e,t=!0,n){switch(R("private key",e,32),P(t),n=T(n,t?33:65),xr.publicKeyCreate(n,e)){case 0:return n;case 1:throw new Error("Private Key is invalid");case 2:throw new Error(I)}},publicKeyConvert(e,t=!0,n){switch(R("public key",e,[33,65]),P(t),n=T(n,t?33:65),xr.publicKeyConvert(n,e)){case 0:return n;case 1:throw new Error(C);case 2:throw new Error(I)}},publicKeyNegate(e,t=!0,n){switch(R("public key",e,[33,65]),P(t),n=T(n,t?33:65),xr.publicKeyNegate(n,e)){case 0:return n;case 1:throw new Error(C);case 2:throw new Error(E);case 3:throw new Error(I)}},publicKeyCombine(e,t=!0,n){O(Array.isArray(e),"Expected public keys to be an Array"),O(e.length>0,"Expected public keys array will have more than zero items");for(const t of e)R("public key",t,[33,65]);switch(P(t),n=T(n,t?33:65),xr.publicKeyCombine(n,e)){case 0:return n;case 1:throw new Error(C);case 2:throw new Error("The sum of the public keys is not valid");case 3:throw new Error(I)}},publicKeyTweakAdd(e,t,n=!0,r){switch(R("public key",e,[33,65]),R("tweak",t,32),P(n),r=T(r,n?33:65),xr.publicKeyTweakAdd(r,e,t)){case 0:return r;case 1:throw new Error(C);case 2:throw new Error(S)}},publicKeyTweakMul(e,t,n=!0,r){switch(R("public key",e,[33,65]),R("tweak",t,32),P(n),r=T(r,n?33:65),xr.publicKeyTweakMul(r,e,t)){case 0:return r;case 1:throw new Error(C);case 2:throw new Error(k)}},signatureNormalize(e){switch(R("signature",e,64),xr.signatureNormalize(e)){case 0:return e;case 1:throw new Error(x)}},signatureExport(e,t){R("signature",e,64);const n={output:t=T(t,72),outputlen:72};switch(xr.signatureExport(n,e)){case 0:return t.slice(0,n.outputlen);case 1:throw new Error(x);case 2:throw new Error(E)}},signatureImport(e,t){switch(R("signature",e),t=T(t,64),xr.signatureImport(t,e)){case 0:return t;case 1:throw new Error(x);case 2:throw new Error(E)}},ecdsaSign(e,t,n={},r){R("message",e,32),R("private key",t,32),O("Object"===N(n),"Expected options to be an Object"),void 0!==n.data&&R("options.data",n.data),void 0!==n.noncefn&&O("Function"===N(n.noncefn),"Expected options.noncefn to be a Function");const i={signature:r=T(r,64),recid:null};switch(xr.ecdsaSign(i,e,t,n.data,n.noncefn)){case 0:return i;case 1:throw new Error("The nonce generation function failed, or the private key was invalid");case 2:throw new Error(E)}},ecdsaVerify(e,t,n){switch(R("signature",e,64),R("message",t,32),R("public key",n,[33,65]),xr.ecdsaVerify(e,t,n)){case 0:return!0;case 3:return!1;case 1:throw new Error(x);case 2:throw new Error(C)}},ecdsaRecover(e,t,n,r=!0,i){switch(R("signature",e,64),O("Number"===N(t)&&t>=0&&t<=3,"Expected recovery id to be a Number within interval [0, 3]"),R("message",n,32),P(r),i=T(i,r?33:65),xr.ecdsaRecover(i,e,t,n)){case 0:return i;case 1:throw new Error(x);case 2:throw new Error("Public key could not be recover");case 3:throw new Error(E)}},ecdh(e,t,n={},r){switch(R("public key",e,[33,65]),R("private key",t,32),O("Object"===N(n),"Expected options to be an Object"),void 0!==n.data&&R("options.data",n.data),void 0!==n.hashfn?(O("Function"===N(n.hashfn),"Expected options.hashfn to be a Function"),void 0!==n.xbuf&&R("options.xbuf",n.xbuf,32),void 0!==n.ybuf&&R("options.ybuf",n.ybuf,32),R("output",r)):r=T(r,32),xr.ecdh(r,e,t,n.data,n.hashfn,n.xbuf,n.ybuf)){case 0:return r;case 1:throw new Error(C);case 2:throw new Error("Scalar was invalid (zero or overflow)")}}}),Pr={},Tr={};Ir=Tr,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.SECRET_KEY_LENGTH=Ir.AES_IV_PLUS_TAG_LENGTH=Ir.AES_TAG_LENGTH=Ir.AES_IV_LENGTH=Ir.UNCOMPRESSED_PUBLIC_KEY_SIZE=void 0,Ir.UNCOMPRESSED_PUBLIC_KEY_SIZE=65,Ir.AES_IV_LENGTH=16,Ir.AES_TAG_LENGTH=16,Ir.AES_IV_PLUS_TAG_LENGTH=Ir.AES_IV_LENGTH+Ir.AES_TAG_LENGTH,Ir.SECRET_KEY_LENGTH=32;var Nr=u&&u.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.aesDecrypt=Pr.aesEncrypt=Pr.getValidSecret=Pr.decodeHex=Pr.remove0x=void 0;var Lr=n,Br=Nr(Rr),Dr=Tr;function jr(e){return e.startsWith("0x")||e.startsWith("0X")?e.slice(2):e}Pr.remove0x=jr,Pr.decodeHex=function(e){return Buffer.from(jr(e),"hex")},Pr.getValidSecret=function(){var e;do{e=(0,Lr.randomBytes)(Dr.SECRET_KEY_LENGTH)}while(!Br.default.privateKeyVerify(e));return e},Pr.aesEncrypt=function(e,t){var n=(0,Lr.randomBytes)(Dr.AES_IV_LENGTH),r=(0,Lr.createCipheriv)("aes-256-gcm",e,n),i=Buffer.concat([r.update(t),r.final()]),o=r.getAuthTag();return Buffer.concat([n,o,i])},Pr.aesDecrypt=function(e,t){var n=t.slice(0,Dr.AES_IV_LENGTH),r=t.slice(Dr.AES_IV_LENGTH,Dr.AES_IV_PLUS_TAG_LENGTH),i=t.slice(Dr.AES_IV_PLUS_TAG_LENGTH),o=(0,Lr.createDecipheriv)("aes-256-gcm",e,n);return o.setAuthTag(r),Buffer.concat([o.update(i),o.final()])};var Fr={},Kr=u&&u.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Fr,"__esModule",{value:!0});var qr=Kr(M),zr=Kr(Rr),Vr=Pr,Wr=Tr,Ur=function(){function e(e){this.uncompressed=Buffer.from(zr.default.publicKeyConvert(e,!1)),this.compressed=Buffer.from(zr.default.publicKeyConvert(e,!0))}return e.fromHex=function(t){var n=(0,Vr.decodeHex)(t);if(n.length===Wr.UNCOMPRESSED_PUBLIC_KEY_SIZE-1){var r=Buffer.from([4]);return new e(Buffer.concat([r,n]))}return new e(n)},e.prototype.toHex=function(e){return void 0===e&&(e=!0),e?this.compressed.toString("hex"):this.uncompressed.toString("hex")},e.prototype.decapsulate=function(e){var t=Buffer.concat([this.uncompressed,e.multiply(this)]);return(0,qr.default)(t,32,{hash:"SHA-256"})},e.prototype.equals=function(e){return this.uncompressed.equals(e.uncompressed)},e}();Fr.default=Ur;var Qr=u&&u.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(A,"__esModule",{value:!0});var Hr=Qr(M),Yr=Qr(Rr),$r=Pr,Gr=Qr(Fr),Zr=function(){function e(e){if(this.secret=e||(0,$r.getValidSecret)(),!Yr.default.privateKeyVerify(this.secret))throw new Error("Invalid private key");this.publicKey=new Gr.default(Buffer.from(Yr.default.publicKeyCreate(this.secret)))}return e.fromHex=function(t){return new e((0,$r.decodeHex)(t))},e.prototype.toHex=function(){return"0x".concat(this.secret.toString("hex"))},e.prototype.encapsulate=function(e){var t=Buffer.concat([this.publicKey.uncompressed,this.multiply(e)]);return(0,Hr.default)(t,32,{hash:"SHA-256"})},e.prototype.multiply=function(e){return Buffer.from(Yr.default.publicKeyTweakMul(e.compressed,this.secret,!1))},e.prototype.equals=function(e){return this.secret.equals(e.secret)},e}();A.default=Zr,function(e){var t=u&&u.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.PublicKey=e.PrivateKey=void 0;var n=A;Object.defineProperty(e,"PrivateKey",{enumerable:!0,get:function(){return t(n).default}});var r=Fr;Object.defineProperty(e,"PublicKey",{enumerable:!0,get:function(){return t(r).default}})}(l),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.utils=e.PublicKey=e.PrivateKey=e.decrypt=e.encrypt=void 0;var t=l,n=Pr,r=Tr;e.encrypt=function(e,r){var i=new t.PrivateKey,o=e instanceof Buffer?new t.PublicKey(e):t.PublicKey.fromHex(e),s=i.encapsulate(o),a=(0,n.aesEncrypt)(s,r);return Buffer.concat([i.publicKey.uncompressed,a])},e.decrypt=function(e,i){var o=e instanceof Buffer?new t.PrivateKey(e):t.PrivateKey.fromHex(e),s=new t.PublicKey(i.slice(0,r.UNCOMPRESSED_PUBLIC_KEY_SIZE)),a=i.slice(r.UNCOMPRESSED_PUBLIC_KEY_SIZE),c=s.decapsulate(o);return(0,n.aesDecrypt)(c,a)};var i=l;Object.defineProperty(e,"PrivateKey",{enumerable:!0,get:function(){return i.PrivateKey}}),Object.defineProperty(e,"PublicKey",{enumerable:!0,get:function(){return i.PublicKey}}),e.utils={aesDecrypt:n.aesDecrypt,aesEncrypt:n.aesEncrypt,decodeHex:n.decodeHex,getValidSecret:n.getValidSecret,remove0x:n.remove0x}}(f);class Jr{constructor(e){this.enabled=!0,this.debug=!1,(null==e?void 0:e.debug)&&(this.debug=e.debug),(null==e?void 0:e.pkey)?this.ecies=f.PrivateKey.fromHex(e.pkey):this.ecies=new f.PrivateKey,this.debug&&(console.info("[ECIES] initialized secret: ",this.ecies.toHex()),console.info("[ECIES] initialized public: ",this.ecies.publicKey.toHex()),console.info("[ECIES] init with",this))}generateECIES(){this.ecies=new f.PrivateKey}getPublicKey(){return this.ecies.publicKey.toHex()}encrypt(e,n){let r=e;if(this.enabled)try{const i=t.from(e),o=f.encrypt(n,i);r=t.from(o).toString("base64")}catch(t){throw this.debug&&(console.error("error encrypt:",t),console.error("private: ",this.ecies.toHex()),console.error("data: ",e),console.error("otherkey: ",n)),t}return r}decrypt(e){let n=e;if(this.enabled)try{const r=t.from(e.toString(),"base64");n=f.decrypt(this.ecies.toHex(),r).toString()}catch(t){throw this.debug&&(console.error("error decrypt",t),console.error("private: ",this.ecies.toHex()),console.error("encryptedData: ",e)),t}return n}getKeyInfo(){return{private:this.ecies.toHex(),public:this.ecies.publicKey.toHex()}}toString(){console.debug("ECIES::toString()",this.getKeyInfo())}}function Xr(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;var ei={exports:{}};
/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */!function(e,t){!function(t){var n=Object.hasOwnProperty,r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i="object"==typeof process&&"function"==typeof process.nextTick,o="function"==typeof Symbol,s="object"==typeof Reflect,a="function"==typeof setImmediate?setImmediate:setTimeout,c=o?s&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function d(){this._events={},this._conf&&u.call(this,this._conf)}function u(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==t&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function h(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),"undefined"!=typeof process&&process.emitWarning){var r=new Error(n);r.name="MaxListenersExceededWarning",r.emitter=this,r.count=e,process.emitWarning(r)}else console.error(n),console.trace&&console.trace()}var f=function(e,t,n){var r=arguments.length;switch(r){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var i=new Array(r);r--;)i[r]=arguments[r];return i}};function l(e,n){for(var r={},i=e.length,o=n?n.length:0,s=0;s<i;s++)r[e[s]]=s<o?n[s]:t;return r}function A(e,t,n){var r,i;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(r=n.on,i=n.off),t.addEventListener?(r=t.addEventListener,i=t.removeEventListener):t.addListener?(r=t.addListener,i=t.removeListener):t.on&&(r=t.on,i=t.off),!r&&!i)throw Error("target does not implement any known event API");if("function"!=typeof r)throw TypeError("on method must be a function");if("function"!=typeof i)throw TypeError("off method must be a function");this._on=r,this._off=i;var o=e._observers;o?o.push(this):e._observers=[this]}function p(e,r,i,o){var s=Object.assign({},r);if(!e)return s;if("object"!=typeof e)throw TypeError("options must be an object");var a,c,d,u=Object.keys(e),h=u.length;function f(e){throw Error('Invalid "'+a+'" option value'+(e?". Reason: "+e:""))}for(var l=0;l<h;l++){if(a=u[l],!o&&!n.call(r,a))throw Error('Unknown "'+a+'" option');(c=e[a])!==t&&(d=i[a],s[a]=d?d(c,f):c)}return s}function b(e,t){return"function"==typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function m(e){var t="value must be type of "+e.join("|"),n=e.length,r=e[0],i=e[1];return 1===n?function(e,n){if(typeof e===r)return e;n(t)}:2===n?function(e,n){var o=typeof e;if(o===r||o===i)return e;n(t)}:function(r,i){for(var o=typeof r,s=n;s-- >0;)if(o===e[s])return r;i(t)}}Object.assign(A.prototype,{subscribe:function(e,t,n){var r=this,i=this._target,o=this._emitter,s=this._listeners,a=function(){var r=f.apply(null,arguments),s={data:r,name:t,original:e};n?!1!==n.call(i,s)&&o.emit.apply(o,[s.name].concat(r)):o.emit.apply(o,[t].concat(r))};if(s[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,o._newListener&&o._removeListener&&!r._onNewListener?(this._onNewListener=function(n){n===t&&null===s[e]&&(s[e]=a,r._on.call(i,e,a))},o.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===t&&!o.hasListeners(n)&&s[e]&&(s[e]=null,r._off.call(i,e,a))},s[e]=null,o.on("removeListener",this._onRemoveListener)):(s[e]=a,r._on.call(i,e,a))},unsubscribe:function(e){var t,n,r,i=this,o=this._listeners,s=this._emitter,a=this._off,d=this._target;if(e&&"string"!=typeof e)throw TypeError("event must be a string");function u(){i._onNewListener&&(s.off("newListener",i._onNewListener),s.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var e=w.call(s,i);s._observers.splice(e,1)}if(e){if(!(t=o[e]))return;a.call(d,e,t),delete o[e],--this._listenersCount||u()}else{for(r=(n=c(o)).length;r-- >0;)e=n[r],a.call(d,e,o[e]);this._listeners={},this._listenersCount=0,u()}}});var g=m(["function"]),v=m(["object","function"]);function y(e,t,n){var r,i,o,s=0,a=new e((function(c,d,u){function h(){i&&(i=null),s&&(clearTimeout(s),s=0)}n=p(n,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!=typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),r=!n.overload&&"function"==typeof e.prototype.cancel&&"function"==typeof u;var f=function(e){h(),c(e)},l=function(e){h(),d(e)};r?t(f,l,u):(i=[function(e){l(e||Error("canceled"))}],t(f,l,(function(e){if(o)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof e)throw TypeError("onCancel callback must be a function");i.push(e)})),o=!0),n.timeout>0&&(s=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",s=0,a.cancel(e),d(e)}),n.timeout))}));return r||(a.cancel=function(e){if(i){for(var t=i.length,n=1;n<t;n++)i[n](e);i[0](e),i=null}}),a}function w(e){var t=this._observers;if(!t)return-1;for(var n=t.length,r=0;r<n;r++)if(t[r]._target===e)return r;return-1}function _(e,t,n,r,i){if(!n)return null;if(0===r){var o=typeof t;if("string"===o){var s,a,d=0,u=0,h=this.delimiter,f=h.length;if(-1!==(a=t.indexOf(h))){s=new Array(5);do{s[d++]=t.slice(u,a),u=a+f}while(-1!==(a=t.indexOf(h,u)));s[d++]=t.slice(u),t=s,i=d}else t=[t],i=1}else"object"===o?i=t.length:(t=[t],i=1)}var l,A,p,b,m,g,v,y=null,w=t[r],M=t[r+1];if(r===i)n._listeners&&("function"==typeof n._listeners?(e&&e.push(n._listeners),y=[n]):(e&&e.push.apply(e,n._listeners),y=[n]));else{if("*"===w){for(a=(g=c(n)).length;a-- >0;)"_listeners"!==(l=g[a])&&(v=_(e,t,n[l],r+1,i))&&(y?y.push.apply(y,v):y=v);return y}if("**"===w){for((m=r+1===i||r+2===i&&"*"===M)&&n._listeners&&(y=_(e,t,n,i,i)),a=(g=c(n)).length;a-- >0;)"_listeners"!==(l=g[a])&&("*"===l||"**"===l?(n[l]._listeners&&!m&&(v=_(e,t,n[l],i,i))&&(y?y.push.apply(y,v):y=v),v=_(e,t,n[l],r,i)):v=_(e,t,n[l],l===M?r+2:r,i),v&&(y?y.push.apply(y,v):y=v));return y}n[w]&&(y=_(e,t,n[w],r+1,i))}if((A=n["*"])&&_(e,t,A,r+1,i),p=n["**"])if(r<i)for(p._listeners&&_(e,t,p,i,i),a=(g=c(p)).length;a-- >0;)"_listeners"!==(l=g[a])&&(l===M?_(e,t,p[l],r+2,i):l===w?_(e,t,p[l],r+1,i):((b={})[l]=p[l],_(e,t,{"**":b},r+1,i)));else p._listeners?_(e,t,p,i,i):p["*"]&&p["*"]._listeners&&_(e,t,p["*"],i,i);return y}function M(e,t,n){var r,i,o=0,s=0,a=this.delimiter,c=a.length;if("string"==typeof e)if(-1!==(r=e.indexOf(a))){i=new Array(5);do{i[o++]=e.slice(s,r),s=r+c}while(-1!==(r=e.indexOf(a,s)));i[o++]=e.slice(s)}else i=[e],o=1;else i=e,o=e.length;if(o>1)for(r=0;r+1<o;r++)if("**"===i[r]&&"**"===i[r+1])return;var d,u=this.listenerTree;for(r=0;r<o;r++)if(u=u[d=i[r]]||(u[d]={}),r===o-1)return u._listeners?("function"==typeof u._listeners&&(u._listeners=[u._listeners]),n?u._listeners.unshift(t):u._listeners.push(t),!u._listeners.warned&&this._maxListeners>0&&u._listeners.length>this._maxListeners&&(u._listeners.warned=!0,h.call(this,u._listeners.length,d))):u._listeners=t,!0;return!0}function E(e,t,n,r){for(var i,o,s,a,d=c(e),u=d.length,h=e._listeners;u-- >0;)i=e[o=d[u]],s="_listeners"===o?n:n?n.concat(o):[o],a=r||"symbol"==typeof o,h&&t.push(a?s:s.join(this.delimiter)),"object"==typeof i&&E.call(this,i,t,s,a);return t}function S(e){for(var t,n,r,i=c(e),o=i.length;o-- >0;)(t=e[n=i[o]])&&(r=!0,"_listeners"===n||S(t)||delete e[n]);return r}function k(e,t,n){this.emitter=e,this.event=t,this.listener=n}function C(e,n,r){if(!0===r)s=!0;else if(!1===r)o=!0;else{if(!r||"object"!=typeof r)throw TypeError("options should be an object or true");var o=r.async,s=r.promisify,c=r.nextTick,d=r.objectify}if(o||c||s){var u=n,h=n._origin||n;if(c&&!i)throw Error("process.nextTick is not supported");s===t&&(s="AsyncFunction"===n.constructor.name),n=function(){var e=arguments,t=this,n=this.event;return s?c?Promise.resolve():new Promise((function(e){a(e)})).then((function(){return t.event=n,u.apply(t,e)})):(c?process.nextTick:a)((function(){t.event=n,u.apply(t,e)}))},n._async=!0,n._origin=h}return[n,d?new k(this,e,n):this]}function I(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,u.call(this,e)}k.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},I.EventEmitter2=I,I.prototype.listenTo=function(e,n,i){if("object"!=typeof e)throw TypeError("target musts be an object");var o=this;function s(t){if("object"!=typeof t)throw TypeError("events must be an object");var n,r=i.reducers,s=w.call(o,e);n=-1===s?new A(o,e,i):o._observers[s];for(var a,d=c(t),u=d.length,h="function"==typeof r,f=0;f<u;f++)a=d[f],n.subscribe(a,t[a]||a,h?r:r&&r[a])}return i=p(i,{on:t,off:t,reducers:t},{on:g,off:g,reducers:v}),r(n)?s(l(n)):s("string"==typeof n?l(n.split(/\s+/)):n),this},I.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var r,i=n.length,o=!1;if(e&&"object"!=typeof e)throw TypeError("target should be an object");for(;i-- >0;)r=n[i],e&&r._target!==e||(r.unsubscribe(t),o=!0);return o},I.prototype.delimiter=".",I.prototype.setMaxListeners=function(e){e!==t&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},I.prototype.getMaxListeners=function(){return this._maxListeners},I.prototype.event="",I.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},I.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},I.prototype._once=function(e,t,n,r){return this._many(e,1,t,n,r)},I.prototype.many=function(e,t,n,r){return this._many(e,t,n,!1,r)},I.prototype.prependMany=function(e,t,n,r){return this._many(e,t,n,!0,r)},I.prototype._many=function(e,t,n,r,i){var o=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function s(){return 0==--t&&o.off(e,s),n.apply(this,arguments)}return s._origin=n,this._on(e,s,r,i)},I.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||d.call(this);var e,t,n,r,i,s,a=arguments[0],c=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return!1;if(c&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(n=a.length,o)for(r=0;r<n;r++)if("symbol"==typeof a[r]){s=!0;break}s||(a=a.join(this.delimiter))}var u,h=arguments.length;if(this._all&&this._all.length)for(r=0,n=(u=this._all.slice()).length;r<n;r++)switch(this.event=a,h){case 1:u[r].call(this,a);break;case 2:u[r].call(this,a,arguments[1]);break;case 3:u[r].call(this,a,arguments[1],arguments[2]);break;default:u[r].apply(this,arguments)}if(c)u=[],_.call(this,u,e,this.listenerTree,0,n);else{if("function"==typeof(u=this._events[a])){switch(this.event=a,h){case 1:u.call(this);break;case 2:u.call(this,arguments[1]);break;case 3:u.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(h-1),i=1;i<h;i++)t[i-1]=arguments[i];u.apply(this,t)}return!0}u&&(u=u.slice())}if(u&&u.length){if(h>3)for(t=new Array(h-1),i=1;i<h;i++)t[i-1]=arguments[i];for(r=0,n=u.length;r<n;r++)switch(this.event=a,h){case 1:u[r].call(this);break;case 2:u[r].call(this,arguments[1]);break;case 3:u[r].call(this,arguments[1],arguments[2]);break;default:u[r].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===a)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},I.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||d.call(this);var e,t,n,r,i,s,a=arguments[0],c=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(c&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(r=a.length,o)for(i=0;i<r;i++)if("symbol"==typeof a[i]){t=!0;break}t||(a=a.join(this.delimiter))}var u,h=[],f=arguments.length;if(this._all)for(i=0,r=this._all.length;i<r;i++)switch(this.event=a,f){case 1:h.push(this._all[i].call(this,a));break;case 2:h.push(this._all[i].call(this,a,arguments[1]));break;case 3:h.push(this._all[i].call(this,a,arguments[1],arguments[2]));break;default:h.push(this._all[i].apply(this,arguments))}if(c?(u=[],_.call(this,u,e,this.listenerTree,0)):u=this._events[a],"function"==typeof u)switch(this.event=a,f){case 1:h.push(u.call(this));break;case 2:h.push(u.call(this,arguments[1]));break;case 3:h.push(u.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(f-1),s=1;s<f;s++)n[s-1]=arguments[s];h.push(u.apply(this,n))}else if(u&&u.length){if(u=u.slice(),f>3)for(n=new Array(f-1),s=1;s<f;s++)n[s-1]=arguments[s];for(i=0,r=u.length;i<r;i++)switch(this.event=a,f){case 1:h.push(u[i].call(this));break;case 2:h.push(u[i].call(this,arguments[1]));break;case 3:h.push(u[i].call(this,arguments[1],arguments[2]));break;default:h.push(u[i].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===a)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(h)},I.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},I.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},I.prototype.onAny=function(e){return this._onAny(e,!1)},I.prototype.prependAny=function(e){return this._onAny(e,!0)},I.prototype.addListener=I.prototype.on,I.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},I.prototype._on=function(e,n,r,i){if("function"==typeof e)return this._onAny(e,n),this;if("function"!=typeof n)throw new Error("on only accepts instances of Function");this._events||d.call(this);var o,s=this;return i!==t&&(n=(o=C.call(this,e,n,i))[0],s=o[1]),this._newListener&&this.emit("newListener",e,n),this.wildcard?(M.call(this,e,n,r),s):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),r?this._events[e].unshift(n):this._events[e].push(n),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,h.call(this,this._events[e].length,e))):this._events[e]=n,s)},I.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,i=[];if(this.wildcard){var o="string"==typeof e?e.split(this.delimiter):e.slice();if(!(i=_.call(this,null,o,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],i.push({_listeners:n})}for(var s=0;s<i.length;s++){var a=i[s];if(n=a._listeners,r(n)){for(var c=-1,d=0,u=n.length;d<u;d++)if(n[d]===t||n[d].listener&&n[d].listener===t||n[d]._origin&&n[d]._origin===t){c=d;break}if(c<0)continue;return this.wildcard?a._listeners.splice(c,1):this._events[e].splice(c,1),0===n.length&&(this.wildcard?delete a._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete a._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&S(this.listenerTree),this},I.prototype.offAny=function(e){var t,n=0,r=0;if(e&&this._all&&this._all.length>0){for(n=0,r=(t=this._all).length;n<r;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,r=t.length;n<r;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},I.prototype.removeListener=I.prototype.off,I.prototype.removeAllListeners=function(e){if(e===t)return!this._events||d.call(this),this;if(this.wildcard){var n,r=_.call(this,null,e,this.listenerTree,0);if(!r)return this;for(n=0;n<r.length;n++)r[n]._listeners=null;this.listenerTree&&S(this.listenerTree)}else this._events&&(this._events[e]=null);return this},I.prototype.listeners=function(e){var n,r,i,o,s,a=this._events;if(e===t){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!a)return[];for(o=(n=c(a)).length,i=[];o-- >0;)"function"==typeof(r=a[n[o]])?i.push(r):i.push.apply(i,r);return i}if(this.wildcard){if(!(s=this.listenerTree))return[];var d=[],u="string"==typeof e?e.split(this.delimiter):e.slice();return _.call(this,d,u,s,0),d}return a&&(r=a[e])?"function"==typeof r?[r]:r:[]},I.prototype.eventNames=function(e){var t=this._events;return this.wildcard?E.call(this,this.listenerTree,[],null,e):t?c(t):[]},I.prototype.listenerCount=function(e){return this.listeners(e).length},I.prototype.hasListeners=function(e){if(this.wildcard){var n=[],r="string"==typeof e?e.split(this.delimiter):e.slice();return _.call(this,n,r,this.listenerTree,0),n.length>0}var i=this._events,o=this._all;return!!(o&&o.length||i&&(e===t?c(i).length:i[e]))},I.prototype.listenersAny=function(){return this._all?this._all:[]},I.prototype.waitFor=function(e,n){var r=this,i=typeof n;return"number"===i?n={timeout:n}:"function"===i&&(n={filter:n}),y((n=p(n,{timeout:0,filter:t,handleError:!1,Promise:Promise,overload:!1},{filter:g,Promise:b})).Promise,(function(t,i,o){function s(){var o=n.filter;if(!o||o.apply(r,arguments))if(r.off(e,s),n.handleError){var a=arguments[0];a?i(a):t(f.apply(null,arguments).slice(1))}else t(f.apply(null,arguments))}o((function(){r.off(e,s)})),r._on(e,s,!1)}),{timeout:n.timeout,overload:n.overload})};var x=I.prototype;Object.defineProperties(I,{defaultMaxListeners:{get:function(){return x._maxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");x._maxListeners=e},enumerable:!0},once:{value:function(e,t,n){return y((n=p(n,{Promise:Promise,timeout:0,overload:!1},{Promise:b})).Promise,(function(n,r,i){var o;if("function"==typeof e.addEventListener)return o=function(){n(f.apply(null,arguments))},i((function(){e.removeEventListener(t,o)})),void e.addEventListener(t,o,{once:!0});var s,a=function(){s&&e.removeListener("error",s),n(f.apply(null,arguments))};"error"!==t&&(s=function(n){e.removeListener(t,a),r(n)},e.once("error",s)),i((function(){s&&e.removeListener("error",s),e.removeListener(t,a)})),e.once(t,a)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(x,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),"function"==typeof t&&t.amd?t((function(){return I})):e.exports=I}()}(ei);var ti,ni,ri=ei.exports,ii="0.6.0";function oi(e){const{debug:t,context:n}=e;t&&console.debug(`RemoteCommunication::${n}::clean()`),e.channelConfig=void 0,e.ready=!1,e.originatorConnectStarted=!1}!function(e){e.KEY_INFO="key_info",e.SERVICE_STATUS="service_status",e.PROVIDER_UPDATE="provider_update",e.KEYS_EXCHANGED="keys_exchanged",e.JOIN_CHANNEL="join_channel",e.CHANNEL_CREATED="channel_created",e.CLIENTS_CONNECTED="clients_connected",e.CLIENTS_DISCONNECTED="clients_disconnected",e.CLIENTS_WAITING="clients_waiting",e.CLIENTS_READY="clients_ready",e.SOCKET_DISCONNECTED="socket_disconnected",e.SOCKET_RECONNECT="socket_reconnect",e.OTP="otp",e.SDK_RPC_CALL="sdk_rpc_call",e.AUTHORIZED="authorized",e.CONNECTION_STATUS="connection_status",e.MESSAGE="message",e.TERMINATE="terminate"}(ti||(ti={})),function(e){e.TERMINATE="terminate",e.ANSWER="answer",e.OFFER="offer",e.CANDIDATE="candidate",e.JSONRPC="jsonrpc",e.WALLET_INFO="wallet_info",e.ORIGINATOR_INFO="originator_info",e.PAUSE="pause",e.OTP="otp",e.AUTHORIZED="authorized",e.PING="ping",e.READY="ready"}(ni||(ni={}));const si="https://metamask-sdk-socket.metafi.codefi.network/",ai=["polling","websocket"],ci=6048e5,di="eth_requestAccounts";var ui,hi;!function(e){e.DISCONNECTED="disconnected",e.WAITING="waiting",e.TIMEOUT="timeout",e.LINKED="linked",e.PAUSED="paused",e.TERMINATED="terminated"}(ui||(ui={}));var fi=new Uint8Array(16);function li(){if(!hi&&!(hi="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return hi(fi)}var Ai=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function pi(e){return"string"==typeof e&&Ai.test(e)}for(var bi=[],mi=0;mi<256;++mi)bi.push((mi+256).toString(16).substr(1));function gi(e,t,n){var r=(e=e||{}).random||(e.rng||li)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(bi[e[t+0]]+bi[e[t+1]]+bi[e[t+2]]+bi[e[t+3]]+"-"+bi[e[t+4]]+bi[e[t+5]]+"-"+bi[e[t+6]]+bi[e[t+7]]+"-"+bi[e[t+8]]+bi[e[t+9]]+"-"+bi[e[t+10]]+bi[e[t+11]]+bi[e[t+12]]+bi[e[t+13]]+bi[e[t+14]]+bi[e[t+15]]).toLowerCase();if(!pi(n))throw TypeError("Stringified UUID is invalid");return n}(r)}const vi=Object.create(null);vi.open="0",vi.close="1",vi.ping="2",vi.pong="3",vi.message="4",vi.upgrade="5",vi.noop="6";const yi=Object.create(null);Object.keys(vi).forEach((e=>{yi[vi[e]]=e}));const wi={type:"error",data:"parser error"},_i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Mi="function"==typeof ArrayBuffer,Ei=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Si=({type:e,data:t},n,r)=>_i&&t instanceof Blob?n?r(t):ki(t,r):Mi&&(t instanceof ArrayBuffer||Ei(t))?n?r(t):ki(new Blob([t]),r):r(vi[e]+(t||"")),ki=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function Ci(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Ii;function xi(e,t){return _i&&e.data instanceof Blob?e.data.arrayBuffer().then(Ci).then(t):Mi&&(e.data instanceof ArrayBuffer||Ei(e.data))?t(Ci(e.data)):void Si(e,!1,(e=>{Ii||(Ii=new TextEncoder),t(Ii.encode(e))}))}const Oi="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<64;e++)Oi["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=e;const Ri="function"==typeof ArrayBuffer,Pi=(e,t)=>{if("string"!=typeof e)return{type:"message",data:Ni(e,t)};const n=e.charAt(0);return"b"===n?{type:"message",data:Ti(e.substring(1),t)}:yi[n]?e.length>1?{type:yi[n],data:e.substring(1)}:{type:yi[n]}:wi},Ti=(e,t)=>{if(Ri){const n=(e=>{let t,n,r,i,o,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);const d=new ArrayBuffer(s),u=new Uint8Array(d);for(t=0;t<a;t+=4)n=Oi[e.charCodeAt(t)],r=Oi[e.charCodeAt(t+1)],i=Oi[e.charCodeAt(t+2)],o=Oi[e.charCodeAt(t+3)],u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|i>>2,u[c++]=(3&i)<<6|63&o;return d})(e);return Ni(n,t)}return{base64:!0,data:e}},Ni=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,Li=String.fromCharCode(30);let Bi;var Di=ji;function ji(e){if(e)return function(e){for(var t in ji.prototype)e[t]=ji.prototype[t];return e}(e)}ji.prototype.on=ji.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},ji.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},ji.prototype.off=ji.prototype.removeListener=ji.prototype.removeAllListeners=ji.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},ji.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},ji.prototype.emitReserved=ji.prototype.emit,ji.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},ji.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Fi="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function Ki(e,...t){return t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{})}const qi=Fi.setTimeout,zi=Fi.clearTimeout;function Vi(e,t){t.useNativeTimers?(e.setTimeoutFn=qi.bind(Fi),e.clearTimeoutFn=zi.bind(Fi)):(e.setTimeoutFn=Fi.setTimeout.bind(Fi),e.clearTimeoutFn=Fi.clearTimeout.bind(Fi))}var Wi,Ui,Qi={exports:{}};var Hi=function(e){function t(e){let r,i,o,s=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),o=i-(r||i);n.diff=o,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";s++;const o=t.formatters[i];if("function"==typeof o){const t=e[s];r=o.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=function(){if(Ui)return Wi;Ui=1;var e=1e3,t=60*e,n=60*t,r=24*n;function i(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}return Wi=function(o,s){s=s||{};var a=typeof o;if("string"===a&&o.length>0)return function(i){if(!((i=String(i)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(o){var s=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*r;case"hours":case"hour":case"hrs":case"hr":case"h":return s*n;case"minutes":case"minute":case"mins":case"min":case"m":return s*t;case"seconds":case"second":case"secs":case"sec":case"s":return s*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(o);if("number"===a&&isFinite(o))return s.long?function(o){var s=Math.abs(o);return s>=r?i(o,s,r,"day"):s>=n?i(o,s,n,"hour"):s>=t?i(o,s,t,"minute"):s>=e?i(o,s,e,"second"):o+" ms"}(o):function(i){var o=Math.abs(i);return o>=r?Math.round(i/r)+"d":o>=n?Math.round(i/n)+"h":o>=t?Math.round(i/t)+"m":o>=e?Math.round(i/e)+"s":i+"ms"}(o);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(o))}}(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t};!function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=Hi(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(Qi,Qi.exports);var Yi=h(Qi.exports);const $i=Yi("engine.io-client:transport");class Gi extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class Zi extends Di{constructor(e){super(),this.writable=!1,Vi(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,n){return super.emitReserved("error",new Gi(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState?this.write(e):$i("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Pi(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}const Ji="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Xi=64,eo={};let to,no=0,ro=0;function io(e){let t="";do{t=Ji[e%Xi]+t,e=Math.floor(e/Xi)}while(e>0);return t}function oo(){const e=io(+new Date);return e!==to?(no=0,to=e):e+"."+io(no++)}for(;ro<Xi;ro++)eo[Ji[ro]]=ro;let so=!1;try{so="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(xr){}const ao=so;function co(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||ao))return new XMLHttpRequest}catch(e){}if(!t)try{return new(Fi[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}const uo=Yi("engine.io-client:polling");function ho(){}const fo=null!=new co({xdomain:!1}).responseType;class lo extends Di{constructor(e,t){super(),Vi(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;const t=Ki(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const n=this.xhr=new co(t);try{uo("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(n)),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof n.status?n.status:0)}),0))},uo("xhr data %s",this.data),n.send(this.data)}catch(e){return void this.setTimeoutFn((()=>{this.onError(e)}),0)}"undefined"!=typeof document&&(this.index=lo.requestsCount++,lo.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=ho,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete lo.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}function Ao(){for(let e in lo.requests)lo.requests.hasOwnProperty(e)&&lo.requests[e].abort()}lo.requestsCount=0,lo.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",Ao):"function"==typeof addEventListener&&addEventListener("onpagehide"in Fi?"pagehide":"unload",Ao,!1));const po="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),bo=Fi.WebSocket||Fi.MozWebSocket,mo=Yi("engine.io-client:websocket"),go="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),vo=Yi("engine.io-client:webtransport");function yo(e,t){return"message"===e.type&&"string"!=typeof e.data&&t[0]>=48&&t[0]<=54}const wo={websocket:class extends Zi{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=go?{}:Ki(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=go?new bo(e,t,n):t?new bo(e,t):new bo(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;Si(n,this.supportsBinary,(e=>{try{this.ws.send(e)}catch(e){mo("websocket closed before onclose event")}r&&po((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=oo()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!bo}},webtransport:class extends Zi{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{vo("transport closed gracefully"),this.onClose()})).catch((e=>{vo("transport closed due to %s",e),this.onError("webtransport error",e)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((e=>{const t=e.readable.getReader();let n;this.writer=e.writable.getWriter();const r=()=>{t.read().then((({done:e,value:t})=>{e?vo("session is closed"):(vo("received chunk: %o",t),n||1!==t.byteLength||54!==t[0]?(this.onPacket(function(e,t,n){Bi||(Bi=new TextDecoder);const r=t||e[0]<48||e[0]>54;return Pi(r?e:Bi.decode(e),"arraybuffer")}(t,n)),n=!1):n=!0,r())})).catch((e=>{vo("an error occurred while reading: %s",e)}))};r();const i=this.query.sid?`0{"sid":"${this.query.sid}"}`:"0";this.writer.write((new TextEncoder).encode(i)).then((()=>this.onOpen()))}))})))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;xi(n,(e=>{yo(n,e)&&(vo("writing binary header"),this.writer.write(Uint8Array.of(54))),vo("writing chunk: %o",e),this.writer.write(e).then((()=>{r&&po((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}))}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}},polling:class extends Zi{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port}const t=e&&e.forceBase64;this.supportsBinary=fo&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{uo("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(uo("we are currently polling - waiting to pause"),e++,this.once("pollComplete",(function(){uo("pre-pause polling complete"),--e||t()}))),this.writable||(uo("we are currently writing - waiting to pause"),e++,this.once("drain",(function(){uo("pre-pause writing complete"),--e||t()})))}else t()}poll(){uo("polling"),this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){uo("polling got data %s",e),((e,t)=>{const n=e.split(Li),r=[];for(let e=0;e<n.length;e++){const i=Pi(n[e],t);if(r.push(i),"error"===i.type)break}return r})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this.poll():uo('ignoring poll - transport state "%s"',this.readyState))}doClose(){const e=()=>{uo("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(uo("transport open - closing"),e()):(uo("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,((e,t)=>{const n=e.length,r=new Array(n);let i=0;e.forEach(((e,o)=>{Si(e,!1,(e=>{r[o]=e,++i===n&&t(r.join(Li))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=oo()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new lo(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){uo("xhr poll");const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}},_o=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Mo=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Eo(e){const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let i=_o.exec(e||""),o={},s=14;for(;s--;)o[Mo[s]]=i[s]||"";return-1!=n&&-1!=r&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(e,t){const n=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1),"/"==t.slice(-1)&&n.splice(n.length-1,1),n}(0,o.path),o.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,o.query),o}const So=Yi("engine.io-client:socket");let ko=class e extends Di{constructor(e,t={}){super(),this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=Eo(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=Eo(t.host).host),Vi(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},n=e.split("&");for(let e=0,r=n.length;e<r;e++){let r=n[e].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){So('creating transport "%s"',e);const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return So("options: %j",n),new wo[e](n)}open(){let t;if(this.opts.rememberUpgrade&&e.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(e){return So("error while creating transport: %s",e),this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(e){So("setting transport %s",e.name),this.transport&&(So("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(t){So('probing transport "%s"',t);let n=this.createTransport(t),r=!1;e.priorWebsocketSuccess=!1;const i=()=>{r||(So('probe transport "%s" opened',t),n.send([{type:"ping",data:"probe"}]),n.once("packet",(i=>{if(!r)if("pong"===i.type&&"probe"===i.data){if(So('probe transport "%s" pong',t),this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;e.priorWebsocketSuccess="websocket"===n.name,So('pausing current transport "%s"',this.transport.name),this.transport.pause((()=>{r||"closed"!==this.readyState&&(So("changing transport and sending upgrade packet"),u(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())}))}else{So('probe transport "%s" failed',t);const e=new Error("probe error");e.transport=n.name,this.emitReserved("upgradeError",e)}})))};function o(){r||(r=!0,u(),n.close(),n=null)}const s=e=>{const r=new Error("probe error: "+e);r.transport=n.name,o(),So('probe transport "%s" failed because of error: %s',t,e),this.emitReserved("upgradeError",r)};function a(){s("transport closed")}function c(){s("socket closed")}function d(e){n&&e.name!==n.name&&(So('"%s" works - aborting "%s"',e.name,n.name),o())}const u=()=>{n.removeListener("open",i),n.removeListener("error",s),n.removeListener("close",a),this.off("close",c),this.off("upgrading",d)};n.once("open",i),n.once("error",s),n.once("close",a),this.once("close",c),this.once("upgrading",d),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==t?this.setTimeoutFn((()=>{r||n.open()}),200):n.open()}onOpen(){if(So("socket open"),this.readyState="open",e.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){So("starting upgrade probes");let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(So('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}else So('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();So("flushing %d packets in socket",e.length),this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let n=0;n<this.writeBuffer.length;n++){const r=this.writeBuffer[n].data;if(r&&(e+="string"==typeof(t=r)?function(e){let t=0,n=0;for(let r=0,i=e.length;r<i;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(t):Math.ceil(1.33*(t.byteLength||t.size))),n>0&&e>this.maxPayload)return So("only send %d out of %d packets",n,this.writeBuffer.length),this.writeBuffer.slice(0,n);e+=2}var t;return So("payload size is %d (max: %d)",e,this.maxPayload),this.writeBuffer}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this.onClose("forced close"),So("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():e()})):this.upgrading?n():e()),this}onError(t){So("socket error %j",t),e.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(So('socket close with reason: "%s"',e),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let n=0;const r=e.length;for(;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}};ko.protocol=4;const Co=Yi("socket.io-client:url"),Io="function"==typeof ArrayBuffer,xo=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Oo=Object.prototype.toString,Ro="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Oo.call(Blob),Po="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Oo.call(File);function To(e){return Io&&(e instanceof ArrayBuffer||xo(e))||Ro&&e instanceof Blob||Po&&e instanceof File}function No(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(No(e[t]))return!0;return!1}if(To(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return No(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&No(e[t]))return!0;return!1}function Lo(e){const t=[],n=e.data,r=e;return r.data=Bo(n,t),r.attachments=t.length,{packet:r,buffers:t}}function Bo(e,t){if(!e)return e;if(To(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=Bo(e[r],t);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=Bo(e[r],t));return n}return e}function Do(e,t){return e.data=jo(e.data,t),delete e.attachments,e}function jo(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=jo(e[n],t);else if("object"==typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=jo(e[n],t));return e}const Fo=Yi("socket.io-parser"),Ko=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var qo;function zo(e){return"[object Object]"===Object.prototype.toString.call(e)}!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(qo||(qo={}));class Vo extends Di{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===qo.BINARY_EVENT;n||t.type===qo.BINARY_ACK?(t.type=n?qo.EVENT:qo.ACK,this.reconstructor=new Wo(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!To(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===qo[n.type])throw new Error("unknown packet type "+n.type);if(n.type===qo.BINARY_EVENT||n.type===qo.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(r,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!Vo.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return Fo("decoded %s as %j",e,n),n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case qo.CONNECT:return zo(t);case qo.DISCONNECT:return void 0===t;case qo.CONNECT_ERROR:return"string"==typeof t||zo(t);case qo.EVENT:case qo.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===Ko.indexOf(t[0]));case qo.ACK:case qo.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Wo{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Do(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}var Uo=Object.freeze({__proto__:null,Decoder:Vo,Encoder:class{constructor(e){this.replacer=e}encode(e){return Fo("encoding packet %j",e),e.type!==qo.EVENT&&e.type!==qo.ACK||!No(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===qo.EVENT?qo.BINARY_EVENT:qo.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==qo.BINARY_EVENT&&e.type!==qo.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),Fo("encoded %j as %s",e,t),t}encodeAsBinary(e){const t=Lo(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}},get PacketType(){return qo},protocol:5});function Qo(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Ho=Yi("socket.io-client:socket"),Yo=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class $o extends Di{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Qo(e,"open",this.onopen.bind(this)),Qo(e,"packet",this.onpacket.bind(this)),Qo(e,"error",this.onerror.bind(this)),Qo(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(Yo.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const n={type:qo.EVENT,data:t,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++;Ho("emitting packet with ack id %d",e);const r=t.pop();this._registerAckCallback(e,r),n.id=e}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return!this.flags.volatile||r&&this.connected?this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n):Ho("discard packet as the transport is not currently writable"),this.flags={},this}_registerAckCallback(e,t){var n;const r=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const i=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&(Ho("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(t,1));Ho("event with ack id %d has timed out after %d ms",e,r),t.call(this,new Error("operation has timed out"))}),r);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,[null,...e])}}emitWithAck(e,...t){const n=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise(((r,i)=>{t.push(((e,t)=>n?e?i(e):r(t):r(e))),this.emit(e,...t)}))}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...r)=>{if(n===this._queue[0])return null!==e?n.tryCount>this._opts.retries&&(Ho("packet [%d] is discarded after %d tries",n.id,n.tryCount),this._queue.shift(),t&&t(e)):(Ho("packet [%d] was successfully sent",n.id),this._queue.shift(),t&&t(null,...r)),n.pending=!1,this._drainQueue()})),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(Ho("draining queue"),!this.connected||0===this._queue.length)return;const t=this._queue[0];!t.pending||e?(t.pending=!0,t.tryCount++,Ho("sending packet [%d] (try n°%d)",t.id,t.tryCount),this.flags=t.flags,this.emit.apply(this,t.args)):Ho("packet [%d] has already been sent and is waiting for an ack",t.id)}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){Ho("transport is open - connecting"),"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:qo.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){Ho("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case qo.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case qo.EVENT:case qo.BINARY_EVENT:this.onevent(e);break;case qo.ACK:case qo.BINARY_ACK:this.onack(e);break;case qo.DISCONNECT:this.ondisconnect();break;case qo.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];Ho("emitting event %j",t),null!=e.id&&(Ho("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,Ho("sending ack %j",r),t.packet({type:qo.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"==typeof t?(Ho("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):Ho("bad ack %s",e.id)}onconnect(e,t){Ho("socket connected with id %s",e),this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){Ho("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(Ho("performing disconnect (%s)",this.nsp),this.packet({type:qo.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function Go(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Go.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},Go.prototype.reset=function(){this.attempts=0},Go.prototype.setMin=function(e){this.ms=e},Go.prototype.setMax=function(e){this.max=e},Go.prototype.setJitter=function(e){this.jitter=e};const Zo=Yi("socket.io-client:manager");class Jo extends Di{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,Vi(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new Go({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||Uo;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(Zo("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;Zo("opening %s",this.uri),this.engine=new ko(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=Qo(t,"open",(function(){n.onopen(),e&&e()})),i=t=>{Zo("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},o=Qo(t,"error",i);if(!1!==this._timeout){const e=this._timeout;Zo("connect attempt will timeout after %d",e);const n=this.setTimeoutFn((()=>{Zo("connect attempt timed out after %d",e),r(),i(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){Zo("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Qo(e,"ping",this.onping.bind(this)),Qo(e,"data",this.ondata.bind(this)),Qo(e,"error",this.onerror.bind(this)),Qo(e,"close",this.onclose.bind(this)),Qo(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){po((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){Zo("error",e),this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new $o(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const e of t)if(this.nsps[e].active)return void Zo("socket %s is still active, skipping close",e);this._close()}_packet(e){Zo("writing packet %j",e);const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){Zo("cleanup"),this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){Zo("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){Zo("closed due to %s",e),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)Zo("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();Zo("will wait %dms before reconnect attempt",t),this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(Zo("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(Zo("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):(Zo("reconnect success"),e.onreconnect())})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Xo=Yi("socket.io-client"),es={};function ts(e,t){"object"==typeof e&&(t=e,e=void 0);const n=function(e,t="",n){let r=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(Co("protocol-less url %s",e),e=void 0!==n?n.protocol+"//"+e:"https://"+e),Co("parse %s",e),r=Eo(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,i=n.id,o=n.path,s=es[i]&&o in es[i].nsps;let a;return t.forceNew||t["force new connection"]||!1===t.multiplex||s?(Xo("ignoring socket cache for %s",r),a=new Jo(r,t)):(es[i]||(Xo("new io instance for %s",r),es[i]=new Jo(r,t)),a=es[i]),n.query&&!t.query&&(t.query=n.queryKey),a.socket(n.path,t)}var ns,rs;Object.assign(ts,{Manager:Jo,Socket:$o,io:ts,connect:ts}),(ns||(ns={})).KEY_EXCHANGE="key_exchange",function(e){e.KEY_HANDSHAKE_START="key_handshake_start",e.KEY_HANDSHAKE_CHECK="key_handshake_check",e.KEY_HANDSHAKE_SYN="key_handshake_SYN",e.KEY_HANDSHAKE_SYNACK="key_handshake_SYNACK",e.KEY_HANDSHAKE_ACK="key_handshake_ACK",e.KEY_HANDSHAKE_NONE="none"}(rs||(rs={}));class is extends ri.EventEmitter2{constructor({communicationLayer:e,otherPublicKey:t,context:n,ecies:r,logging:i}){super(),this.keysExchanged=!1,this.step=rs.KEY_HANDSHAKE_NONE,this.debug=!1,this.context=n,this.myECIES=new Jr(r),this.communicationLayer=e,this.myPublicKey=this.myECIES.getPublicKey(),this.debug=!0===(null==i?void 0:i.keyExchangeLayer),t&&this.setOtherPublicKey(t),this.communicationLayer.on(ns.KEY_EXCHANGE,this.onKeyExchangeMessage.bind(this))}onKeyExchangeMessage(e){this.debug&&console.debug(`KeyExchange::${this.context}::onKeyExchangeMessage() keysExchanged=${this.keysExchanged}`,e);const{message:t}=e;this.keysExchanged&&this.debug&&console.log(`KeyExchange::${this.context}::onKeyExchangeMessage received handshake while already exchanged. step=${this.step} otherPubKey=${this.otherPublicKey}`),t.type===rs.KEY_HANDSHAKE_SYN?(this.checkStep([rs.KEY_HANDSHAKE_NONE,rs.KEY_HANDSHAKE_ACK]),this.debug&&console.debug("KeyExchange::KEY_HANDSHAKE_SYN",t),t.pubkey&&this.setOtherPublicKey(t.pubkey),this.communicationLayer.sendMessage({type:rs.KEY_HANDSHAKE_SYNACK,pubkey:this.myPublicKey}),this.step=rs.KEY_HANDSHAKE_ACK,this.emit(ti.KEY_INFO,this.step)):t.type===rs.KEY_HANDSHAKE_SYNACK?(this.checkStep([rs.KEY_HANDSHAKE_SYNACK,rs.KEY_HANDSHAKE_NONE]),this.debug&&console.debug("KeyExchange::KEY_HANDSHAKE_SYNACK"),t.pubkey&&this.setOtherPublicKey(t.pubkey),this.communicationLayer.sendMessage({type:rs.KEY_HANDSHAKE_ACK}),this.keysExchanged=!0,this.step=rs.KEY_HANDSHAKE_NONE,this.emit(ti.KEYS_EXCHANGED)):t.type===rs.KEY_HANDSHAKE_ACK&&(this.debug&&console.debug("KeyExchange::KEY_HANDSHAKE_ACK set keysExchanged to true!"),this.checkStep([rs.KEY_HANDSHAKE_ACK,rs.KEY_HANDSHAKE_NONE]),this.keysExchanged=!0,this.step=rs.KEY_HANDSHAKE_NONE,this.emit(ti.KEYS_EXCHANGED))}resetKeys(e){this.clean(),this.myECIES=new Jr(e)}clean(){this.debug&&console.debug(`KeyExchange::${this.context}::clean reset handshake state`),this.step=rs.KEY_HANDSHAKE_NONE,this.emit(ti.KEY_INFO,this.step),this.keysExchanged=!1}start({isOriginator:e,force:t}){this.debug&&console.debug(`KeyExchange::${this.context}::start isOriginator=${e} step=${this.step} force=${t} keysExchanged=${this.keysExchanged}`),e?!this.keysExchanged&&this.step===rs.KEY_HANDSHAKE_NONE||t?(this.debug&&console.debug(`KeyExchange::${this.context}::start -- start key exchange (force=${t}) -- step=${this.step}`,this.step),this.clean(),this.step=rs.KEY_HANDSHAKE_SYNACK,this.emit(ti.KEY_INFO,this.step),this.communicationLayer.sendMessage({type:rs.KEY_HANDSHAKE_SYN,pubkey:this.myPublicKey})):this.debug&&console.debug(`KeyExchange::${this.context}::start -- key exchange already ${this.keysExchanged?"done":"in progress"} -- aborted.`,this.step):this.keysExchanged&&!0!==t?this.debug&&console.debug("KeyExchange::start don't send KEY_HANDSHAKE_START -- exchange already done."):(this.communicationLayer.sendMessage({type:rs.KEY_HANDSHAKE_START}),this.clean())}checkStep(e){if(e.length>0&&-1===e.indexOf(this.step.toString()))throw new Error(`Wrong Step "${this.step}" not within ${e}`)}areKeysExchanged(){return this.keysExchanged}getMyPublicKey(){return this.myPublicKey}setOtherPublicKey(e){this.debug&&console.debug("KeyExchange::setOtherPubKey()",e),this.otherPublicKey=e}encryptMessage(e){if(!this.otherPublicKey)throw new Error("encryptMessage: Keys not exchanged - missing otherPubKey");return this.myECIES.encrypt(e,this.otherPublicKey)}decryptMessage(e){if(!this.otherPublicKey)throw new Error("decryptMessage: Keys not exchanged - missing otherPubKey");return this.myECIES.decrypt(e)}getKeyInfo(){return{ecies:Object.assign(Object.assign({},this.myECIES.getKeyInfo()),{otherPubKey:this.otherPublicKey}),step:this.step,keysExchanged:this.areKeysExchanged()}}toString(){const e={keyInfo:this.getKeyInfo(),keysExchanged:this.keysExchanged,step:this.step};return JSON.stringify(e)}}const os=e=>new Promise((t=>{setTimeout(t,e)})),ss=e=>Xr(void 0,void 0,void 0,(function*(){var t,n,r,i;e.state.debug&&console.debug(`SocketService::connectAgain instance.state.socket?.connected=${null===(t=e.state.socket)||void 0===t?void 0:t.connected} trying to reconnect after socketio disconnection`,e),yield os(200),(null===(n=e.state.socket)||void 0===n?void 0:n.connected)||(e.state.resumed=!0,null===(r=e.state.socket)||void 0===r||r.connect(),e.emit(ti.SOCKET_RECONNECT),null===(i=e.state.socket)||void 0===i||i.emit(ti.JOIN_CHANNEL,e.state.channelId,`${e.state.context}connect_again`))}));function as(e){"undefined"!=typeof window&&"undefined"!=typeof document&&(e.state.debug&&console.debug(`SocketService::checkFocus hasFocus=${document.hasFocus()}`,e),document.hasFocus()?ss(e).catch((e=>{console.error("SocketService::checkFocus Error reconnecting socket",e)})):window.addEventListener("focus",(()=>{ss(e).catch((e=>{console.error("SocketService::checkFocus Error reconnecting socket",e)}))}),{once:!0}))}const cs=[{event:"error",handler:function(e){return t=>{e.state.debug&&console.debug("SocketService::on 'error' ",t),as(e)}}},{event:"ping",handler:function(e){return()=>{e.state.debug&&console.debug("SocketService::on 'ping'")}}},{event:"reconnect",handler:function(e){return t=>{e.state.debug&&console.debug(`SocketService::on 'reconnect' attempt=${t}`)}}},{event:"reconnect_error",handler:function(e){return t=>{e.state.debug&&console.debug("SocketService::on 'reconnect_error'",t)}}},{event:"reconnect_failed",handler:function(e){return()=>{e.state.debug&&console.debug("SocketService::on 'reconnect_failed'")}}},{event:"disconnect",handler:function(e){return t=>{e.state.debug&&console.debug(`SocketService::on 'disconnect' manualDisconnect=${e.state.manualDisconnect}`,t),e.state.manualDisconnect||(e.emit(ti.SOCKET_DISCONNECTED),as(e))}}}],ds=[{event:"clients_connected",handler:function(e,t){return n=>Xr(this,void 0,void 0,(function*(){var n,r,i,o,s,a,c,d;e.state.debug&&console.debug(`SocketService::${e.state.context}::setupChannelListener::on 'clients_connected-${t}'  resumed=${e.state.resumed}  clientsPaused=${e.state.clientsPaused} keysExchanged=${null===(n=e.state.keyExchange)||void 0===n?void 0:n.areKeysExchanged()} isOriginator=${e.state.isOriginator}`),e.emit(ti.CLIENTS_CONNECTED,{isOriginator:e.state.isOriginator,keysExchanged:null===(r=e.state.keyExchange)||void 0===r?void 0:r.areKeysExchanged(),context:e.state.context}),e.state.resumed?(e.state.isOriginator||(e.state.debug&&console.debug(`SocketService::${e.state.context}::on 'clients_connected' / keysExchanged=${null===(i=e.state.keyExchange)||void 0===i?void 0:i.areKeysExchanged()} -- backward compatibility`),null===(o=e.state.keyExchange)||void 0===o||o.start({isOriginator:null!==(s=e.state.isOriginator)&&void 0!==s&&s})),e.state.resumed=!1):e.state.clientsPaused?console.debug("SocketService::on 'clients_connected' skip sending originatorInfo on pause"):e.state.isOriginator||(e.state.debug&&console.debug(`SocketService::${e.state.context}::on 'clients_connected' / keysExchanged=${null===(a=e.state.keyExchange)||void 0===a?void 0:a.areKeysExchanged()} -- backward compatibility`),null===(c=e.state.keyExchange)||void 0===c||c.start({isOriginator:null!==(d=e.state.isOriginator)&&void 0!==d&&d,force:!0})),e.state.clientsConnected=!0,e.state.clientsPaused=!1}))}},{event:"channel_created",handler:function(e,t){return n=>{e.state.debug&&console.debug(`SocketService::${e.state.context}::setupChannelListener::on 'channel_created-${t}'`,n),e.emit(ti.CHANNEL_CREATED,n)}}},{event:"clients_disconnected",handler:function(e,t){return()=>{var n;e.state.clientsConnected=!1,e.state.debug&&console.debug(`SocketService::${e.state.context}::setupChannelListener::on 'clients_disconnected-${t}'`),e.state.isOriginator&&!e.state.clientsPaused&&(null===(n=e.state.keyExchange)||void 0===n||n.clean()),e.emit(ti.CLIENTS_DISCONNECTED,t)}}},{event:"message",handler:function(e,t){return({id:n,message:r,error:i})=>{var o,s,a,c,d,u,h,f,l;if(e.state.debug&&console.debug(`SocketService::${e.state.context}::on 'message' ${t} keysExchanged=${null===(o=e.state.keyExchange)||void 0===o?void 0:o.areKeysExchanged()}`,r),i)throw e.state.debug&&console.debug(`\n      SocketService::${e.state.context}::on 'message' error=${i}`),new Error(i);try{!function(e,t){if(t!==e.channelId)throw e.debug&&console.error(`Wrong id ${t} - should be ${e.channelId}`),new Error("Wrong id")}(e.state,n)}catch(e){return void console.error("ignore message --- wrong id ",r)}if(e.state.isOriginator&&(null==r?void 0:r.type)===rs.KEY_HANDSHAKE_START)return e.state.debug&&console.debug(`SocketService::${e.state.context}::on 'message' received HANDSHAKE_START isOriginator=${e.state.isOriginator}`,r),void(null===(s=e.state.keyExchange)||void 0===s||s.start({isOriginator:null!==(a=e.state.isOriginator)&&void 0!==a&&a,force:!0}));if((null==r?void 0:r.type)===ni.PING)return e.state.debug&&console.debug(`SocketService::${e.state.context}::on 'message' ping `),void e.emit(ti.MESSAGE,{message:{type:"ping"}});if(e.state.debug&&console.debug(`SocketService::${e.state.context}::on 'message' originator=${e.state.isOriginator}, type=${null==r?void 0:r.type}, keysExchanged=${null===(c=e.state.keyExchange)||void 0===c?void 0:c.areKeysExchanged()}`),null===(d=null==r?void 0:r.type)||void 0===d?void 0:d.startsWith("key_handshake"))return e.state.debug&&console.debug(`SocketService::${e.state.context}::on 'message' emit KEY_EXCHANGE`,r),void e.emit(ns.KEY_EXCHANGE,{message:r,context:e.state.context});if(!(null===(u=e.state.keyExchange)||void 0===u?void 0:u.areKeysExchanged()))return e.state.isOriginator?null===(h=e.state.keyExchange)||void 0===h||h.start({isOriginator:null!==(f=e.state.isOriginator)&&void 0!==f&&f}):e.sendMessage({type:rs.KEY_HANDSHAKE_START}),void console.warn("Message ignored because invalid key exchange status",r);if(-1!==r.toString().indexOf("type"))return console.warn("SocketService::on 'message' received non encrypted unkwown message"),void e.emit(ti.MESSAGE,r);const A=null===(l=e.state.keyExchange)||void 0===l?void 0:l.decryptMessage(r),p=JSON.parse(A);if((null==p?void 0:p.type)===ni.PAUSE?e.state.clientsPaused=!0:e.state.clientsPaused=!1,e.state.isOriginator&&p.data){const t=p.data,n=e.state.rpcMethodTracker[t.id];if(n){const r=Date.now()-n.timestamp;e.state.debug&&console.debug(`SocketService::${e.state.context}::on 'message' received answer for id=${t.id} method=${n.method} responseTime=${r}`,p);const i=Object.assign(Object.assign({},n),{result:t.result,elapsedTime:r});e.state.rpcMethodTracker[t.id]=i,e.state.debug&&console.debug("HACK (wallet <7.3) update rpcMethodTracker",i),e.emit(ti.AUTHORIZED)}}e.emit(ti.MESSAGE,{message:p})}}},{event:"clients_waiting_to_join",handler:function(e,t){return n=>{e.state.debug&&console.debug(`SocketService::${e.state.context}::setupChannelListener::on 'clients_waiting_to_join-${t}'`,n),e.emit(ti.CLIENTS_WAITING,n)}}}],us=[{event:ti.KEY_INFO,handler:function(e){return t=>{e.state.debug&&console.debug("SocketService::on 'KEY_INFO'",t),e.emit(ti.KEY_INFO,t)}}},{event:ti.KEYS_EXCHANGED,handler:function(e){return()=>{var t,n;e.state.debug&&console.debug(`SocketService::on 'keys_exchanged' keyschanged=${null===(t=e.state.keyExchange)||void 0===t?void 0:t.areKeysExchanged()}`),e.emit(ti.KEYS_EXCHANGED,{keysExchanged:null===(n=e.state.keyExchange)||void 0===n?void 0:n.areKeysExchanged(),isOriginator:e.state.isOriginator});const r={keyInfo:e.getKeyInfo()};e.emit(ti.SERVICE_STATUS,r)}}}];function hs(e,t){e.state.debug&&console.debug(`SocketService::${e.state.context}::setupChannelListener setting socket listeners for channel ${t}...`);const{socket:n}=e.state,{keyExchange:r}=e.state;cs.forEach((({event:r,handler:i})=>{const o=`${r}-${t}`;null==n||n.on(o,i(e))})),ds.forEach((({event:r,handler:i})=>{const o=`${r}-${t}`;null==n||n.on(o,i(e,t))})),us.forEach((({event:t,handler:n})=>{null==r||r.on(t,n(e))}))}function fs(e,t){var n,r;if(!e.state.channelId)throw new Error("Create a channel first");e.state.debug&&console.debug(`SocketService::${e.state.context}::sendMessage() areKeysExchanged=${null===(n=e.state.keyExchange)||void 0===n?void 0:n.areKeysExchanged()}`,t),(null===(r=null==t?void 0:t.type)||void 0===r?void 0:r.startsWith("key_handshake"))?function(e,t){var n;e.state.debug&&console.debug(`SocketService::${e.state.context}::sendMessage()`,t),null===(n=e.state.socket)||void 0===n||n.emit(ti.MESSAGE,{id:e.state.channelId,context:e.state.context,message:t})}(e,t):(function(e,t){var n;if(!(null===(n=e.state.keyExchange)||void 0===n?void 0:n.areKeysExchanged()))throw e.state.debug&&console.debug(`SocketService::${e.state.context}::sendMessage() ERROR keys not exchanged`,t),new Error("Keys not exchanged BBB")}(e,t),function(e,t){var n;const r=null!==(n=null==t?void 0:t.method)&&void 0!==n?n:"",i=null==t?void 0:t.id;e.state.isOriginator&&i&&(e.state.rpcMethodTracker[i]={timestamp:Date.now(),method:r})}(e,t),function(e,t){var n,r;const i=null===(n=e.state.keyExchange)||void 0===n?void 0:n.encryptMessage(JSON.stringify(t)),o={id:e.state.channelId,context:e.state.context,message:i,plaintext:e.state.hasPlaintext?JSON.stringify(t):void 0};e.state.debug&&console.debug(`SocketService::${e.state.context}::sendMessage()`,o),t.type===ni.TERMINATE&&(e.state.manualDisconnect=!0),null===(r=e.state.socket)||void 0===r||r.emit(ti.MESSAGE,o)}(e,t),function(e,t){var n;return Xr(this,void 0,void 0,(function*(){const r=null==t?void 0:t.id,i=null!==(n=null==t?void 0:t.method)&&void 0!==n?n:"";if(e.state.isOriginator&&r)try{const n=yield((e,t,n=200)=>Xr(void 0,void 0,void 0,(function*(){let r;const i=Date.now();let o=!1;for(;!o;){if(o=Date.now()-i>3e5,r=t[e],void 0!==r.elapsedTime)return r;yield os(n)}throw new Error(`RPC ${e} timed out`)})))(r,e.state.rpcMethodTracker,200);e.state.debug&&console.debug(`SocketService::waitForRpc id=${t.id} ${i} ( ${n.elapsedTime} ms)`,n.result)}catch(e){console.warn(`Error rpcId=${t.id} ${i}`,e)}}))}(e,t).catch((e=>{console.warn("Error handleRpcReplies",e)})))}class ls extends ri.EventEmitter2{constructor({otherPublicKey:e,reconnect:t,communicationLayerPreference:n,transports:r,communicationServerUrl:i,context:o,ecies:s,logging:a}){super(),this.state={clientsConnected:!1,clientsPaused:!1,manualDisconnect:!1,rpcMethodTracker:{},hasPlaintext:!1,communicationServerUrl:""},this.state.resumed=t,this.state.context=o,this.state.communicationLayerPreference=n,this.state.debug=!0===(null==a?void 0:a.serviceLayer),this.state.communicationServerUrl=i,this.state.hasPlaintext=this.state.communicationServerUrl!==si&&!0===(null==a?void 0:a.plaintext);const c={autoConnect:!1,transports:ai};r&&(c.transports=r),this.state.debug&&console.debug(`SocketService::constructor() Socket IO url: ${this.state.communicationServerUrl}`),this.state.socket=ts(i,c);const d={communicationLayer:this,otherPublicKey:e,sendPublicKey:!1,context:this.state.context,ecies:s,logging:a};this.state.keyExchange=new is(d)}resetKeys(){return this.state.debug&&console.debug("SocketService::resetKeys()"),void(null===(e=this.state.keyExchange)||void 0===e||e.resetKeys());var e}createChannel(){return function(e){var t,n,r,i;e.state.debug&&console.debug(`SocketService::${e.state.context}::createChannel()`),(null===(t=e.state.socket)||void 0===t?void 0:t.connected)||null===(n=e.state.socket)||void 0===n||n.connect(),e.state.manualDisconnect=!1,e.state.isOriginator=!0;const o=gi();return e.state.channelId=o,hs(e,o),null===(r=e.state.socket)||void 0===r||r.emit(ti.JOIN_CHANNEL,o,`${e.state.context}createChannel`),{channelId:o,pubKey:(null===(i=e.state.keyExchange)||void 0===i?void 0:i.getMyPublicKey())||""}}(this)}connectToChannel({channelId:e,isOriginator:t=!1,withKeyExchange:n=!1}){return function({options:e,instance:t}){var n,r,i,o;const{channelId:s,withKeyExchange:a,isOriginator:c}=e;if(t.state.debug&&console.debug(`SocketService::${t.state.context}::connectToChannel() channelId=${s} isOriginator=${c}`,null===(n=t.state.keyExchange)||void 0===n?void 0:n.toString()),null===(r=t.state.socket)||void 0===r?void 0:r.connected)throw new Error("socket already connected");t.state.manualDisconnect=!1,null===(i=t.state.socket)||void 0===i||i.connect(),t.state.withKeyExchange=a,t.state.isOriginator=c,t.state.channelId=s,hs(t,s),null===(o=t.state.socket)||void 0===o||o.emit(ti.JOIN_CHANNEL,s,`${t.state.context}_connectToChannel`)}({options:{channelId:e,isOriginator:t,withKeyExchange:n},instance:this})}getKeyInfo(){return this.state.keyExchange.getKeyInfo()}keyCheck(){var e,t;null===(t=(e=this).state.socket)||void 0===t||t.emit(ti.MESSAGE,{id:e.state.channelId,context:e.state.context,message:{type:rs.KEY_HANDSHAKE_CHECK,pubkey:e.getKeyInfo().ecies.otherPubKey}})}sendMessage(e){return fs(this,e)}ping(){return(e=this).state.debug&&console.debug(`SocketService::${e.state.context}::ping() keysExchanged=${null===(t=e.state.keyExchange)||void 0===t?void 0:t.areKeysExchanged()}`),e.state.isOriginator||((null===(n=e.state.keyExchange)||void 0===n?void 0:n.areKeysExchanged())?e.sendMessage({type:ni.READY}):null===(r=e.state.keyExchange)||void 0===r||r.start({isOriginator:null!==(i=e.state.isOriginator)&&void 0!==i&&i})),void(null===(o=e.state.socket)||void 0===o||o.emit(ti.MESSAGE,{id:e.state.channelId,context:e.state.context,message:{type:ni.PING}}));var e,t,n,r,i,o}pause(){return(e=this).state.debug&&console.debug(`SocketService::${e.state.context}::pause()`),e.state.manualDisconnect=!0,(null===(t=e.state.keyExchange)||void 0===t?void 0:t.areKeysExchanged())&&e.sendMessage({type:ni.PAUSE}),void(null===(n=e.state.socket)||void 0===n||n.disconnect());var e,t,n}isConnected(){var e;return null===(e=this.state.socket)||void 0===e?void 0:e.connected}resume(){return(e=this).state.debug&&console.debug(`SocketService::${e.state.context}::resume() connected=${null===(t=e.state.socket)||void 0===t?void 0:t.connected} manualDisconnect=${e.state.manualDisconnect} resumed=${e.state.resumed} keysExchanged=${null===(n=e.state.keyExchange)||void 0===n?void 0:n.areKeysExchanged()}`),(null===(r=e.state.socket)||void 0===r?void 0:r.connected)?e.state.debug&&console.debug("SocketService::resume() already connected."):(null===(i=e.state.socket)||void 0===i||i.connect(),e.state.debug&&console.debug(`SocketService::resume() after connecting socket --\x3e connected=${null===(o=e.state.socket)||void 0===o?void 0:o.connected}`),null===(s=e.state.socket)||void 0===s||s.emit(ti.JOIN_CHANNEL,e.state.channelId,`${e.state.context}_resume`)),(null===(a=e.state.keyExchange)||void 0===a?void 0:a.areKeysExchanged())?e.state.isOriginator||e.sendMessage({type:ni.READY}):e.state.isOriginator||null===(c=e.state.keyExchange)||void 0===c||c.start({isOriginator:null!==(d=e.state.isOriginator)&&void 0!==d&&d}),e.state.manualDisconnect=!1,void(e.state.resumed=!0);var e,t,n,r,i,o,s,a,c,d}disconnect(e){return function(e,t){var n,r;e.state.debug&&console.debug(`SocketService::${e.state.context}::disconnect()`,t),(null==t?void 0:t.terminate)&&(e.state.channelId=t.channelId,null===(n=e.state.keyExchange)||void 0===n||n.clean()),e.state.rpcMethodTracker={},e.state.manualDisconnect=!0,null===(r=e.state.socket)||void 0===r||r.disconnect()}(this,e)}}var As,ps;function bs(e){return()=>Xr(this,void 0,void 0,(function*(){var t,n,r;const{state:i}=e;if(i.authorized)return;yield(()=>Xr(this,void 0,void 0,(function*(){for(;!i.walletInfo;)yield os(500)})))();const o="7.3".localeCompare((null===(t=i.walletInfo)||void 0===t?void 0:t.version)||"");if(i.debug&&console.debug(`RemoteCommunication HACK 'authorized' version=${null===(n=i.walletInfo)||void 0===n?void 0:n.version} compareValue=${o}`),1!==o)return;const s=i.platformType===ps.MobileWeb||i.platformType===ps.ReactNative||i.platformType===ps.MetaMaskMobileWebview;i.debug&&console.debug(`RemoteCommunication HACK 'authorized' platform=${i.platformType} secure=${s} channel=${i.channelId} walletVersion=${null===(r=i.walletInfo)||void 0===r?void 0:r.version}`),s&&(i.authorized=!0,e.emit(ti.AUTHORIZED))}))}function ms(e){return t=>{const{state:n}=e;n.debug&&console.debug(`RemoteCommunication::${n.context}::on 'channel_created' channelId=${t}`),e.emit(ti.CHANNEL_CREATED,t)}}(As||(As={})).SOCKET="socket",function(e){e.NonBrowser="nodejs",e.MetaMaskMobileWebview="in-app-browser",e.DesktopWeb="web-desktop",e.MobileWeb="web-mobile",e.ReactNative="react-native"}(ps||(ps={}));var gs={exports:{}};gs.exports=u.fetch,gs.exports.default=u.fetch,gs.exports.fetch=u.fetch,gs.exports.Headers=u.Headers,gs.exports.Request=u.Request,gs.exports.Response=u.Response;var vs=h(gs.exports);const ys=(e,t)=>Xr(void 0,void 0,void 0,(function*(){const n=t.endsWith("/")?`${t}debug`:`${t}/debug`,r=JSON.stringify(e),i=yield vs(n,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:r});return yield i.text()}));var ws,_s;function Ms(e,t){return()=>{var n,r,i,o;const{state:s}=e;if(s.debug&&console.debug(`RemoteCommunication::on 'clients_connected' channel=${s.channelId} keysExchanged=${null===(r=null===(n=s.communicationLayer)||void 0===n?void 0:n.getKeyInfo())||void 0===r?void 0:r.keysExchanged}`),s.analytics){const e=s.isOriginator?ws.REQUEST:ws.REQUEST_MOBILE;ys(Object.assign(Object.assign({id:null!==(i=s.channelId)&&void 0!==i?i:"",event:s.reconnection?ws.RECONNECT:e},s.originatorInfo),{commLayer:t,sdkVersion:s.sdkVersion,walletVersion:null===(o=s.walletInfo)||void 0===o?void 0:o.version,commLayerVersion:ii}),s.communicationServerUrl).catch((e=>{console.error("Cannot send analytics",e)}))}s.clientsConnected=!0,s.originatorInfoSent=!1,e.emit(ti.CLIENTS_CONNECTED)}}function Es(e,t){return n=>{var r;const{state:i}=e;i.debug&&console.debug(`RemoteCommunication::${i.context}]::on 'clients_disconnected' channelId=${n}`),i.clientsConnected=!1,e.emit(ti.CLIENTS_DISCONNECTED,i.channelId),e.setConnectionStatus(ui.DISCONNECTED),i.ready=!1,i.authorized=!1,i.analytics&&i.channelId&&ys({id:i.channelId,event:ws.DISCONNECTED,sdkVersion:i.sdkVersion,commLayer:t,commLayerVersion:ii,walletVersion:null===(r=i.walletInfo)||void 0===r?void 0:r.version},i.communicationServerUrl).catch((e=>{console.error("Cannot send analytics",e)}))}}function Ss(e){return t=>{var n;const{state:r}=e;if(r.debug&&console.debug(`RemoteCommunication::${r.context}::on 'clients_waiting' numberUsers=${t} ready=${r.ready} autoStarted=${r.originatorConnectStarted}`),e.setConnectionStatus(ui.WAITING),e.emit(ti.CLIENTS_WAITING,t),r.originatorConnectStarted){r.debug&&console.debug(`RemoteCommunication::on 'clients_waiting' watch autoStarted=${r.originatorConnectStarted} timeout`,r.autoConnectOptions);const t=(null===(n=r.autoConnectOptions)||void 0===n?void 0:n.timeout)||3e3,i=setTimeout((()=>{r.debug&&console.debug(`RemoteCommunication::on setTimeout(${t}) terminate channelConfig`,r.autoConnectOptions),r.originatorConnectStarted=!1,r.ready||e.setConnectionStatus(ui.TIMEOUT),clearTimeout(i)}),t)}}}function ks(e,t){return n=>{var r,i,o,s,a;const{state:c}=e;c.debug&&console.debug(`RemoteCommunication::${c.context}::on commLayer.'keys_exchanged' channel=${c.channelId}`,n),(null===(i=null===(r=c.communicationLayer)||void 0===r?void 0:r.getKeyInfo())||void 0===i?void 0:i.keysExchanged)&&e.setConnectionStatus(ui.LINKED),function(e,t){var n,r,i,o;const{state:s}=e;s.debug&&console.debug(`RemoteCommunication::setLastActiveDate() channel=${s.channelId}`,t);const a={channelId:null!==(n=s.channelId)&&void 0!==n?n:"",validUntil:null!==(i=null===(r=s.channelConfig)||void 0===r?void 0:r.validUntil)&&void 0!==i?i:0,lastActive:t.getTime()};null===(o=s.storageManager)||void 0===o||o.persistChannelConfig(a)}(e,new Date),c.analytics&&c.channelId&&(console.warn(`TrackingEvents.CONNECTED message.isOriginator=${n.isOriginator} originator=${c.isOriginator}`),ys({id:c.channelId,event:n.isOriginator?ws.CONNECTED:ws.CONNECTED_MOBILE,sdkVersion:c.sdkVersion,commLayer:t,commLayerVersion:ii,walletVersion:null===(o=c.walletInfo)||void 0===o?void 0:o.version},c.communicationServerUrl).catch((e=>{console.error("Cannot send analytics",e)}))),c.isOriginator=n.isOriginator,n.isOriginator||(null===(s=c.communicationLayer)||void 0===s||s.sendMessage({type:ni.READY}),c.ready=!0,c.paused=!1),n.isOriginator&&!c.originatorInfoSent&&(null===(a=c.communicationLayer)||void 0===a||a.sendMessage({type:ni.ORIGINATOR_INFO,originatorInfo:c.originatorInfo,originator:c.originatorInfo}),c.originatorInfoSent=!0)}}function Cs(e){return t=>{let n=t;t.message&&(n=n.message),function(e,t){const{state:n}=t;if(n.debug&&console.debug(`RemoteCommunication::${n.context}::on 'message' typeof=${typeof e}`,e),t.state.ready=!0,n.isOriginator||e.type!==ni.ORIGINATOR_INFO)if(n.isOriginator&&e.type===ni.WALLET_INFO)!function(e,t){const{state:n}=e;n.walletInfo=t.walletInfo,n.paused=!1}(t,e);else{if(e.type===ni.TERMINATE)!function(e){const{state:t}=e;t.isOriginator&&(Os({options:{terminate:!0,sendMessage:!1},instance:e}),console.debug(),e.emit(ti.TERMINATE))}(t);else if(e.type===ni.PAUSE)!function(e){const{state:t}=e;t.paused=!0,e.setConnectionStatus(ui.PAUSED)}(t);else if(e.type===ni.READY&&n.isOriginator)!function(e){const{state:t}=e;e.setConnectionStatus(ui.LINKED);const n=t.paused;t.paused=!1,e.emit(ti.CLIENTS_READY,{isOriginator:t.isOriginator,walletInfo:t.walletInfo}),n&&(t.authorized=!0,e.emit(ti.AUTHORIZED))}(t);else{if(e.type===ni.OTP&&n.isOriginator)return void function(e,t){var n;const{state:r}=e;e.emit(ti.OTP,t.otpAnswer),1==="6.6".localeCompare((null===(n=r.walletInfo)||void 0===n?void 0:n.version)||"")&&(console.warn("RemoteCommunication::on 'otp' -- backward compatibility <6.6 -- triger eth_requestAccounts"),e.emit(ti.SDK_RPC_CALL,{method:di,params:[]}))}(t,e);e.type===ni.AUTHORIZED&&n.isOriginator&&function(e){const{state:t}=e;t.authorized=!0,e.emit(ti.AUTHORIZED)}(t)}t.emit(ti.MESSAGE,e)}else!function(e,t){var n;const{state:r}=e;null===(n=r.communicationLayer)||void 0===n||n.sendMessage({type:ni.WALLET_INFO,walletInfo:r.walletInfo}),r.originatorInfo=t.originatorInfo||t.originator,e.emit(ti.CLIENTS_READY,{isOriginator:r.isOriginator,originatorInfo:r.originatorInfo}),r.paused=!1}(t,e)}(n,e)}}function Is(e){return()=>{const{state:t}=e;t.debug&&console.debug("RemoteCommunication::on 'socket_reconnect' -- reset key exchange status / set ready to false"),t.ready=!1,oi(t)}}function xs(e){return()=>{const{state:t}=e;t.debug&&console.debug("RemoteCommunication::on 'socket_Disconnected' set ready to false"),t.ready=!1}}function Os({options:e,instance:t}){var n,r,i,o,s,a;const{state:c}=t;c.debug&&console.debug(`RemoteCommunication::disconnect() channel=${c.channelId}`,e),c.ready=!1,c.paused=!1,(null==e?void 0:e.terminate)?(null===(n=c.storageManager)||void 0===n||n.terminate(null!==(r=c.channelId)&&void 0!==r?r:""),(null===(i=c.communicationLayer)||void 0===i?void 0:i.getKeyInfo().keysExchanged)&&(null==e?void 0:e.sendMessage)&&(null===(o=c.communicationLayer)||void 0===o||o.sendMessage({type:ni.TERMINATE})),c.channelId=gi(),e.channelId=c.channelId,c.channelConfig=void 0,c.originatorConnectStarted=!1,null===(s=c.communicationLayer)||void 0===s||s.disconnect(e),t.setConnectionStatus(ui.TERMINATED)):(null===(a=c.communicationLayer)||void 0===a||a.disconnect(e),t.setConnectionStatus(ui.DISCONNECTED))}!function(e){e.REQUEST="sdk_connect_request_started",e.REQUEST_MOBILE="sdk_connect_request_started_mobile",e.RECONNECT="sdk_reconnect_request_started",e.CONNECTED="sdk_connection_established",e.CONNECTED_MOBILE="sdk_connection_established_mobile",e.AUTHORIZED="sdk_connection_authorized",e.REJECTED="sdk_connection_rejected",e.TERMINATED="sdk_connection_terminated",e.DISCONNECTED="sdk_disconnected",e.SDK_USE_EXTENSION="sdk_use_extension",e.SDK_USE_INAPP_BROWSER="sdk_use_inapp_browser"}(ws||(ws={}));class Rs extends ri.EventEmitter2{constructor({platformType:e,communicationLayerPreference:t,otherPublicKey:n,reconnect:r,walletInfo:i,dappMetadata:o,transports:s,context:a,ecies:c,analytics:d=!1,storage:u,sdkVersion:h,communicationServerUrl:f=si,logging:l,autoConnect:A={timeout:3e3}}){super(),this.state={ready:!1,authorized:!1,isOriginator:!1,paused:!1,platformType:"metamask-mobile",analytics:!1,reconnection:!1,originatorInfoSent:!1,communicationServerUrl:si,context:"",clientsConnected:!1,sessionDuration:ci,originatorConnectStarted:!1,debug:!1,_connectionStatus:ui.DISCONNECTED},this.state.otherPublicKey=n,this.state.dappMetadata=o,this.state.walletInfo=i,this.state.transports=s,this.state.platformType=e,this.state.analytics=d,this.state.communicationServerUrl=f,this.state.context=a,this.state.sdkVersion=h,this.setMaxListeners(50),this.setConnectionStatus(ui.DISCONNECTED),(null==u?void 0:u.duration)&&(this.state.sessionDuration=ci),this.state.storageOptions=u,this.state.autoConnectOptions=A,this.state.debug=!0===(null==l?void 0:l.remoteLayer),this.state.logging=l,(null==u?void 0:u.storageManager)&&(this.state.storageManager=u.storageManager),this.initCommunicationLayer({communicationLayerPreference:t,otherPublicKey:n,reconnect:r,ecies:c,communicationServerUrl:f}),this.emitServiceStatusEvent()}initCommunicationLayer({communicationLayerPreference:e,otherPublicKey:t,reconnect:n,ecies:r,communicationServerUrl:i=si}){return function({communicationLayerPreference:e,otherPublicKey:t,reconnect:n,ecies:r,communicationServerUrl:i=si,instance:o}){var s,a,c,d;const{state:u}=o;if(e!==As.SOCKET)throw new Error("Invalid communication protocol");u.communicationLayer=new ls({communicationLayerPreference:e,otherPublicKey:t,reconnect:n,transports:u.transports,communicationServerUrl:i,context:u.context,ecies:r,logging:u.logging});let h="undefined"!=typeof document&&document.URL||"",f="undefined"!=typeof document&&document.title||"";(null===(s=u.dappMetadata)||void 0===s?void 0:s.url)&&(h=u.dappMetadata.url),(null===(a=u.dappMetadata)||void 0===a?void 0:a.name)&&(f=u.dappMetadata.name);const l={url:h,title:f,source:null===(c=u.dappMetadata)||void 0===c?void 0:c.source,icon:null===(d=u.dappMetadata)||void 0===d?void 0:d.base64Icon,platform:u.platformType,apiVersion:ii};u.originatorInfo=l;const A={[ti.AUTHORIZED]:bs(o),[ti.MESSAGE]:Cs(o),[ti.CLIENTS_CONNECTED]:Ms(o,e),[ti.KEYS_EXCHANGED]:ks(o,e),[ti.SOCKET_DISCONNECTED]:xs(o),[ti.SOCKET_RECONNECT]:Is(o),[ti.CLIENTS_DISCONNECTED]:Es(o,e),[ti.CHANNEL_CREATED]:ms(o),[ti.CLIENTS_WAITING]:Ss(o)};for(const[e,n]of Object.entries(A))try{u.communicationLayer.on(e,n)}catch(t){console.error(`Error registering handler for ${e}:`,t)}}({communicationLayerPreference:e,otherPublicKey:t,reconnect:n,ecies:r,communicationServerUrl:i,instance:this})}originatorSessionConnect(){return Xr(this,void 0,void 0,(function*(){return yield function(e){var t,n,r;return Xr(this,void 0,void 0,(function*(){const{state:i}=e;if(!i.storageManager)return void(i.debug&&console.debug("RemoteCommunication::connect() no storage manager defined - skip"));const o=yield i.storageManager.getPersistedChannelConfig(null!==(t=i.channelId)&&void 0!==t?t:"");if(i.debug&&console.debug(`RemoteCommunication::connect() autoStarted=${i.originatorConnectStarted} channelConfig`,o),null===(n=i.communicationLayer)||void 0===n?void 0:n.isConnected())return i.debug&&console.debug("RemoteCommunication::connect() socket already connected - skip"),o;if(o){if(o.validUntil>Date.now())return i.channelConfig=o,i.originatorConnectStarted=!0,i.channelId=null==o?void 0:o.channelId,i.reconnection=!0,null===(r=i.communicationLayer)||void 0===r||r.connectToChannel({channelId:o.channelId,isOriginator:!0}),o;i.debug&&console.log("RemoteCommunication::autoConnect Session has expired")}i.originatorConnectStarted=!1}))}(this)}))}generateChannelIdConnect(){return Xr(this,void 0,void 0,(function*(){return function(e){var t,n,r,i,o;if(!e.communicationLayer)throw new Error("communication layer not initialized");if(e.ready)throw new Error("Channel already connected");if(e.channelId&&(null===(t=e.communicationLayer)||void 0===t?void 0:t.isConnected()))return console.warn("Channel already exists -- interrupt generateChannelId",e.channelConfig),e.channelConfig={channelId:e.channelId,validUntil:Date.now()+e.sessionDuration},null===(n=e.storageManager)||void 0===n||n.persistChannelConfig(e.channelConfig),{channelId:e.channelId,pubKey:null===(i=null===(r=e.communicationLayer)||void 0===r?void 0:r.getKeyInfo())||void 0===i?void 0:i.ecies.public};e.debug&&console.debug("RemoteCommunication::generateChannelId()"),oi(e);const s=e.communicationLayer.createChannel();e.debug&&console.debug("RemoteCommunication::generateChannelId() channel created",s);const a={channelId:s.channelId,validUntil:Date.now()+e.sessionDuration};return e.channelId=s.channelId,e.channelConfig=a,null===(o=e.storageManager)||void 0===o||o.persistChannelConfig(a),{channelId:e.channelId,pubKey:s.pubKey}}(this.state)}))}clean(){return oi(this.state)}connectToChannel(e,t){return function({channelId:e,withKeyExchange:t,state:n}){var r,i,o;if(!pi(e))throw console.debug(`RemoteCommunication::${n.context}::connectToChannel() invalid channel channelId=${e}`),new Error(`Invalid channel ${e}`);if(n.debug&&console.debug(`RemoteCommunication::${n.context}::connectToChannel() channelId=${e}`),null===(r=n.communicationLayer)||void 0===r?void 0:r.isConnected())return void console.debug(`RemoteCommunication::${n.context}::connectToChannel() already connected - interrup connection.`);n.channelId=e,null===(i=n.communicationLayer)||void 0===i||i.connectToChannel({channelId:e,withKeyExchange:t});const s={channelId:e,validUntil:Date.now()+n.sessionDuration};n.channelConfig=s,null===(o=n.storageManager)||void 0===o||o.persistChannelConfig(s)}({channelId:e,withKeyExchange:t,state:this.state})}sendMessage(e){return function(e,t){var n,r;return Xr(this,void 0,void 0,(function*(){const{state:i}=e;i.debug&&console.log(`RemoteCommunication::${i.context}::sendMessage paused=${i.paused} ready=${i.ready} authorized=${i.authorized} socket=${null===(n=i.communicationLayer)||void 0===n?void 0:n.isConnected()} clientsConnected=${i.clientsConnected} status=${i._connectionStatus}`,t),!i.paused&&i.ready&&(null===(r=i.communicationLayer)||void 0===r?void 0:r.isConnected())&&i.clientsConnected||(i.debug&&console.log(`RemoteCommunication::${i.context}::sendMessage  SKIP message waiting for MM mobile readiness.`),yield new Promise((t=>{e.once(ti.CLIENTS_READY,t)})),i.debug&&console.log(`RemoteCommunication::${i.context}::sendMessage  AFTER SKIP / READY -- sending pending message`));try{yield function(e,t){return Xr(this,void 0,void 0,(function*(){return new Promise((n=>{var r,i,o,s;const{state:a}=e;if(a.debug&&console.log(`RemoteCommunication::${a.context}::sendMessage::handleAuthorization ready=${a.ready} authorized=${a.authorized} method=${t.method}`),1==="7.3".localeCompare((null===(r=a.walletInfo)||void 0===r?void 0:r.version)||""))return a.debug&&console.debug(`compatibility hack wallet version > ${null===(i=a.walletInfo)||void 0===i?void 0:i.version}`),null===(o=a.communicationLayer)||void 0===o||o.sendMessage(t),void n();!a.isOriginator||a.authorized?(null===(s=a.communicationLayer)||void 0===s||s.sendMessage(t),n()):e.once(ti.AUTHORIZED,(()=>{var e;a.debug&&console.log(`RemoteCommunication::${a.context}::sendMessage  AFTER SKIP / AUTHORIZED -- sending pending message`),null===(e=a.communicationLayer)||void 0===e||e.sendMessage(t),n()}))}))}))}(e,t)}catch(e){throw console.error(`RemoteCommunication::${i.context}::sendMessage  ERROR`,e),e}}))}(this,e)}testStorage(){return Xr(this,void 0,void 0,(function*(){return function(e){var t,n;return Xr(this,void 0,void 0,(function*(){const r=yield null===(t=e.storageManager)||void 0===t?void 0:t.getPersistedChannelConfig(null!==(n=e.channelId)&&void 0!==n?n:"");console.debug("RemoteCommunication.testStorage() res",r)}))}(this.state)}))}getChannelConfig(){return this.state.channelConfig}isReady(){return this.state.ready}isConnected(){var e;return null===(e=this.state.communicationLayer)||void 0===e?void 0:e.isConnected()}isAuthorized(){return this.state.authorized}isPaused(){return this.state.paused}getCommunicationLayer(){return this.state.communicationLayer}ping(){var e;this.state.debug&&console.debug(`RemoteCommunication::ping() channel=${this.state.channelId}`),null===(e=this.state.communicationLayer)||void 0===e||e.ping()}keyCheck(){var e;this.state.debug&&console.debug(`RemoteCommunication::keyCheck() channel=${this.state.channelId}`),null===(e=this.state.communicationLayer)||void 0===e||e.keyCheck()}setConnectionStatus(e){this.state._connectionStatus!==e&&(this.state._connectionStatus=e,this.emit(ti.CONNECTION_STATUS,e),this.emitServiceStatusEvent())}emitServiceStatusEvent(){this.emit(ti.SERVICE_STATUS,this.getServiceStatus())}getConnectionStatus(){return this.state._connectionStatus}getServiceStatus(){return{originatorInfo:this.state.originatorInfo,keyInfo:this.getKeyInfo(),connectionStatus:this.state._connectionStatus,channelConfig:this.state.channelConfig,channelId:this.state.channelId}}getKeyInfo(){var e;return null===(e=this.state.communicationLayer)||void 0===e?void 0:e.getKeyInfo()}resetKeys(){var e;null===(e=this.state.communicationLayer)||void 0===e||e.resetKeys()}pause(){var e;this.state.debug&&console.debug(`RemoteCommunication::pause() channel=${this.state.channelId}`),null===(e=this.state.communicationLayer)||void 0===e||e.pause(),this.setConnectionStatus(ui.PAUSED)}getVersion(){return ii}resume(){return function(e){var t;const{state:n}=e;n.debug&&console.debug(`RemoteCommunication::resume() channel=${n.channelId}`),null===(t=n.communicationLayer)||void 0===t||t.resume(),e.setConnectionStatus(ui.LINKED)}(this)}getChannelId(){return this.state.channelId}disconnect(e){return Os({options:e,instance:this})}}!function(e){e.RENEW="renew",e.LINK="link"}(_s||(_s={}));var Ps="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ts(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ns(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n}var Ls={exports:{}};
/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */!function(e,t){!function(t){var n=Object.hasOwnProperty,r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i="object"==typeof process&&"function"==typeof process.nextTick,o="function"==typeof Symbol,s="object"==typeof Reflect,a="function"==typeof setImmediate?setImmediate:setTimeout,c=o?s&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function d(){this._events={},this._conf&&u.call(this,this._conf)}function u(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==t&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function h(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),"undefined"!=typeof process&&process.emitWarning){var r=new Error(n);r.name="MaxListenersExceededWarning",r.emitter=this,r.count=e,process.emitWarning(r)}else console.error(n),console.trace&&console.trace()}var f=function(e,t,n){var r=arguments.length;switch(r){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var i=new Array(r);r--;)i[r]=arguments[r];return i}};function l(e,n){for(var r={},i=e.length,o=n?n.length:0,s=0;s<i;s++)r[e[s]]=s<o?n[s]:t;return r}function A(e,t,n){var r,i;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(r=n.on,i=n.off),t.addEventListener?(r=t.addEventListener,i=t.removeEventListener):t.addListener?(r=t.addListener,i=t.removeListener):t.on&&(r=t.on,i=t.off),!r&&!i)throw Error("target does not implement any known event API");if("function"!=typeof r)throw TypeError("on method must be a function");if("function"!=typeof i)throw TypeError("off method must be a function");this._on=r,this._off=i;var o=e._observers;o?o.push(this):e._observers=[this]}function p(e,r,i,o){var s=Object.assign({},r);if(!e)return s;if("object"!=typeof e)throw TypeError("options must be an object");var a,c,d,u=Object.keys(e),h=u.length;function f(e){throw Error('Invalid "'+a+'" option value'+(e?". Reason: "+e:""))}for(var l=0;l<h;l++){if(a=u[l],!o&&!n.call(r,a))throw Error('Unknown "'+a+'" option');(c=e[a])!==t&&(d=i[a],s[a]=d?d(c,f):c)}return s}function b(e,t){return"function"==typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function m(e){var t="value must be type of "+e.join("|"),n=e.length,r=e[0],i=e[1];return 1===n?function(e,n){if(typeof e===r)return e;n(t)}:2===n?function(e,n){var o=typeof e;if(o===r||o===i)return e;n(t)}:function(r,i){for(var o=typeof r,s=n;s-- >0;)if(o===e[s])return r;i(t)}}Object.assign(A.prototype,{subscribe:function(e,t,n){var r=this,i=this._target,o=this._emitter,s=this._listeners,a=function(){var r=f.apply(null,arguments),s={data:r,name:t,original:e};n?!1!==n.call(i,s)&&o.emit.apply(o,[s.name].concat(r)):o.emit.apply(o,[t].concat(r))};if(s[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,o._newListener&&o._removeListener&&!r._onNewListener?(this._onNewListener=function(n){n===t&&null===s[e]&&(s[e]=a,r._on.call(i,e,a))},o.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===t&&!o.hasListeners(n)&&s[e]&&(s[e]=null,r._off.call(i,e,a))},s[e]=null,o.on("removeListener",this._onRemoveListener)):(s[e]=a,r._on.call(i,e,a))},unsubscribe:function(e){var t,n,r,i=this,o=this._listeners,s=this._emitter,a=this._off,d=this._target;if(e&&"string"!=typeof e)throw TypeError("event must be a string");function u(){i._onNewListener&&(s.off("newListener",i._onNewListener),s.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var e=w.call(s,i);s._observers.splice(e,1)}if(e){if(!(t=o[e]))return;a.call(d,e,t),delete o[e],--this._listenersCount||u()}else{for(r=(n=c(o)).length;r-- >0;)e=n[r],a.call(d,e,o[e]);this._listeners={},this._listenersCount=0,u()}}});var g=m(["function"]),v=m(["object","function"]);function y(e,t,n){var r,i,o,s=0,a=new e((function(c,d,u){function h(){i&&(i=null),s&&(clearTimeout(s),s=0)}n=p(n,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!=typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),r=!n.overload&&"function"==typeof e.prototype.cancel&&"function"==typeof u;var f=function(e){h(),c(e)},l=function(e){h(),d(e)};r?t(f,l,u):(i=[function(e){l(e||Error("canceled"))}],t(f,l,(function(e){if(o)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof e)throw TypeError("onCancel callback must be a function");i.push(e)})),o=!0),n.timeout>0&&(s=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",s=0,a.cancel(e),d(e)}),n.timeout))}));return r||(a.cancel=function(e){if(i){for(var t=i.length,n=1;n<t;n++)i[n](e);i[0](e),i=null}}),a}function w(e){var t=this._observers;if(!t)return-1;for(var n=t.length,r=0;r<n;r++)if(t[r]._target===e)return r;return-1}function _(e,t,n,r,i){if(!n)return null;if(0===r){var o=typeof t;if("string"===o){var s,a,d=0,u=0,h=this.delimiter,f=h.length;if(-1!==(a=t.indexOf(h))){s=new Array(5);do{s[d++]=t.slice(u,a),u=a+f}while(-1!==(a=t.indexOf(h,u)));s[d++]=t.slice(u),t=s,i=d}else t=[t],i=1}else"object"===o?i=t.length:(t=[t],i=1)}var l,A,p,b,m,g,v,y=null,w=t[r],M=t[r+1];if(r===i)n._listeners&&("function"==typeof n._listeners?(e&&e.push(n._listeners),y=[n]):(e&&e.push.apply(e,n._listeners),y=[n]));else{if("*"===w){for(a=(g=c(n)).length;a-- >0;)"_listeners"!==(l=g[a])&&(v=_(e,t,n[l],r+1,i))&&(y?y.push.apply(y,v):y=v);return y}if("**"===w){for((m=r+1===i||r+2===i&&"*"===M)&&n._listeners&&(y=_(e,t,n,i,i)),a=(g=c(n)).length;a-- >0;)"_listeners"!==(l=g[a])&&("*"===l||"**"===l?(n[l]._listeners&&!m&&(v=_(e,t,n[l],i,i))&&(y?y.push.apply(y,v):y=v),v=_(e,t,n[l],r,i)):v=_(e,t,n[l],l===M?r+2:r,i),v&&(y?y.push.apply(y,v):y=v));return y}n[w]&&(y=_(e,t,n[w],r+1,i))}if((A=n["*"])&&_(e,t,A,r+1,i),p=n["**"])if(r<i)for(p._listeners&&_(e,t,p,i,i),a=(g=c(p)).length;a-- >0;)"_listeners"!==(l=g[a])&&(l===M?_(e,t,p[l],r+2,i):l===w?_(e,t,p[l],r+1,i):((b={})[l]=p[l],_(e,t,{"**":b},r+1,i)));else p._listeners?_(e,t,p,i,i):p["*"]&&p["*"]._listeners&&_(e,t,p["*"],i,i);return y}function M(e,t,n){var r,i,o=0,s=0,a=this.delimiter,c=a.length;if("string"==typeof e)if(-1!==(r=e.indexOf(a))){i=new Array(5);do{i[o++]=e.slice(s,r),s=r+c}while(-1!==(r=e.indexOf(a,s)));i[o++]=e.slice(s)}else i=[e],o=1;else i=e,o=e.length;if(o>1)for(r=0;r+1<o;r++)if("**"===i[r]&&"**"===i[r+1])return;var d,u=this.listenerTree;for(r=0;r<o;r++)if(u=u[d=i[r]]||(u[d]={}),r===o-1)return u._listeners?("function"==typeof u._listeners&&(u._listeners=[u._listeners]),n?u._listeners.unshift(t):u._listeners.push(t),!u._listeners.warned&&this._maxListeners>0&&u._listeners.length>this._maxListeners&&(u._listeners.warned=!0,h.call(this,u._listeners.length,d))):u._listeners=t,!0;return!0}function E(e,t,n,r){for(var i,o,s,a,d=c(e),u=d.length,h=e._listeners;u-- >0;)i=e[o=d[u]],s="_listeners"===o?n:n?n.concat(o):[o],a=r||"symbol"==typeof o,h&&t.push(a?s:s.join(this.delimiter)),"object"==typeof i&&E.call(this,i,t,s,a);return t}function S(e){for(var t,n,r,i=c(e),o=i.length;o-- >0;)(t=e[n=i[o]])&&(r=!0,"_listeners"===n||S(t)||delete e[n]);return r}function k(e,t,n){this.emitter=e,this.event=t,this.listener=n}function C(e,n,r){if(!0===r)s=!0;else if(!1===r)o=!0;else{if(!r||"object"!=typeof r)throw TypeError("options should be an object or true");var o=r.async,s=r.promisify,c=r.nextTick,d=r.objectify}if(o||c||s){var u=n,h=n._origin||n;if(c&&!i)throw Error("process.nextTick is not supported");s===t&&(s="AsyncFunction"===n.constructor.name),n=function(){var e=arguments,t=this,n=this.event;return s?c?Promise.resolve():new Promise((function(e){a(e)})).then((function(){return t.event=n,u.apply(t,e)})):(c?process.nextTick:a)((function(){t.event=n,u.apply(t,e)}))},n._async=!0,n._origin=h}return[n,d?new k(this,e,n):this]}function I(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,u.call(this,e)}k.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},I.EventEmitter2=I,I.prototype.listenTo=function(e,n,i){if("object"!=typeof e)throw TypeError("target musts be an object");var o=this;function s(t){if("object"!=typeof t)throw TypeError("events must be an object");var n,r=i.reducers,s=w.call(o,e);n=-1===s?new A(o,e,i):o._observers[s];for(var a,d=c(t),u=d.length,h="function"==typeof r,f=0;f<u;f++)a=d[f],n.subscribe(a,t[a]||a,h?r:r&&r[a])}return i=p(i,{on:t,off:t,reducers:t},{on:g,off:g,reducers:v}),r(n)?s(l(n)):s("string"==typeof n?l(n.split(/\s+/)):n),this},I.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var r,i=n.length,o=!1;if(e&&"object"!=typeof e)throw TypeError("target should be an object");for(;i-- >0;)r=n[i],e&&r._target!==e||(r.unsubscribe(t),o=!0);return o},I.prototype.delimiter=".",I.prototype.setMaxListeners=function(e){e!==t&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},I.prototype.getMaxListeners=function(){return this._maxListeners},I.prototype.event="",I.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},I.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},I.prototype._once=function(e,t,n,r){return this._many(e,1,t,n,r)},I.prototype.many=function(e,t,n,r){return this._many(e,t,n,!1,r)},I.prototype.prependMany=function(e,t,n,r){return this._many(e,t,n,!0,r)},I.prototype._many=function(e,t,n,r,i){var o=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function s(){return 0==--t&&o.off(e,s),n.apply(this,arguments)}return s._origin=n,this._on(e,s,r,i)},I.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||d.call(this);var e,t,n,r,i,s,a=arguments[0],c=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return!1;if(c&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(n=a.length,o)for(r=0;r<n;r++)if("symbol"==typeof a[r]){s=!0;break}s||(a=a.join(this.delimiter))}var u,h=arguments.length;if(this._all&&this._all.length)for(r=0,n=(u=this._all.slice()).length;r<n;r++)switch(this.event=a,h){case 1:u[r].call(this,a);break;case 2:u[r].call(this,a,arguments[1]);break;case 3:u[r].call(this,a,arguments[1],arguments[2]);break;default:u[r].apply(this,arguments)}if(c)u=[],_.call(this,u,e,this.listenerTree,0,n);else{if("function"==typeof(u=this._events[a])){switch(this.event=a,h){case 1:u.call(this);break;case 2:u.call(this,arguments[1]);break;case 3:u.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(h-1),i=1;i<h;i++)t[i-1]=arguments[i];u.apply(this,t)}return!0}u&&(u=u.slice())}if(u&&u.length){if(h>3)for(t=new Array(h-1),i=1;i<h;i++)t[i-1]=arguments[i];for(r=0,n=u.length;r<n;r++)switch(this.event=a,h){case 1:u[r].call(this);break;case 2:u[r].call(this,arguments[1]);break;case 3:u[r].call(this,arguments[1],arguments[2]);break;default:u[r].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===a)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},I.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||d.call(this);var e,t,n,r,i,s,a=arguments[0],c=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(c&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(r=a.length,o)for(i=0;i<r;i++)if("symbol"==typeof a[i]){t=!0;break}t||(a=a.join(this.delimiter))}var u,h=[],f=arguments.length;if(this._all)for(i=0,r=this._all.length;i<r;i++)switch(this.event=a,f){case 1:h.push(this._all[i].call(this,a));break;case 2:h.push(this._all[i].call(this,a,arguments[1]));break;case 3:h.push(this._all[i].call(this,a,arguments[1],arguments[2]));break;default:h.push(this._all[i].apply(this,arguments))}if(c?(u=[],_.call(this,u,e,this.listenerTree,0)):u=this._events[a],"function"==typeof u)switch(this.event=a,f){case 1:h.push(u.call(this));break;case 2:h.push(u.call(this,arguments[1]));break;case 3:h.push(u.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(f-1),s=1;s<f;s++)n[s-1]=arguments[s];h.push(u.apply(this,n))}else if(u&&u.length){if(u=u.slice(),f>3)for(n=new Array(f-1),s=1;s<f;s++)n[s-1]=arguments[s];for(i=0,r=u.length;i<r;i++)switch(this.event=a,f){case 1:h.push(u[i].call(this));break;case 2:h.push(u[i].call(this,arguments[1]));break;case 3:h.push(u[i].call(this,arguments[1],arguments[2]));break;default:h.push(u[i].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===a)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(h)},I.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},I.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},I.prototype.onAny=function(e){return this._onAny(e,!1)},I.prototype.prependAny=function(e){return this._onAny(e,!0)},I.prototype.addListener=I.prototype.on,I.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},I.prototype._on=function(e,n,r,i){if("function"==typeof e)return this._onAny(e,n),this;if("function"!=typeof n)throw new Error("on only accepts instances of Function");this._events||d.call(this);var o,s=this;return i!==t&&(n=(o=C.call(this,e,n,i))[0],s=o[1]),this._newListener&&this.emit("newListener",e,n),this.wildcard?(M.call(this,e,n,r),s):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),r?this._events[e].unshift(n):this._events[e].push(n),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,h.call(this,this._events[e].length,e))):this._events[e]=n,s)},I.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,i=[];if(this.wildcard){var o="string"==typeof e?e.split(this.delimiter):e.slice();if(!(i=_.call(this,null,o,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],i.push({_listeners:n})}for(var s=0;s<i.length;s++){var a=i[s];if(n=a._listeners,r(n)){for(var c=-1,d=0,u=n.length;d<u;d++)if(n[d]===t||n[d].listener&&n[d].listener===t||n[d]._origin&&n[d]._origin===t){c=d;break}if(c<0)continue;return this.wildcard?a._listeners.splice(c,1):this._events[e].splice(c,1),0===n.length&&(this.wildcard?delete a._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete a._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&S(this.listenerTree),this},I.prototype.offAny=function(e){var t,n=0,r=0;if(e&&this._all&&this._all.length>0){for(n=0,r=(t=this._all).length;n<r;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,r=t.length;n<r;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},I.prototype.removeListener=I.prototype.off,I.prototype.removeAllListeners=function(e){if(e===t)return!this._events||d.call(this),this;if(this.wildcard){var n,r=_.call(this,null,e,this.listenerTree,0);if(!r)return this;for(n=0;n<r.length;n++)r[n]._listeners=null;this.listenerTree&&S(this.listenerTree)}else this._events&&(this._events[e]=null);return this},I.prototype.listeners=function(e){var n,r,i,o,s,a=this._events;if(e===t){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!a)return[];for(o=(n=c(a)).length,i=[];o-- >0;)"function"==typeof(r=a[n[o]])?i.push(r):i.push.apply(i,r);return i}if(this.wildcard){if(!(s=this.listenerTree))return[];var d=[],u="string"==typeof e?e.split(this.delimiter):e.slice();return _.call(this,d,u,s,0),d}return a&&(r=a[e])?"function"==typeof r?[r]:r:[]},I.prototype.eventNames=function(e){var t=this._events;return this.wildcard?E.call(this,this.listenerTree,[],null,e):t?c(t):[]},I.prototype.listenerCount=function(e){return this.listeners(e).length},I.prototype.hasListeners=function(e){if(this.wildcard){var n=[],r="string"==typeof e?e.split(this.delimiter):e.slice();return _.call(this,n,r,this.listenerTree,0),n.length>0}var i=this._events,o=this._all;return!!(o&&o.length||i&&(e===t?c(i).length:i[e]))},I.prototype.listenersAny=function(){return this._all?this._all:[]},I.prototype.waitFor=function(e,n){var r=this,i=typeof n;return"number"===i?n={timeout:n}:"function"===i&&(n={filter:n}),y((n=p(n,{timeout:0,filter:t,handleError:!1,Promise:Promise,overload:!1},{filter:g,Promise:b})).Promise,(function(t,i,o){function s(){var o=n.filter;if(!o||o.apply(r,arguments))if(r.off(e,s),n.handleError){var a=arguments[0];a?i(a):t(f.apply(null,arguments).slice(1))}else t(f.apply(null,arguments))}o((function(){r.off(e,s)})),r._on(e,s,!1)}),{timeout:n.timeout,overload:n.overload})};var x=I.prototype;Object.defineProperties(I,{defaultMaxListeners:{get:function(){return x._maxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");x._maxListeners=e},enumerable:!0},once:{value:function(e,t,n){return y((n=p(n,{Promise:Promise,timeout:0,overload:!1},{Promise:b})).Promise,(function(n,r,i){var o;if("function"==typeof e.addEventListener)return o=function(){n(f.apply(null,arguments))},i((function(){e.removeEventListener(t,o)})),void e.addEventListener(t,o,{once:!0});var s,a=function(){s&&e.removeListener("error",s),n(f.apply(null,arguments))};"error"!==t&&(s=function(n){e.removeListener(t,a),r(n)},e.once("error",s)),i((function(){s&&e.removeListener("error",s),e.removeListener(t,a)})),e.once(t,a)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(x,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),"function"==typeof t&&t.amd?t((function(){return I})):e.exports=I}()}(Ls);var Bs=Ts(Ls.exports);const Ds={eth_requestAccounts:!0,eth_sendTransaction:!0,eth_signTransaction:!0,eth_sign:!0,personal_sign:!0,eth_signTypedData:!0,eth_signTypedData_v3:!0,eth_signTypedData_v4:!0,wallet_watchAsset:!0,wallet_addEthereumChain:!0,wallet_switchEthereumChain:!0},js=".sdk-comm",Fs="providerType",Ks="metamask_getProviderState",qs="eth_requestAccounts";var zs={exports:{}};zs.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=n(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(n),s=Math.max(i,o),a=0,c=e.map([t,n],(function(t){var n=s-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(a=s-Math.min(i,o)),s-=1;s>=a;){if(c[0][s]>c[1][s])return 1;if(c[0][s]===c[1][s]){if(s===a)return 0;s-=1}else if(c[0][s]<c[1][s])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var i=e[n];if(t(i,n))return i}},e.assign=function(e){for(var t,n,r=e,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var a=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=o.length;t<n;t+=1)a();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,n){t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(91))&&r.__esModule?r:{default:r},o=n(18);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){}var t,n,r;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,r=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}],(n=null)&&s(t.prototype,n),r&&s(t,r),e}();t.default=a,e.exports=t.default},91:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=c(n(92)),i=c(n(93)),o=c(n(94)),s=c(n(95)),a=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=a.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=a.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=a.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=a.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return a.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,i={},o=0;if(Object.keys(e).forEach((function(t){var s=e[t];"string"==typeof s?(i[t]=s,o+=1):"object"==typeof s&&(n[t]=s,r+=1)})),r>0){var s=Object.keys(n),c=a.default.find(s,(function(e){return t.isOS(e)}));if(c){var d=this.satisfies(n[c]);if(void 0!==d)return d}var u=a.default.find(s,(function(e){return t.isPlatform(e)}));if(u){var h=this.satisfies(n[u]);if(void 0!==h)return h}}if(o>0){var f=Object.keys(i),l=a.default.find(f,(function(e){return t.isBrowser(e,!0)}));if(void 0!==l)return this.compareVersion(i[l])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),i=a.default.getBrowserTypeByAlias(r);return t&&i&&(r=i.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(a.default.compareVersions(i,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=d,e.exports=t.default},92:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=s,e.exports=t.default},93:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),s=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},n=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=i.default.getMacOSVersionName(t),r={name:o.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=i.default.getAndroidVersionName(t),r={name:o.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:o.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=s,e.exports=t.default},94:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),s=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=s,e.exports=t.default},95:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),s=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},n=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},n=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},n=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},n=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=s,e.exports=t.default}});var Vs=zs.exports,Ws=Ts(Vs);var Us,Qs=(Us=Vs)&&"object"==typeof Us&&"default"in Us?Us.default:Us;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Hs(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function Ys(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var $s="INSTALLED",Gs="NOT_INSTALLED",Zs="REGISTERED",Js="REGISTERING",Xs="RELOADING",ea={CHROME:"https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn",FIREFOX:"https://addons.mozilla.org/firefox/addon/ether-metamask/",DEFAULT:"https://metamask.io"},ta="REGISTRATION_IN_PROGRESS",na="FORWARDER_ID",ra=function(){function e(t){var n=void 0===t?{}:t,r=n.forwarderOrigin,i=void 0===r?"https://fwd.metamask.io":r,o=n.forwarderMode,s=void 0===o?e.FORWARDER_MODE.INJECT:o;this.forwarderOrigin=i,this.forwarderMode=s,this.state=e.isMetaMaskInstalled()?$s:Gs;var a=e._detectBrowser();this.downloadUrl=a?ea[a]:ea.DEFAULT,this._onMessage=this._onMessage.bind(this),this._onMessageFromForwarder=this._onMessageFromForwarder.bind(this),this._openForwarder=this._openForwarder.bind(this),this._openDownloadPage=this._openDownloadPage.bind(this),this.startOnboarding=this.startOnboarding.bind(this),this.stopOnboarding=this.stopOnboarding.bind(this),window.addEventListener("message",this._onMessage),s===e.FORWARDER_MODE.INJECT&&"true"===sessionStorage.getItem(ta)&&e._injectForwarder(this.forwarderOrigin)}return e.prototype._onMessage=function(e){if(e.origin===this.forwarderOrigin)return"metamask:reload"===e.data.type?this._onMessageFromForwarder(e):void console.debug("Unknown message from '"+e.origin+"' with data "+JSON.stringify(e.data))},e.prototype._onMessageUnknownStateError=function(e){throw new Error("Unknown state: '"+e+"'")},e.prototype._onMessageFromForwarder=function(t){return Hs(this,void 0,void 0,(function(){return Ys(this,(function(n){switch(n.label){case 0:switch(this.state){case Xs:return[3,1];case Gs:return[3,2];case $s:return[3,3];case Js:return[3,5];case Zs:return[3,6]}return[3,7];case 1:return console.debug("Ignoring message while reloading"),[3,8];case 2:return console.debug("Reloading now to register with MetaMask"),this.state=Xs,location.reload(),[3,8];case 3:return console.debug("Registering with MetaMask"),this.state=Js,[4,e._register()];case 4:return n.sent(),this.state=Zs,t.source.postMessage({type:"metamask:registrationCompleted"},t.origin),this.stopOnboarding(),[3,8];case 5:return console.debug("Already registering - ignoring reload message"),[3,8];case 6:return console.debug("Already registered - ignoring reload message"),[3,8];case 7:this._onMessageUnknownStateError(this.state),n.label=8;case 8:return[2]}}))}))},e.prototype.startOnboarding=function(){sessionStorage.setItem(ta,"true"),this._openDownloadPage(),this._openForwarder()},e.prototype.stopOnboarding=function(){"true"===sessionStorage.getItem(ta)&&(this.forwarderMode===e.FORWARDER_MODE.INJECT&&(console.debug("Removing forwarder"),e._removeForwarder()),sessionStorage.setItem(ta,"false"))},e.prototype._openForwarder=function(){this.forwarderMode===e.FORWARDER_MODE.OPEN_TAB?window.open(this.forwarderOrigin,"_blank"):e._injectForwarder(this.forwarderOrigin)},e.prototype._openDownloadPage=function(){window.open(this.downloadUrl,"_blank")},e.isMetaMaskInstalled=function(){return Boolean(window.ethereum&&window.ethereum.isMetaMask)},e._register=function(){return window.ethereum.request({method:"wallet_registerOnboarding"})},e._injectForwarder=function(e){var t=document.body,n=document.createElement("iframe");n.setAttribute("height","0"),n.setAttribute("width","0"),n.setAttribute("style","display: none;"),n.setAttribute("src",e),n.setAttribute("id",na),t.insertBefore(n,t.children[0])},e._removeForwarder=function(){var e;null===(e=document.getElementById(na))||void 0===e||e.remove()},e._detectBrowser=function(){var e=Qs.parse(window.navigator.userAgent);return"Firefox"===e.browser.name?"FIREFOX":["Chrome","Chromium"].includes(e.browser.name||"")?"CHROME":null},e.FORWARDER_MODE={INJECT:"INJECT",OPEN_TAB:"OPEN_TAB"},e}(),ia=Ts(ra),oa={},sa={},aa={};Object.defineProperty(aa,"__esModule",{value:!0});const ca=r;function da(e,t,n){try{Reflect.apply(e,t,n)}catch(e){setTimeout((()=>{throw e}))}}let ua=class extends ca.EventEmitter{emit(e,...t){let n="error"===e;const r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){let e;if(t.length>0&&([e]=t),e instanceof Error)throw e;const n=new Error("Unhandled error."+(e?` (${e.message})`:""));throw n.context=e,n}const i=r[e];if(void 0===i)return!1;if("function"==typeof i)da(i,this,t);else{const e=i.length,n=function(e){const t=e.length,n=new Array(t);for(let r=0;r<t;r+=1)n[r]=e[r];return n}(i);for(let r=0;r<e;r+=1)da(n[r],this,t)}return!0}};aa.default=ua;var ha={},fa={},la=va;va.default=va,va.stable=Ma,va.stableStringify=Ma;var Aa="[...]",pa="[Circular]",ba=[],ma=[];function ga(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function va(e,t,n,r){var i;void 0===r&&(r=ga()),wa(e,"",0,[],void 0,0,r);try{i=0===ma.length?JSON.stringify(e,t,n):JSON.stringify(e,Sa(t),n)}catch(e){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==ba.length;){var o=ba.pop();4===o.length?Object.defineProperty(o[0],o[1],o[3]):o[0][o[1]]=o[2]}}return i}function ya(e,t,n,r){var i=Object.getOwnPropertyDescriptor(r,n);void 0!==i.get?i.configurable?(Object.defineProperty(r,n,{value:e}),ba.push([r,n,t,i])):ma.push([t,n,e]):(r[n]=e,ba.push([r,n,t]))}function wa(e,t,n,r,i,o,s){var a;if(o+=1,"object"==typeof e&&null!==e){for(a=0;a<r.length;a++)if(r[a]===e)return void ya(pa,e,t,i);if(void 0!==s.depthLimit&&o>s.depthLimit)return void ya(Aa,e,t,i);if(void 0!==s.edgesLimit&&n+1>s.edgesLimit)return void ya(Aa,e,t,i);if(r.push(e),Array.isArray(e))for(a=0;a<e.length;a++)wa(e[a],a,a,r,e,o,s);else{var c=Object.keys(e);for(a=0;a<c.length;a++){var d=c[a];wa(e[d],d,a,r,e,o,s)}}r.pop()}}function _a(e,t){return e<t?-1:e>t?1:0}function Ma(e,t,n,r){void 0===r&&(r=ga());var i,o=Ea(e,"",0,[],void 0,0,r)||e;try{i=0===ma.length?JSON.stringify(o,t,n):JSON.stringify(o,Sa(t),n)}catch(e){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==ba.length;){var s=ba.pop();4===s.length?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return i}function Ea(e,t,n,r,i,o,s){var a;if(o+=1,"object"==typeof e&&null!==e){for(a=0;a<r.length;a++)if(r[a]===e)return void ya(pa,e,t,i);try{if("function"==typeof e.toJSON)return}catch(e){return}if(void 0!==s.depthLimit&&o>s.depthLimit)return void ya(Aa,e,t,i);if(void 0!==s.edgesLimit&&n+1>s.edgesLimit)return void ya(Aa,e,t,i);if(r.push(e),Array.isArray(e))for(a=0;a<e.length;a++)Ea(e[a],a,a,r,e,o,s);else{var c={},d=Object.keys(e).sort(_a);for(a=0;a<d.length;a++){var u=d[a];Ea(e[u],u,a,r,e,o,s),c[u]=e[u]}if(void 0===i)return c;ba.push([i,t,e]),i[t]=c}r.pop()}}function Sa(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(ma.length>0)for(var r=0;r<ma.length;r++){var i=ma[r];if(i[1]===t&&i[0]===n){n=i[2],ma.splice(r,1);break}}return e.call(this,t,n)}}Object.defineProperty(fa,"__esModule",{value:!0}),fa.EthereumProviderError=fa.EthereumRpcError=void 0;const ka=la;class Ca extends Error{constructor(e,t,n){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!t||"string"!=typeof t)throw new Error('"message" must be a nonempty string.');super(t),this.code=e,void 0!==n&&(this.data=n)}serialize(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),this.stack&&(e.stack=this.stack),e}toString(){return ka.default(this.serialize(),Ia,2)}}fa.EthereumRpcError=Ca;function Ia(e,t){if("[Circular]"!==t)return t}fa.EthereumProviderError=class extends Ca{constructor(e,t,n){if(!function(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,n)}};var xa={},Oa={};Object.defineProperty(Oa,"__esModule",{value:!0}),Oa.errorValues=Oa.errorCodes=void 0,Oa.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}},Oa.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.serializeError=e.isValidCode=e.getMessageFromCode=e.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const t=Oa,n=fa,r=t.errorCodes.rpc.internal,i="Unspecified error message. This is a bug, please report it.",o={code:r,message:s(r)};function s(n,r=i){if(Number.isInteger(n)){const r=n.toString();if(u(t.errorValues,r))return t.errorValues[r].message;if(c(n))return e.JSON_RPC_SERVER_ERROR_MESSAGE}return r}function a(e){if(!Number.isInteger(e))return!1;const n=e.toString();return!!t.errorValues[n]||!!c(e)}function c(e){return e>=-32099&&e<=-32e3}function d(e){return e&&"object"==typeof e&&!Array.isArray(e)?Object.assign({},e):e}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.",e.getMessageFromCode=s,e.isValidCode=a,e.serializeError=function(e,{fallbackError:t=o,shouldIncludeStack:r=!1}={}){var i,c;if(!t||!Number.isInteger(t.code)||"string"!=typeof t.message)throw new Error("Must provide fallback error with integer number code and string message.");if(e instanceof n.EthereumRpcError)return e.serialize();const h={};if(e&&"object"==typeof e&&!Array.isArray(e)&&u(e,"code")&&a(e.code)){const t=e;h.code=t.code,t.message&&"string"==typeof t.message?(h.message=t.message,u(t,"data")&&(h.data=t.data)):(h.message=s(h.code),h.data={originalError:d(e)})}else{h.code=t.code;const n=null===(i=e)||void 0===i?void 0:i.message;h.message=n&&"string"==typeof n?n:t.message,h.data={originalError:d(e)}}const f=null===(c=e)||void 0===c?void 0:c.stack;return r&&e&&f&&"string"==typeof f&&(h.stack=f),h}}(xa);var Ra={};Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.ethErrors=void 0;const Pa=fa,Ta=xa,Na=Oa;function La(e,t){const[n,r]=Da(t);return new Pa.EthereumRpcError(e,n||Ta.getMessageFromCode(e),r)}function Ba(e,t){const[n,r]=Da(t);return new Pa.EthereumProviderError(e,n||Ta.getMessageFromCode(e),r)}function Da(e){if(e){if("string"==typeof e)return[e];if("object"==typeof e&&!Array.isArray(e)){const{message:t,data:n}=e;if(t&&"string"!=typeof t)throw new Error("Must specify string message.");return[t||void 0,n]}}return[]}Ra.ethErrors={rpc:{parse:e=>La(Na.errorCodes.rpc.parse,e),invalidRequest:e=>La(Na.errorCodes.rpc.invalidRequest,e),invalidParams:e=>La(Na.errorCodes.rpc.invalidParams,e),methodNotFound:e=>La(Na.errorCodes.rpc.methodNotFound,e),internal:e=>La(Na.errorCodes.rpc.internal,e),server:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return La(t,e)},invalidInput:e=>La(Na.errorCodes.rpc.invalidInput,e),resourceNotFound:e=>La(Na.errorCodes.rpc.resourceNotFound,e),resourceUnavailable:e=>La(Na.errorCodes.rpc.resourceUnavailable,e),transactionRejected:e=>La(Na.errorCodes.rpc.transactionRejected,e),methodNotSupported:e=>La(Na.errorCodes.rpc.methodNotSupported,e),limitExceeded:e=>La(Na.errorCodes.rpc.limitExceeded,e)},provider:{userRejectedRequest:e=>Ba(Na.errorCodes.provider.userRejectedRequest,e),unauthorized:e=>Ba(Na.errorCodes.provider.unauthorized,e),unsupportedMethod:e=>Ba(Na.errorCodes.provider.unsupportedMethod,e),disconnected:e=>Ba(Na.errorCodes.provider.disconnected,e),chainDisconnected:e=>Ba(Na.errorCodes.provider.chainDisconnected,e),custom:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:t,message:n,data:r}=e;if(!n||"string"!=typeof n)throw new Error('"message" must be a nonempty string');return new Pa.EthereumProviderError(t,n,r)}}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getMessageFromCode=e.serializeError=e.EthereumProviderError=e.EthereumRpcError=e.ethErrors=e.errorCodes=void 0;const t=fa;Object.defineProperty(e,"EthereumRpcError",{enumerable:!0,get:function(){return t.EthereumRpcError}}),Object.defineProperty(e,"EthereumProviderError",{enumerable:!0,get:function(){return t.EthereumProviderError}});const n=xa;Object.defineProperty(e,"serializeError",{enumerable:!0,get:function(){return n.serializeError}}),Object.defineProperty(e,"getMessageFromCode",{enumerable:!0,get:function(){return n.getMessageFromCode}});const r=Ra;Object.defineProperty(e,"ethErrors",{enumerable:!0,get:function(){return r.ethErrors}});const i=Oa;Object.defineProperty(e,"errorCodes",{enumerable:!0,get:function(){return i.errorCodes}})}(ha);var ja=Array.isArray,Fa=Object.keys,Ka=Object.prototype.hasOwnProperty,qa={},za={},Va={};Object.defineProperty(Va,"__esModule",{value:!0}),Va.getUniqueId=void 0;const Wa=4294967295;let Ua=Math.floor(Math.random()*Wa);Va.getUniqueId=function(){return Ua=(Ua+1)%Wa,Ua},Object.defineProperty(za,"__esModule",{value:!0}),za.createIdRemapMiddleware=void 0;const Qa=Va;za.createIdRemapMiddleware=function(){return(e,t,n,r)=>{const i=e.id,o=Qa.getUniqueId();e.id=o,t.id=o,n((n=>{e.id=i,t.id=i,n()}))}};var Ha={};Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.createAsyncMiddleware=void 0,Ha.createAsyncMiddleware=function(e){return async(t,n,r,i)=>{let o;const s=new Promise((e=>{o=e}));let a=null,c=!1;const d=async()=>{c=!0,r((e=>{a=e,o()})),await s};try{await e(t,n,d),c?(await s,a(null)):i(null)}catch(e){a?a(e):i(e)}}};var Ya={};Object.defineProperty(Ya,"__esModule",{value:!0}),Ya.createScaffoldMiddleware=void 0,Ya.createScaffoldMiddleware=function(e){return(t,n,r,i)=>{const o=e[t.method];return void 0===o?r():"function"==typeof o?o(t,n,r,i):(n.result=o,i())}};var $a={},Ga=Ps&&Ps.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($a,"__esModule",{value:!0}),$a.JsonRpcEngine=void 0;const Za=Ga(aa),Ja=ha;class Xa extends Za.default{constructor(){super(),this._middleware=[]}push(e){this._middleware.push(e)}handle(e,t){if(t&&"function"!=typeof t)throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?this._handleBatch(e,t):this._handleBatch(e):t?this._handle(e,t):this._promiseHandle(e)}asMiddleware(){return async(e,t,n,r)=>{try{const[i,o,s]=await Xa._runAllMiddleware(e,t,this._middleware);return o?(await Xa._runReturnHandlers(s),r(i)):n((async e=>{try{await Xa._runReturnHandlers(s)}catch(t){return e(t)}return e()}))}catch(e){return r(e)}}}async _handleBatch(e,t){try{const n=await Promise.all(e.map(this._promiseHandle.bind(this)));return t?t(null,n):n}catch(e){if(t)return t(e);throw e}}_promiseHandle(e){return new Promise((t=>{this._handle(e,((e,n)=>{t(n)}))}))}async _handle(e,t){if(!e||Array.isArray(e)||"object"!=typeof e){const n=new Ja.EthereumRpcError(Ja.errorCodes.rpc.invalidRequest,"Requests must be plain objects. Received: "+typeof e,{request:e});return t(n,{id:void 0,jsonrpc:"2.0",error:n})}if("string"!=typeof e.method){const n=new Ja.EthereumRpcError(Ja.errorCodes.rpc.invalidRequest,"Must specify a string method. Received: "+typeof e.method,{request:e});return t(n,{id:e.id,jsonrpc:"2.0",error:n})}const n=Object.assign({},e),r={id:n.id,jsonrpc:n.jsonrpc};let i=null;try{await this._processRequest(n,r)}catch(e){i=e}return i&&(delete r.result,r.error||(r.error=Ja.serializeError(i))),t(i,r)}async _processRequest(e,t){const[n,r,i]=await Xa._runAllMiddleware(e,t,this._middleware);if(Xa._checkForCompletion(e,t,r),await Xa._runReturnHandlers(i),n)throw n}static async _runAllMiddleware(e,t,n){const r=[];let i=null,o=!1;for(const s of n)if([i,o]=await Xa._runMiddleware(e,t,s,r),o)break;return[i,o,r.reverse()]}static _runMiddleware(e,t,n,r){return new Promise((i=>{const o=e=>{const n=e||t.error;n&&(t.error=Ja.serializeError(n)),i([n,!0])},s=n=>{t.error?o(t.error):(n&&("function"!=typeof n&&o(new Ja.EthereumRpcError(Ja.errorCodes.rpc.internal,`JsonRpcEngine: "next" return handlers must be functions. Received "${typeof n}" for request:\n${ec(e)}`,{request:e})),r.push(n)),i([null,!1]))};try{n(e,t,s,o)}catch(e){o(e)}}))}static async _runReturnHandlers(e){for(const t of e)await new Promise(((e,n)=>{t((t=>t?n(t):e()))}))}static _checkForCompletion(e,t,n){if(!("result"in t)&&!("error"in t))throw new Ja.EthereumRpcError(Ja.errorCodes.rpc.internal,`JsonRpcEngine: Response has no error or result for request:\n${ec(e)}`,{request:e});if(!n)throw new Ja.EthereumRpcError(Ja.errorCodes.rpc.internal,`JsonRpcEngine: Nothing ended request:\n${ec(e)}`,{request:e})}}function ec(e){return JSON.stringify(e,null,2)}$a.JsonRpcEngine=Xa;var tc={};Object.defineProperty(tc,"__esModule",{value:!0}),tc.mergeMiddleware=void 0;const nc=$a;var rc,ic,oc;tc.mergeMiddleware=function(e){const t=new nc.JsonRpcEngine;return e.forEach((e=>t.push(e))),t.asMiddleware()},rc=qa,ic=Ps&&Ps.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),oc=Ps&&Ps.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||ic(t,e,n)},Object.defineProperty(rc,"__esModule",{value:!0}),oc(za,rc),oc(Ha,rc),oc(Ya,rc),oc(Va,rc),oc($a,rc),oc(tc,rc);var sc={};Object.defineProperty(sc,"__esModule",{value:!0});const ac={errors:{disconnected:()=>"MetaMask: Disconnected from chain. Attempting to connect.",permanentlyDisconnected:()=>"MetaMask: Disconnected from MetaMask background. Page reload required.",sendSiteMetadata:()=>"MetaMask: Failed to send site metadata. This is an internal error, please report this bug.",unsupportedSync:e=>`MetaMask: The MetaMask Ethereum provider does not support synchronous methods like ${e} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidNetworkParams:()=>"MetaMask: Received invalid network parameters. Please report this bug.",invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:e=>`'args.logger' must include required method '${e}'.`},info:{connected:e=>`MetaMask: Connected to chain with ID "${e}".`},warnings:{enableDeprecation:"MetaMask: 'ethereum.enable()' is deprecated and may be removed in the future. Please use the 'eth_requestAccounts' RPC method instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1102",sendDeprecation:"MetaMask: 'ethereum.send(...)' is deprecated and may be removed in the future. Please use 'ethereum.sendAsync(...)' or 'ethereum.request(...)' instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193",events:{close:"MetaMask: The event 'close' is deprecated and may be removed in the future. Please use 'disconnect' instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193#disconnect",data:"MetaMask: The event 'data' is deprecated and will be removed in the future. Use 'message' instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193#message",networkChanged:"MetaMask: The event 'networkChanged' is deprecated and may be removed in the future. Use 'chainChanged' instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193#chainchanged",notification:"MetaMask: The event 'notification' is deprecated and may be removed in the future. Use 'message' instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193#message"},rpc:{ethDecryptDeprecation:"MetaMask: The RPC method 'eth_decrypt' is deprecated and may be removed in the future.\nFor more information, see: https://medium.com/metamask/metamask-api-method-deprecation-2b0564a84686",ethGetEncryptionPublicKeyDeprecation:"MetaMask: The RPC method 'eth_getEncryptionPublicKey' is deprecated and may be removed in the future.\nFor more information, see: https://medium.com/metamask/metamask-api-method-deprecation-2b0564a84686"},experimentalMethods:"MetaMask: 'ethereum._metamask' exposes non-standard, experimental methods. They may be removed or changed without warning."}};sc.default=ac;var cc={},dc={},uc=Ps&&Ps.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dc,"__esModule",{value:!0}),dc.createRpcWarningMiddleware=void 0;const hc=uc(sc);dc.createRpcWarningMiddleware=function(e){const t={ethDecryptDeprecation:!1,ethGetEncryptionPublicKeyDeprecation:!1};return(n,r,i)=>{!1===t.ethDecryptDeprecation&&"eth_decrypt"===n.method?(e.warn(hc.default.warnings.rpc.ethDecryptDeprecation),t.ethDecryptDeprecation=!0):!1===t.ethGetEncryptionPublicKeyDeprecation&&"eth_getEncryptionPublicKey"===n.method&&(e.warn(hc.default.warnings.rpc.ethGetEncryptionPublicKeyDeprecation),t.ethGetEncryptionPublicKeyDeprecation=!0),i()}},Object.defineProperty(cc,"__esModule",{value:!0}),cc.NOOP=cc.isValidNetworkVersion=cc.isValidChainId=cc.getRpcPromiseCallback=cc.getDefaultExternalMiddleware=cc.EMITTED_NOTIFICATIONS=void 0;const fc=qa,lc=ha,Ac=dc;cc.EMITTED_NOTIFICATIONS=Object.freeze(["eth_subscription"]);cc.getDefaultExternalMiddleware=(e=console)=>{return[fc.createIdRemapMiddleware(),(t=e,(e,n,r)=>{"string"==typeof e.method&&e.method||(n.error=lc.ethErrors.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:e})),r((e=>{const{error:r}=n;return r?(t.error(`MetaMask - RPC Error: ${r.message}`,r),e()):e()}))}),Ac.createRpcWarningMiddleware(e)];var t};cc.getRpcPromiseCallback=(e,t,n=!0)=>(r,i)=>{r||i.error?t(r||i.error):!n||Array.isArray(i)?e(i):e(i.result)};cc.isValidChainId=e=>Boolean(e)&&"string"==typeof e&&e.startsWith("0x");cc.isValidNetworkVersion=e=>Boolean(e)&&"string"==typeof e;cc.NOOP=()=>{};var pc=Ps&&Ps.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(sa,"__esModule",{value:!0}),sa.BaseProvider=void 0;const bc=pc(aa),mc=ha,gc=pc((function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var r,i,o,s=ja(t),a=ja(n);if(s&&a){if((i=t.length)!=n.length)return!1;for(r=i;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(s!=a)return!1;var c=t instanceof Date,d=n instanceof Date;if(c!=d)return!1;if(c&&d)return t.getTime()==n.getTime();var u=t instanceof RegExp,h=n instanceof RegExp;if(u!=h)return!1;if(u&&h)return t.toString()==n.toString();var f=Fa(t);if((i=f.length)!==Fa(n).length)return!1;for(r=i;0!=r--;)if(!Ka.call(n,f[r]))return!1;for(r=i;0!=r--;)if(!e(t[o=f[r]],n[o]))return!1;return!0}return t!=t&&n!=n})),vc=qa,yc=pc(sc),wc=cc;class _c extends bc.default{constructor({logger:e=console,maxEventListeners:t=100,rpcMiddleware:n=[]}={}){super(),this._log=e,this.setMaxListeners(t),this._state=Object.assign({},_c._defaultState),this.selectedAddress=null,this.chainId=null,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleConnect=this._handleConnect.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this.request=this.request.bind(this);const r=new vc.JsonRpcEngine;n.forEach((e=>r.push(e))),this._rpcEngine=r}isConnected(){return this._state.isConnected}async request(e){if(!e||"object"!=typeof e||Array.isArray(e))throw mc.ethErrors.rpc.invalidRequest({message:yc.default.errors.invalidRequestArgs(),data:e});const{method:t,params:n}=e;if("string"!=typeof t||0===t.length)throw mc.ethErrors.rpc.invalidRequest({message:yc.default.errors.invalidRequestMethod(),data:e});if(void 0!==n&&!Array.isArray(n)&&("object"!=typeof n||null===n))throw mc.ethErrors.rpc.invalidRequest({message:yc.default.errors.invalidRequestParams(),data:e});return new Promise(((e,r)=>{this._rpcRequest({method:t,params:n},wc.getRpcPromiseCallback(e,r))}))}_initializeState(e){if(!0===this._state.initialized)throw new Error("Provider already initialized.");if(e){const{accounts:t,chainId:n,isUnlocked:r,networkVersion:i}=e;this._handleConnect(n),this._handleChainChanged({chainId:n,networkVersion:i}),this._handleUnlockStateChanged({accounts:t,isUnlocked:r}),this._handleAccountsChanged(t)}this._state.initialized=!0,this.emit("_initialized")}_rpcRequest(e,t){let n=t;return Array.isArray(e)||(e.jsonrpc||(e.jsonrpc="2.0"),"eth_accounts"!==e.method&&"eth_requestAccounts"!==e.method||(n=(n,r)=>{this._handleAccountsChanged(r.result||[],"eth_accounts"===e.method),t(n,r)})),this._rpcEngine.handle(e,n)}_handleConnect(e){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:e}),this._log.debug(yc.default.info.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){let n;this._state.isConnected=!1,e?(n=new mc.EthereumRpcError(1013,t||yc.default.errors.disconnected()),this._log.debug(n)):(n=new mc.EthereumRpcError(1011,t||yc.default.errors.permanentlyDisconnected()),this._log.error(n),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",n)}}_handleChainChanged({chainId:e}={}){wc.isValidChainId(e)?(this._handleConnect(e),e!==this.chainId&&(this.chainId=e,this._state.initialized&&this.emit("chainChanged",this.chainId))):this._log.error(yc.default.errors.invalidNetworkParams(),{chainId:e})}_handleAccountsChanged(e,t=!1){let n=e;Array.isArray(e)||(this._log.error("MetaMask: Received invalid accounts parameter. Please report this bug.",e),n=[]);for(const t of e)if("string"!=typeof t){this._log.error("MetaMask: Received non-string account. Please report this bug.",e),n=[];break}gc.default(this._state.accounts,n)||(t&&null!==this._state.accounts&&this._log.error("MetaMask: 'eth_accounts' unexpectedly updated accounts. Please report this bug.",n),this._state.accounts=n,this.selectedAddress!==n[0]&&(this.selectedAddress=n[0]||null),this._state.initialized&&this.emit("accountsChanged",n))}_handleUnlockStateChanged({accounts:e,isUnlocked:t}={}){"boolean"==typeof t?t!==this._state.isUnlocked&&(this._state.isUnlocked=t,this._handleAccountsChanged(e||[])):this._log.error("MetaMask: Received invalid isUnlocked parameter. Please report this bug.")}}sa.BaseProvider=_c,_c._defaultState={accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1};var Mc={},Ec={};Object.defineProperty(Ec,"__esModule",{value:!0});const Sc=i;class kc extends Sc.Duplex{constructor(e){super({objectMode:!0}),this._port=e,this._port.onMessage.addListener((e=>this._onMessage(e))),this._port.onDisconnect.addListener((()=>this._onDisconnect())),this._log=()=>null}_onMessage(e){if(Buffer.isBuffer(e)){const t=Buffer.from(e);this._log(t,!1),this.push(t)}else this._log(e,!1),this.push(e)}_onDisconnect(){this.destroy()}_read(){}_write(e,t,n){try{if(Buffer.isBuffer(e)){const t=e.toJSON();t._isBuffer=!0,this._log(t,!0),this._port.postMessage(t)}else this._log(e,!0),this._port.postMessage(e)}catch(e){return n(new Error("PortDuplexStream - disconnected"))}return n()}_setLogger(e){this._log=e}}Ec.default=kc;var Cc={},Ic=Ps&&Ps.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.getNodeVersion=Cc.detectOS=Cc.parseUserAgent=Cc.browserName=Cc.detect=Cc.ReactNativeInfo=Cc.BotInfo=Cc.SearchBotDeviceInfo=Cc.NodeInfo=Cc.BrowserInfo=void 0;var xc=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"};Cc.BrowserInfo=xc;var Oc=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform};Cc.NodeInfo=Oc;var Rc=function(e,t,n,r){this.name=e,this.version=t,this.os=n,this.bot=r,this.type="bot-device"};Cc.SearchBotDeviceInfo=Rc;var Pc=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null};Cc.BotInfo=Pc;var Tc=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null};Cc.ReactNativeInfo=Tc;var Nc=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Lc=3,Bc=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],Dc=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function jc(e){return""!==e&&Bc.reduce((function(t,n){var r=n[0],i=n[1];if(t)return t;var o=i.exec(e);return!!o&&[r,o]}),!1)}function Fc(e){var t=jc(e);if(!t)return null;var n=t[0],r=t[1];if("searchbot"===n)return new Pc;var i=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);i?i.length<Lc&&(i=Ic(Ic([],i,!0),function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(Lc-i.length),!0)):i=[];var o=i.join("."),s=Kc(e),a=Nc.exec(e);return a&&a[1]?new Rc(n,o,s,a[1]):new xc(n,o,s)}function Kc(e){for(var t=0,n=Dc.length;t<n;t++){var r=Dc[t],i=r[0];if(r[1].exec(e))return i}return null}function qc(){return"undefined"!=typeof process&&process.version?new Oc(process.version.slice(1)):null}Cc.detect=function(e){return e?Fc(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new Tc:"undefined"!=typeof navigator?Fc(navigator.userAgent):qc()},Cc.browserName=function(e){var t=jc(e);return t?t[0]:null},Cc.parseUserAgent=Fc,Cc.detectOS=Kc,Cc.getNodeVersion=qc;var zc={},Vc={},Wc=Ps&&Ps.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.sendSiteMetadata=void 0;const Uc=Wc(sc),Qc=cc;function Hc(e){const{document:t}=e,n=t.querySelector('head > meta[property="og:site_name"]');if(n)return n.content;const r=t.querySelector('head > meta[name="title"]');return r?r.content:t.title&&t.title.length>0?t.title:window.location.hostname}async function Yc(e){const{document:t}=e,n=t.querySelectorAll('head > link[rel~="icon"]');for(const e of n)if(e&&await $c(e.href))return e.href;return null}function $c(e){return new Promise(((t,n)=>{try{const n=document.createElement("img");n.onload=()=>t(!0),n.onerror=()=>t(!1),n.src=e}catch(e){n(e)}}))}Vc.sendSiteMetadata=async function(e,t){try{const t=await async function(){return{name:Hc(window),icon:await Yc(window)}}();e.handle({jsonrpc:"2.0",id:1,method:"metamask_sendDomainMetadata",params:t},Qc.NOOP)}catch(e){t.error({message:Uc.default.errors.sendSiteMetadata(),originalError:e})}};var Gc={},Zc={},Jc={exports:{}},Xc={exports:{}};"undefined"==typeof process||!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?Xc.exports={nextTick:function(e,t,n,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,o,s=arguments.length;switch(s){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick((function(){e.call(null,t)}));case 3:return process.nextTick((function(){e.call(null,t,n)}));case 4:return process.nextTick((function(){e.call(null,t,n,r)}));default:for(i=new Array(s-1),o=0;o<i.length;)i[o++]=arguments[o];return process.nextTick((function(){e.apply(null,i)}))}}}:Xc.exports=process;var ed=Xc.exports,td={}.toString,nd=Array.isArray||function(e){return"[object Array]"==td.call(e)},rd=r.EventEmitter,id={exports:{}};!function(t,n){var r=e,i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,n),n.Buffer=s),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(id,id.exports);var od=id.exports,sd={};function ad(e){return Object.prototype.toString.call(e)}sd.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===ad(e)},sd.isBoolean=function(e){return"boolean"==typeof e},sd.isNull=function(e){return null===e},sd.isNullOrUndefined=function(e){return null==e},sd.isNumber=function(e){return"number"==typeof e},sd.isString=function(e){return"string"==typeof e},sd.isSymbol=function(e){return"symbol"==typeof e},sd.isUndefined=function(e){return void 0===e},sd.isRegExp=function(e){return"[object RegExp]"===ad(e)},sd.isObject=function(e){return"object"==typeof e&&null!==e},sd.isDate=function(e){return"[object Date]"===ad(e)},sd.isError=function(e){return"[object Error]"===ad(e)||e instanceof Error},sd.isFunction=function(e){return"function"==typeof e},sd.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},sd.isBuffer=e.Buffer.isBuffer;var cd={exports:{}};"function"==typeof Object.create?cd.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:cd.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}};var dd,ud=cd.exports,hd=Ns(Object.freeze({__proto__:null,default:{}})),fd={exports:{}};function ld(){return dd||(dd=1,function(e){var t=od.Buffer,n=hd;e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return t.alloc(0);for(var n,r,i,o=t.allocUnsafe(e>>>0),s=this.head,a=0;s;)n=s.data,r=o,i=a,n.copy(r,i),a+=s.data.length,s=s.next;return o},e}(),n&&n.inspect&&n.inspect.custom&&(e.exports.prototype[n.inspect.custom]=function(){var e=n.inspect({length:this.length});return this.constructor.name+" "+e})}(fd)),fd.exports}var Ad=ed;function pd(e,t){e.emit("error",t)}var bd,md,gd,vd,yd={destroy:function(e,t){var n=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Ad.nextTick(pd,this,e)):Ad.nextTick(pd,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?n._writableState?n._writableState.errorEmitted||(n._writableState.errorEmitted=!0,Ad.nextTick(pd,n,e)):Ad.nextTick(pd,n,e):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}},wd=function(e,t){if(_d("noDeprecation"))return e;var n=!1;return function(){if(!n){if(_d("throwDeprecation"))throw new Error(t);_d("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}};function _d(e){try{if(!Ps.localStorage)return!1}catch(e){return!1}var t=Ps.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}function Md(){if(md)return bd;md=1;var e=ed;function t(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}bd=l;var n,r=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:e.nextTick;l.WritableState=f;var i=Object.create(sd);i.inherits=ud;var o={deprecate:wd},s=rd,a=od.Buffer,c=(void 0!==Ps?Ps:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var d,u=yd;function h(){}function f(i,o){n=n||Ed(),i=i||{};var s=o instanceof n;this.objectMode=!!i.objectMode,s&&(this.objectMode=this.objectMode||!!i.writableObjectMode);var a=i.highWaterMark,c=i.writableHighWaterMark,d=this.objectMode?16:16384;this.highWaterMark=a||0===a?a:s&&(c||0===c)?c:d,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===i.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=i.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,n){var i=t._writableState,o=i.sync,s=i.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),n)!function(t,n,r,i,o){--n.pendingcb,r?(e.nextTick(o,i),e.nextTick(v,t,n),t._writableState.errorEmitted=!0,t.emit("error",i)):(o(i),t._writableState.errorEmitted=!0,t.emit("error",i),v(t,n))}(t,i,o,n,s);else{var a=m(i);a||i.corked||i.bufferProcessing||!i.bufferedRequest||b(t,i),o?r(p,t,i,a,s):p(t,i,a,s)}}(o,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}function l(e){if(n=n||Ed(),!(d.call(l,this)||this instanceof n))return new l(e);this._writableState=new f(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),s.call(this)}function A(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function p(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),v(e,t)}function b(e,n){n.bufferProcessing=!0;var r=n.bufferedRequest;if(e._writev&&r&&r.next){var i=n.bufferedRequestCount,o=new Array(i),s=n.corkedRequestsFree;s.entry=r;for(var a=0,c=!0;r;)o[a]=r,r.isBuf||(c=!1),r=r.next,a+=1;o.allBuffers=c,A(e,n,!0,n.length,o,"",s.finish),n.pendingcb++,n.lastBufferedRequest=null,s.next?(n.corkedRequestsFree=s.next,s.next=null):n.corkedRequestsFree=new t(n),n.bufferedRequestCount=0}else{for(;r;){var d=r.chunk,u=r.encoding,h=r.callback;if(A(e,n,!1,n.objectMode?1:d.length,d,u,h),r=r.next,n.bufferedRequestCount--,n.writing)break}null===r&&(n.lastBufferedRequest=null)}n.bufferedRequest=r,n.bufferProcessing=!1}function m(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function g(e,t){e._final((function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),v(e,t)}))}function v(t,n){var r=m(n);return r&&(!function(t,n){n.prefinished||n.finalCalled||("function"==typeof t._final?(n.pendingcb++,n.finalCalled=!0,e.nextTick(g,t,n)):(n.prefinished=!0,t.emit("prefinish")))}(t,n),0===n.pendingcb&&(n.finished=!0,t.emit("finish"))),r}return i.inherits(l,s),f.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(f.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(l,Symbol.hasInstance,{value:function(e){return!!d.call(this,e)||this===l&&(e&&e._writableState instanceof f)}})):d=function(e){return e instanceof this},l.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},l.prototype.write=function(t,n,r){var i,o=this._writableState,s=!1,d=!o.objectMode&&(i=t,a.isBuffer(i)||i instanceof c);return d&&!a.isBuffer(t)&&(t=function(e){return a.from(e)}(t)),"function"==typeof n&&(r=n,n=null),d?n="buffer":n||(n=o.defaultEncoding),"function"!=typeof r&&(r=h),o.ended?function(t,n){var r=new Error("write after end");t.emit("error",r),e.nextTick(n,r)}(this,r):(d||function(t,n,r,i){var o=!0,s=!1;return null===r?s=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||n.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),e.nextTick(i,s),o=!1),o}(this,o,t,r))&&(o.pendingcb++,s=function(e,t,n,r,i,o){if(!n){var s=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=a.from(t,n));return t}(t,r,i);r!==s&&(n=!0,i="buffer",r=s)}var c=t.objectMode?1:r.length;t.length+=c;var d=t.length<t.highWaterMark;d||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else A(e,t,!1,c,r,i,o);return d}(this,o,d,t,n,r)),s},l.prototype.cork=function(){this._writableState.corked++},l.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||b(this,e))},l.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),l.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},l.prototype._writev=null,l.prototype.end=function(t,n,r){var i=this._writableState;"function"==typeof t?(r=t,t=null,n=null):"function"==typeof n&&(r=n,n=null),null!=t&&this.write(t,n),i.corked&&(i.corked=1,this.uncork()),i.ending||function(t,n,r){n.ending=!0,v(t,n),r&&(n.finished?e.nextTick(r):t.once("finish",r));n.ended=!0,t.writable=!1}(this,i,r)},Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),l.prototype.destroy=u.destroy,l.prototype._undestroy=u.undestroy,l.prototype._destroy=function(e,t){this.end(),t(e)},bd}function Ed(){if(vd)return gd;vd=1;var e=ed,t=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};gd=c;var n=Object.create(sd);n.inherits=ud;var r=Od(),i=Md();n.inherits(c,r);for(var o=t(i.prototype),s=0;s<o.length;s++){var a=o[s];c.prototype[a]||(c.prototype[a]=i.prototype[a])}function c(e){if(!(this instanceof c))return new c(e);r.call(this,e),i.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||e.nextTick(u,this)}function u(e){e.end()}return Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),c.prototype._destroy=function(t,n){this.push(null),this.end(),e.nextTick(n,t)},gd}var Sd,kd,Cd,Id={};function xd(){if(Sd)return Id;Sd=1;var e=od.Buffer,t=e.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(n){var r;switch(this.encoding=function(n){var r=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(n);if("string"!=typeof r&&(e.isEncoding===t||!t(n)))throw new Error("Unknown encoding: "+n);return r||n}(n),this.encoding){case"utf16le":this.text=o,this.end=s,r=4;break;case"utf8":this.fillLast=i,r=4;break;case"base64":this.text=a,this.end=c,r=3;break;default:return this.write=d,void(this.end=u)}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(r)}function r(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function i(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function o(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function s(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function a(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function c(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function u(e){return e&&e.length?this.write(e):""}return Id.StringDecoder=n,n.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},n.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},n.prototype.text=function(e,t){var n=function(e,t,n){var i=t.length-1;if(i<n)return 0;var o=r(t[i]);if(o>=0)return o>0&&(e.lastNeed=o-1),o;if(--i<n||-2===o)return 0;if(o=r(t[i]),o>=0)return o>0&&(e.lastNeed=o-2),o;if(--i<n||-2===o)return 0;if(o=r(t[i]),o>=0)return o>0&&(2===o?o=0:e.lastNeed=o-3),o;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},n.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length},Id}function Od(){if(Cd)return kd;Cd=1;var e=ed;kd=b;var t,n=nd;b.ReadableState=p,r.EventEmitter;var i=function(e,t){return e.listeners(t).length},o=rd,s=od.Buffer,a=(void 0!==Ps?Ps:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var c=Object.create(sd);c.inherits=ud;var d=hd,u=void 0;u=d&&d.debuglog?d.debuglog("stream"):function(){};var h,f=ld(),l=yd;c.inherits(b,o);var A=["error","close","destroy","pause","resume"];function p(e,n){e=e||{};var r=n instanceof(t=t||Ed());this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,o=e.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(o||0===o)?o:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=xd().StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function b(e){if(t=t||Ed(),!(this instanceof b))return new b(e);this._readableState=new p(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function m(e,t,n,r,i){var o,c=e._readableState;null===t?(c.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,w(e)}(e,c)):(i||(o=function(e,t){var n;r=t,s.isBuffer(r)||r instanceof a||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var r;return n}(c,t)),o?e.emit("error",o):c.objectMode||t&&t.length>0?("string"==typeof t||c.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),r?c.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):g(e,c,t,!0):c.ended?e.emit("error",new Error("stream.push() after EOF")):(c.reading=!1,c.decoder&&!n?(t=c.decoder.write(t),c.objectMode||0!==t.length?g(e,c,t,!1):M(e,c)):g(e,c,t,!1))):r||(c.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(c)}function g(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&w(e)),M(e,t)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),b.prototype.destroy=l.destroy,b.prototype._undestroy=l.undestroy,b.prototype._destroy=function(e,t){this.push(null),t(e)},b.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=s.from(e,t),t=""),n=!0),m(this,e,t,!1,n)},b.prototype.unshift=function(e){return m(this,e,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(e){return h||(h=xd().StringDecoder),this._readableState.decoder=new h(e),this._readableState.encoding=e,this};var v=8388608;function y(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=v?e=v:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function w(t){var n=t._readableState;n.needReadable=!1,n.emittedReadable||(u("emitReadable",n.flowing),n.emittedReadable=!0,n.sync?e.nextTick(_,t):_(t))}function _(e){u("emit readable"),e.emit("readable"),C(e)}function M(t,n){n.readingMore||(n.readingMore=!0,e.nextTick(E,t,n))}function E(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(u("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function S(e){u("readable nexttick read 0"),e.read(0)}function k(e,t){t.reading||(u("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),C(e),t.flowing&&!t.reading&&e.read(0)}function C(e){var t=e._readableState;for(u("flow",t.flowing);t.flowing&&null!==e.read(););}function I(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(s===o.length?i+=o:i+=o.slice(0,e),0===(e-=s)){s===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=s.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,a),0===(e-=a)){a===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++i}return t.length-=i,n}(e,t);return r}(e,t.buffer,t.decoder),n);var n}function x(t){var n=t._readableState;if(n.length>0)throw new Error('"endReadable()" called on non-empty stream');n.endEmitted||(n.ended=!0,e.nextTick(O,n,t))}function O(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function R(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}return b.prototype.read=function(e){u("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return u("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?x(this):w(this),null;if(0===(e=y(e,t))&&t.ended)return 0===t.length&&x(this),null;var r,i=t.needReadable;return u("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&u("length less than watermark",i=!0),t.ended||t.reading?u("reading or ended",i=!1):i&&(u("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=y(n,t))),null===(r=e>0?I(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&x(this)),null!==r&&this.emit("data",r),r},b.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(t,r){var o=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=t;break;case 1:s.pipes=[s.pipes,t];break;default:s.pipes.push(t)}s.pipesCount+=1,u("pipe count=%d opts=%j",s.pipesCount,r);var a=(!r||!1!==r.end)&&t!==process.stdout&&t!==process.stderr?d:g;function c(e,n){u("onunpipe"),e===o&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,u("cleanup"),t.removeListener("close",b),t.removeListener("finish",m),t.removeListener("drain",h),t.removeListener("error",p),t.removeListener("unpipe",c),o.removeListener("end",d),o.removeListener("end",g),o.removeListener("data",A),f=!0,!s.awaitDrain||t._writableState&&!t._writableState.needDrain||h())}function d(){u("onend"),t.end()}s.endEmitted?e.nextTick(a):o.once("end",a),t.on("unpipe",c);var h=function(e){return function(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,C(e))}}(o);t.on("drain",h);var f=!1;var l=!1;function A(e){u("ondata"),l=!1,!1!==t.write(e)||l||((1===s.pipesCount&&s.pipes===t||s.pipesCount>1&&-1!==R(s.pipes,t))&&!f&&(u("false write response, pause",s.awaitDrain),s.awaitDrain++,l=!0),o.pause())}function p(e){u("onerror",e),g(),t.removeListener("error",p),0===i(t,"error")&&t.emit("error",e)}function b(){t.removeListener("finish",m),g()}function m(){u("onfinish"),t.removeListener("close",b),g()}function g(){u("unpipe"),o.unpipe(t)}return o.on("data",A),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?n(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(t,"error",p),t.once("close",b),t.once("finish",m),t.emit("pipe",o),s.flowing||(u("pipe resume"),o.resume()),t},b.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=R(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},b.prototype.on=function(t,n){var r=o.prototype.on.call(this,t,n);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&w(this):e.nextTick(S,this))}return r},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var t=this._readableState;return t.flowing||(u("resume"),t.flowing=!0,function(t,n){n.resumeScheduled||(n.resumeScheduled=!0,e.nextTick(k,t,n))}(this,t)),this},b.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(u("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(u("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<A.length;o++)e.on(A[o],this.emit.bind(this,A[o]));return this._read=function(t){u("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=I,kd}var Rd=Ld,Pd=Ed(),Td=Object.create(sd);function Nd(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Ld(e){if(!(this instanceof Ld))return new Ld(e);Pd.call(this,e),this._transformState={afterTransform:Nd.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",Bd)}function Bd(){var e=this;"function"==typeof this._flush?this._flush((function(t,n){Dd(e,t,n)})):Dd(this,null,null)}function Dd(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}Td.inherits=ud,Td.inherits(Ld,Pd),Ld.prototype.push=function(e,t){return this._transformState.needTransform=!1,Pd.prototype.push.call(this,e,t)},Ld.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},Ld.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Ld.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Ld.prototype._destroy=function(e,t){var n=this;Pd.prototype._destroy.call(this,e,(function(e){t(e),n.emit("close")}))};var jd=qd,Fd=Rd,Kd=Object.create(sd);function qd(e){if(!(this instanceof qd))return new qd(e);Fd.call(this,e)}Kd.inherits=ud,Kd.inherits(qd,Fd),qd.prototype._transform=function(e,t,n){n(null,e)},function(e,t){(t=Jc.exports=Od()).Stream=t,t.Readable=t,t.Writable=Md(),t.Duplex=Ed(),t.Transform=Rd,t.PassThrough=jd}(0,Jc.exports);var zd=Jc.exports,Vd={exports:{}},Wd=function e(t,n){if(t&&n)return e(t)(n);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){r[e]=t[e]})),r;function r(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];var r=t.apply(this,e),i=e[e.length-1];return"function"==typeof r&&r!==i&&Object.keys(i).forEach((function(e){r[e]=i[e]})),r}};var Ud=Wd;function Qd(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function Hd(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},n=e.name||"Function wrapped with `once`";return t.onceError=n+" shouldn't be called more than once",t.called=!1,t}Vd.exports=Ud(Qd),Vd.exports.strict=Ud(Hd),Qd.proto=Qd((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Qd(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Hd(this)},configurable:!0})}));var Yd=Vd.exports,$d=Yd,Gd=function(){},Zd=function(e,t,n){if("function"==typeof t)return Zd(e,null,t);t||(t={}),n=$d(n||Gd);var r=e._writableState,i=e._readableState,o=t.readable||!1!==t.readable&&e.readable,s=t.writable||!1!==t.writable&&e.writable,a=!1,c=function(){e.writable||d()},d=function(){s=!1,o||n.call(e)},u=function(){o=!1,s||n.call(e)},h=function(t){n.call(e,t?new Error("exited with error code: "+t):null)},f=function(t){n.call(e,t)},l=function(){process.nextTick(A)},A=function(){if(!a)return(!o||i&&i.ended&&!i.destroyed)&&(!s||r&&r.ended&&!r.destroyed)?void 0:n.call(e,new Error("premature close"))},p=function(){e.req.on("finish",d)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(e)?s&&!r&&(e.on("end",c),e.on("close",c)):(e.on("complete",d),e.on("abort",l),e.req?p():e.on("request",p)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(e)&&e.on("exit",h),e.on("end",u),e.on("finish",d),!1!==t.error&&e.on("error",f),e.on("close",l),function(){a=!0,e.removeListener("complete",d),e.removeListener("abort",l),e.removeListener("request",p),e.req&&e.req.removeListener("finish",d),e.removeListener("end",c),e.removeListener("close",c),e.removeListener("finish",d),e.removeListener("exit",h),e.removeListener("end",u),e.removeListener("error",f),e.removeListener("close",l)}},Jd=Zd,Xd={};Object.defineProperty(Xd,"__esModule",{value:!0}),Xd.Substream=void 0;const eu=zd;class tu extends eu.Duplex{constructor({parent:e,name:t}){super({objectMode:!0}),this._parent=e,this._name=t}_read(){}_write(e,t,n){this._parent.push({name:this._name,data:e}),n()}}Xd.Substream=tu;var nu=Ps&&Ps.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Zc,"__esModule",{value:!0}),Zc.ObjectMultiplex=void 0;const ru=zd,iu=nu(Jd),ou=nu(Yd),su=Xd,au=Symbol("IGNORE_SUBSTREAM");class cu extends ru.Duplex{constructor(e={}){super(Object.assign(Object.assign({},e),{objectMode:!0})),this._substreams={}}createStream(e){if(this.destroyed)throw new Error(`ObjectMultiplex - parent stream for name "${e}" already destroyed`);if(this._readableState.ended||this._writableState.ended)throw new Error(`ObjectMultiplex - parent stream for name "${e}" already ended`);if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error(`ObjectMultiplex - Substream for name "${e}" already exists`);const t=new su.Substream({parent:this,name:e});return this._substreams[e]=t,function(e,t){const n=ou.default(t);iu.default(e,{readable:!1},n),iu.default(e,{writable:!1},n)}(this,(e=>t.destroy(e||void 0))),t}ignoreStream(e){if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error(`ObjectMultiplex - Substream for name "${e}" already exists`);this._substreams[e]=au}_read(){}_write(e,t,n){const{name:r,data:i}=e;if(!r)return console.warn(`ObjectMultiplex - malformed chunk without name "${e}"`),n();const o=this._substreams[r];return o?(o!==au&&o.push(i),n()):(console.warn(`ObjectMultiplex - orphaned data for stream "${r}"`),n())}}Zc.ObjectMultiplex=cu;var du=Zc.ObjectMultiplex;const uu=e=>null!==e&&"object"==typeof e&&"function"==typeof e.pipe;uu.writable=e=>uu(e)&&!1!==e.writable&&"function"==typeof e._write&&"object"==typeof e._writableState,uu.readable=e=>uu(e)&&!1!==e.readable&&"function"==typeof e._read&&"object"==typeof e._readableState,uu.duplex=e=>uu.writable(e)&&uu.readable(e),uu.transform=e=>uu.duplex(e)&&"function"==typeof e._transform;var hu=uu,fu={},lu={};Object.defineProperty(lu,"__esModule",{value:!0});const Au=zd;lu.default=function(e){if(!e||!e.engine)throw new Error("Missing engine parameter!");const{engine:t}=e,n=new Au.Duplex({objectMode:!0,read:()=>{},write:function(e,r,i){t.handle(e,((e,t)=>{n.push(t)})),i()}});return t.on&&t.on("notification",(e=>{n.push(e)})),n};var pu={},bu={};Object.defineProperty(bu,"__esModule",{value:!0});const mu=r;function gu(e,t,n){try{Reflect.apply(e,t,n)}catch(e){setTimeout((()=>{throw e}))}}class vu extends mu.EventEmitter{emit(e,...t){let n="error"===e;const r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){let e;if(t.length>0&&([e]=t),e instanceof Error)throw e;const n=new Error("Unhandled error."+(e?` (${e.message})`:""));throw n.context=e,n}const i=r[e];if(void 0===i)return!1;if("function"==typeof i)gu(i,this,t);else{const e=i.length,n=function(e){const t=e.length,n=new Array(t);for(let r=0;r<t;r+=1)n[r]=e[r];return n}(i);for(let r=0;r<e;r+=1)gu(n[r],this,t)}return!0}}bu.default=vu;var yu=Ps&&Ps.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pu,"__esModule",{value:!0});const wu=yu(bu),_u=zd;pu.default=function(e={}){const t={},n=new _u.Duplex({objectMode:!0,read:()=>{},write:function(n,o,s){let a=null;try{!n.id?function(n){(null==e?void 0:e.retryOnMessage)&&n.method===e.retryOnMessage&&Object.values(t).forEach((({req:e,retryCount:n=0})=>{if(e.id){if(n>=3)throw new Error(`StreamMiddleware - Retry limit exceeded for request id "${e.id}"`);t[e.id].retryCount=n+1,i(e)}}));r.emit("notification",n)}(n):function(e){const n=t[e.id];if(!n)return void console.warn(`StreamMiddleware - Unknown response id "${e.id}"`);delete t[e.id],Object.assign(n.res,e),setTimeout(n.end)}(n)}catch(e){a=e}s(a)}}),r=new wu.default;return{events:r,middleware:(e,n,r,o)=>{t[e.id]={req:e,res:n,next:r,end:o},i(e)},stream:n};function i(e){n.push(e)}};var Mu=Ps&&Ps.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fu,"__esModule",{value:!0}),fu.createStreamMiddleware=fu.createEngineStream=void 0;const Eu=Mu(lu);fu.createEngineStream=Eu.default;const Su=Mu(pu);fu.createStreamMiddleware=Su.default;var ku=Yd,Cu=Jd,Iu=hd,xu=function(){},Ou=/^v?\.0/.test(process.version),Ru=function(e){return"function"==typeof e},Pu=function(e,t,n,r){r=ku(r);var i=!1;e.on("close",(function(){i=!0})),Cu(e,{readable:t,writable:n},(function(e){if(e)return r(e);i=!0,r()}));var o=!1;return function(t){if(!i&&!o)return o=!0,function(e){return!!Ou&&!!Iu&&(e instanceof(Iu.ReadStream||xu)||e instanceof(Iu.WriteStream||xu))&&Ru(e.close)}(e)?e.close(xu):function(e){return e.setHeader&&Ru(e.abort)}(e)?e.abort():Ru(e.destroy)?e.destroy():void r(t||new Error("stream was destroyed"))}},Tu=function(e){e()},Nu=function(e,t){return e.pipe(t)},Lu=function(){var e,t=Array.prototype.slice.call(arguments),n=Ru(t[t.length-1]||xu)&&t.pop()||xu;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var r=t.map((function(i,o){var s=o<t.length-1;return Pu(i,s,o>0,(function(t){e||(e=t),t&&r.forEach(Tu),s||(r.forEach(Tu),n(e))}))}));return t.reduce(Nu)},Bu=Ps&&Ps.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gc,"__esModule",{value:!0}),Gc.StreamProvider=Gc.AbstractStreamProvider=void 0;const Du=Bu(du),ju=hu,Fu=fu,Ku=Bu(Lu),qu=Bu(sc),zu=cc,Vu=sa;class Wu extends Vu.BaseProvider{constructor(e,{jsonRpcStreamName:t,logger:n,maxEventListeners:r,rpcMiddleware:i}){if(super({logger:n,maxEventListeners:r,rpcMiddleware:i}),!ju.duplex(e))throw new Error(qu.default.errors.invalidDuplexStream());this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this);const o=new Du.default;Ku.default(e,o,e,this._handleStreamDisconnect.bind(this,"MetaMask")),this._jsonRpcConnection=Fu.createStreamMiddleware({retryOnMessage:"METAMASK_EXTENSION_CONNECT_CAN_RETRY"}),Ku.default(this._jsonRpcConnection.stream,o.createStream(t),this._jsonRpcConnection.stream,this._handleStreamDisconnect.bind(this,"MetaMask RpcProvider")),this._rpcEngine.push(this._jsonRpcConnection.middleware),this._jsonRpcConnection.events.on("notification",(t=>{const{method:n,params:r}=t;"metamask_accountsChanged"===n?this._handleAccountsChanged(r):"metamask_unlockStateChanged"===n?this._handleUnlockStateChanged(r):"metamask_chainChanged"===n?this._handleChainChanged(r):zu.EMITTED_NOTIFICATIONS.includes(n)?this.emit("message",{type:n,data:r}):"METAMASK_STREAM_FAILURE"===n&&e.destroy(new Error(qu.default.errors.permanentlyDisconnected()))}))}async _initializeStateAsync(){let e;try{e=await this.request({method:"metamask_getProviderState"})}catch(e){this._log.error("MetaMask: Failed to get initial state. Please report this bug.",e)}this._initializeState(e)}_handleStreamDisconnect(e,t){let n=`MetaMask: Lost connection to "${e}".`;(null==t?void 0:t.stack)&&(n+=`\n${t.stack}`),this._log.warn(n),this.listenerCount("error")>0&&this.emit("error",n),this._handleDisconnect(!1,t?t.message:void 0)}_handleChainChanged({chainId:e,networkVersion:t}={}){zu.isValidChainId(e)&&zu.isValidNetworkVersion(t)?"loading"===t?this._handleDisconnect(!0):super._handleChainChanged({chainId:e}):this._log.error(qu.default.errors.invalidNetworkParams(),{chainId:e,networkVersion:t})}}Gc.AbstractStreamProvider=Wu;Gc.StreamProvider=class extends Wu{async initialize(){return this._initializeStateAsync()}},function(e){var t=Ps&&Ps.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.MetaMaskInpageProvider=e.MetaMaskInpageProviderStreamName=void 0;const n=ha,r=Vc,i=t(sc),o=cc,s=Gc;e.MetaMaskInpageProviderStreamName="metamask-provider";class a extends s.AbstractStreamProvider{constructor(t,{jsonRpcStreamName:n=e.MetaMaskInpageProviderStreamName,logger:i=console,maxEventListeners:s,shouldSendMetadata:a}={}){if(super(t,{jsonRpcStreamName:n,logger:i,maxEventListeners:s,rpcMiddleware:o.getDefaultExternalMiddleware(i)}),this._sentWarnings={enable:!1,experimentalMethods:!1,send:!1,events:{close:!1,data:!1,networkChanged:!1,notification:!1}},this._initializeStateAsync(),this.networkVersion=null,this.isMetaMask=!0,this._sendSync=this._sendSync.bind(this),this.enable=this.enable.bind(this),this.send=this.send.bind(this),this.sendAsync=this.sendAsync.bind(this),this._warnOfDeprecation=this._warnOfDeprecation.bind(this),this._metamask=this._getExperimentalApi(),this._jsonRpcConnection.events.on("notification",(e=>{const{method:t}=e;o.EMITTED_NOTIFICATIONS.includes(t)&&(this.emit("data",e),this.emit("notification",e.params.result))})),a)if("complete"===document.readyState)r.sendSiteMetadata(this._rpcEngine,this._log);else{const e=()=>{r.sendSiteMetadata(this._rpcEngine,this._log),window.removeEventListener("DOMContentLoaded",e)};window.addEventListener("DOMContentLoaded",e)}}sendAsync(e,t){this._rpcRequest(e,t)}addListener(e,t){return this._warnOfDeprecation(e),super.addListener(e,t)}on(e,t){return this._warnOfDeprecation(e),super.on(e,t)}once(e,t){return this._warnOfDeprecation(e),super.once(e,t)}prependListener(e,t){return this._warnOfDeprecation(e),super.prependListener(e,t)}prependOnceListener(e,t){return this._warnOfDeprecation(e),super.prependOnceListener(e,t)}_handleDisconnect(e,t){super._handleDisconnect(e,t),this.networkVersion&&!e&&(this.networkVersion=null)}_warnOfDeprecation(e){var t;!1===(null===(t=this._sentWarnings)||void 0===t?void 0:t.events[e])&&(this._log.warn(i.default.warnings.events[e]),this._sentWarnings.events[e]=!0)}enable(){return this._sentWarnings.enable||(this._log.warn(i.default.warnings.enableDeprecation),this._sentWarnings.enable=!0),new Promise(((e,t)=>{try{this._rpcRequest({method:"eth_requestAccounts",params:[]},o.getRpcPromiseCallback(e,t))}catch(e){t(e)}}))}send(e,t){return this._sentWarnings.send||(this._log.warn(i.default.warnings.sendDeprecation),this._sentWarnings.send=!0),"string"!=typeof e||t&&!Array.isArray(t)?e&&"object"==typeof e&&"function"==typeof t?this._rpcRequest(e,t):this._sendSync(e):new Promise(((n,r)=>{try{this._rpcRequest({method:e,params:t},o.getRpcPromiseCallback(n,r,!1))}catch(e){r(e)}}))}_sendSync(e){let t;switch(e.method){case"eth_accounts":t=this.selectedAddress?[this.selectedAddress]:[];break;case"eth_coinbase":t=this.selectedAddress||null;break;case"eth_uninstallFilter":this._rpcRequest(e,o.NOOP),t=!0;break;case"net_version":t=this.networkVersion||null;break;default:throw new Error(i.default.errors.unsupportedSync(e.method))}return{id:e.id,jsonrpc:e.jsonrpc,result:t}}_getExperimentalApi(){return new Proxy({isUnlocked:async()=>(this._state.initialized||await new Promise((e=>{this.on("_initialized",(()=>e()))})),this._state.isUnlocked),requestBatch:async e=>{if(!Array.isArray(e))throw n.ethErrors.rpc.invalidRequest({message:"Batch requests must be made with an array of request objects.",data:e});return new Promise(((t,n)=>{this._rpcRequest(e,o.getRpcPromiseCallback(t,n))}))}},{get:(e,t,...n)=>(this._sentWarnings.experimentalMethods||(this._log.warn(i.default.warnings.experimentalMethods),this._sentWarnings.experimentalMethods=!0),Reflect.get(e,t,...n))})}_handleChainChanged({chainId:e,networkVersion:t}={}){super._handleChainChanged({chainId:e,networkVersion:t}),this._state.isConnected&&t!==this.networkVersion&&(this.networkVersion=t,this._state.initialized&&this.emit("networkChanged",this.networkVersion))}}e.MetaMaskInpageProvider=a}(zc);var Uu={CHROME_ID:"nkbihfbeogaeaoehlefnkodbefgpgknn",FIREFOX_ID:"webextension@metamask.io"},Qu=Ps&&Ps.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mc,"__esModule",{value:!0}),Mc.createExternalExtensionProvider=void 0;const Hu=Qu(Ec),Yu=Cc,$u=zc,Gu=Gc,Zu=cc,Ju=Qu(Uu),Xu=Yu.detect();Mc.createExternalExtensionProvider=function(){let e;try{const t=function(){switch(null==Xu?void 0:Xu.name){case"chrome":default:return Ju.default.CHROME_ID;case"firefox":return Ju.default.FIREFOX_ID}}(),n=chrome.runtime.connect(t),r=new Hu.default(n);e=new Gu.StreamProvider(r,{jsonRpcStreamName:$u.MetaMaskInpageProviderStreamName,logger:console,rpcMiddleware:Zu.getDefaultExternalMiddleware(console)}),e.initialize()}catch(e){throw console.dir("MetaMask connect error.",e),e}return e};var eh={},th={};Object.defineProperty(th,"__esModule",{value:!0}),th.shimWeb3=void 0,th.shimWeb3=function(e,t=console){let n=!1,r=!1;if(!window.web3){const i="__isMetaMaskShim__";let o={currentProvider:e};Object.defineProperty(o,i,{value:!0,enumerable:!0,configurable:!1,writable:!1}),o=new Proxy(o,{get:(o,s,...a)=>("currentProvider"!==s||n?"currentProvider"===s||s===i||r||(r=!0,t.error("MetaMask no longer injects web3. For details, see: https://docs.metamask.io/guide/provider-migration.html#replacing-window-web3"),e.request({method:"metamask_logWeb3ShimUsage"}).catch((e=>{t.debug("MetaMask: Failed to log web3 shim usage.",e)}))):(n=!0,t.warn("You are accessing the MetaMask window.web3.currentProvider shim. This property is deprecated; use window.ethereum instead. For details, see: https://docs.metamask.io/guide/provider-migration.html#replacing-window-web3")),Reflect.get(o,s,...a)),set:(...e)=>(t.warn("You are accessing the MetaMask window.web3 shim. This object is deprecated; use window.ethereum instead. For details, see: https://docs.metamask.io/guide/provider-migration.html#replacing-window-web3"),Reflect.set(...e))}),Object.defineProperty(window,"web3",{value:o,enumerable:!1,configurable:!0,writable:!0})}},Object.defineProperty(eh,"__esModule",{value:!0}),eh.setGlobalProvider=eh.initializeProvider=void 0;const nh=zc,rh=th;function ih(e){window.ethereum=e,window.dispatchEvent(new Event("ethereum#initialized"))}eh.initializeProvider=function({connectionStream:e,jsonRpcStreamName:t,logger:n=console,maxEventListeners:r=100,shouldSendMetadata:i=!0,shouldSetOnWindow:o=!0,shouldShimWeb3:s=!1}){const a=new nh.MetaMaskInpageProvider(e,{jsonRpcStreamName:t,logger:n,maxEventListeners:r,shouldSendMetadata:i}),c=new Proxy(a,{deleteProperty:()=>!0});return o&&ih(c),s&&rh.shimWeb3(c,n),c},eh.setGlobalProvider=ih,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StreamProvider=e.shimWeb3=e.setGlobalProvider=e.MetaMaskInpageProvider=e.MetaMaskInpageProviderStreamName=e.initializeProvider=e.createExternalExtensionProvider=e.BaseProvider=void 0;const t=sa;Object.defineProperty(e,"BaseProvider",{enumerable:!0,get:function(){return t.BaseProvider}});const n=Mc;Object.defineProperty(e,"createExternalExtensionProvider",{enumerable:!0,get:function(){return n.createExternalExtensionProvider}});const r=eh;Object.defineProperty(e,"initializeProvider",{enumerable:!0,get:function(){return r.initializeProvider}}),Object.defineProperty(e,"setGlobalProvider",{enumerable:!0,get:function(){return r.setGlobalProvider}});const i=zc;Object.defineProperty(e,"MetaMaskInpageProvider",{enumerable:!0,get:function(){return i.MetaMaskInpageProvider}}),Object.defineProperty(e,"MetaMaskInpageProviderStreamName",{enumerable:!0,get:function(){return i.MetaMaskInpageProviderStreamName}});const o=th;Object.defineProperty(e,"shimWeb3",{enumerable:!0,get:function(){return o.shimWeb3}});const s=Gc;Object.defineProperty(e,"StreamProvider",{enumerable:!0,get:function(){return s.StreamProvider}})}(oa);class oh extends oa.MetaMaskInpageProvider{constructor({connectionStream:e,shouldSendMetadata:t,debug:n=!1,autoRequestAccounts:r=!1}){super(e,{logger:console,maxEventListeners:100,shouldSendMetadata:t}),this.debug=!1,this.autoRequestAccounts=!1,this.providerStateRequested=!1,n&&console.debug(`SDKProvider::constructor debug=${n} autoRequestAccounts=${r}`),this.autoRequestAccounts=r,this.debug=n}forceInitializeState(){return a(this,void 0,void 0,(function*(){return this.debug&&console.debug(`SDKProvider::forceInitializeState() autoRequestAccounts=${this.autoRequestAccounts}`),this._initializeStateAsync()}))}_setConnected(){this.debug&&console.debug("SDKProvider::_setConnected()"),this._state.isConnected=!0}getState(){return this._state}handleDisconnect({terminate:e=!1}){this.debug&&console.debug(`SDKProvider::handleDisconnect() cleaning up provider state terminate=${e}`,this),e&&(this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0,this._state.initialized=!1),this._handleAccountsChanged([]),this._state.isConnected=!1,this.emit("disconnect",ha.ethErrors.provider.disconnected()),this.providerStateRequested=!1}_initializeStateAsync(){var e;return a(this,void 0,void 0,(function*(){if(this.debug&&console.debug("SDKProvider::_initializeStateAsync()"),this.providerStateRequested)this.debug&&console.debug("SDKProvider::_initializeStateAsync() initialization already in progress");else{let t;this.providerStateRequested=!0;try{t=yield this.request({method:"metamask_getProviderState"})}catch(e){return this._log.error("MetaMask: Failed to get initial state. Please report this bug.",e),void(this.providerStateRequested=!1)}if(this.debug&&console.debug(`SDKProvider::_initializeStateAsync state selectedAddress=${this.selectedAddress} `,t),0===(null===(e=null==t?void 0:t.accounts)||void 0===e?void 0:e.length))if(this.debug&&console.debug("SDKProvider::_initializeStateAsync initial state doesn't contain accounts"),this.selectedAddress)this.debug&&console.debug("SDKProvider::_initializeStateAsync using this.selectedAddress instead"),t.accounts=[this.selectedAddress];else{this.debug&&console.debug("SDKProvider::_initializeStateAsync Fetch accounts remotely.");const e=yield this.request({method:"eth_requestAccounts",params:[]});t.accounts=e}this._initializeState(t),this.providerStateRequested=!1}}))}_initializeState(e){return this.debug&&console.debug("SDKProvider::_initializeState() set state._initialized to false"),this._state.initialized=!1,super._initializeState(e)}_handleChainChanged({chainId:e,networkVersion:t}={}){this.debug&&console.debug(`SDKProvider::_handleChainChanged chainId=${e} networkVersion=${t}`);let n=t;t||(console.info("forced network version to prevent provider error"),n="1"),this._state.isConnected=!0,this.emit("connect",{chainId:e}),super._handleChainChanged({chainId:e,networkVersion:n})}}class sh{constructor({shouldSetOnWindow:e,connectionStream:t,shouldSendMetadata:n=!1,shouldShimWeb3:r,debug:i=!1}){this.debug=!1,this.debug=i;const o=new oh({connectionStream:t,shouldSendMetadata:n,shouldSetOnWindow:e,shouldShimWeb3:r,autoRequestAccounts:!1,debug:i});this.debug=i;const s=new Proxy(o,{deleteProperty:()=>!0});this.provider=s,e&&"undefined"!=typeof window&&oa.setGlobalProvider(this.provider),r&&"undefined"!=typeof window&&oa.shimWeb3(this.provider),this.provider.on("_initialized",(()=>{const e={chainId:this.provider.chainId,isConnected:this.provider.isConnected(),isMetaNask:this.provider.isMetaMask,selectedAddress:this.provider.selectedAddress,networkVersion:this.provider.networkVersion};this.debug&&console.info("Ethereum provider initialized",e)}))}static init(e){var t;return e.debug&&console.debug("Ethereum::init()"),this.instance=new sh(e),null===(t=this.instance)||void 0===t?void 0:t.provider}static destroy(){sh.instance=void 0}static getInstance(){var e;if(!(null===(e=this.instance)||void 0===e?void 0:e.provider))throw new Error("Ethereum instance not intiialized - call Ethereum.factory first.");return this.instance}static getProvider(){var e;if(!(null===(e=this.instance)||void 0===e?void 0:e.provider))throw new Error("Ethereum instance not intiialized - call Ethereum.factory first.");return this.instance.provider}}const ah=e=>new Promise((t=>{setTimeout((()=>{t(!0)}),e)}));class ch{constructor({preferDesktop:e,remote:t,platformManager:n,debug:r=!1}){this.isInstalling=!1,this.hasInstalled=!1,this.resendRequest=null,this.preferDesktop=!1,this.debug=!1,this.preferDesktop=e,this.remote=t,this.platformManager=n,this.debug=r}startDesktopOnboarding(){(null==this?void 0:this.debug)&&console.debug("MetamaskInstaller::startDesktopOnboarding()"),sh.destroy(),delete window.ethereum;(new ia).startOnboarding()}redirectToProperInstall(){return a(this,void 0,void 0,(function*(){const e=this.platformManager.getPlatformType();if((null==this?void 0:this.debug)&&console.debug(`MetamaskInstaller::redirectToProperInstall() platform=${e} this.preferDesktop=${this.preferDesktop}`),e===ps.MetaMaskMobileWebview)return!1;if(e===ps.DesktopWeb&&(this.isInstalling=!0,this.preferDesktop))return this.startDesktopOnboarding(),!1;this.isInstalling=!0;try{yield this.remote.startConnection(),this.isInstalling=!1,this.hasInstalled=!0}catch(e){throw this.isInstalling=!1,e}return!0}))}checkInstallation(){return a(this,void 0,void 0,(function*(){const e=this.platformManager.isMetaMaskInstalled();return this.debug&&console.log(`MetamaskInstaller::checkInstallation() isInstalled=${e}`),!!e||(yield this.redirectToProperInstall())}))}start({wait:e=!1}){return a(this,void 0,void 0,(function*(){return this.debug&&console.debug(`MetamaskInstaller::start() wait=${e}`),e&&(yield ah(1e3)),yield this.checkInstallation()}))}}var dh;!function(e){e.Disabled="Disabled",e.Temporary="Temporary",e.UntilResponse="UntilResponse"}(dh||(dh={}));const uh=()=>"wakeLock"in navigator,hh=()=>"undefined"!=typeof navigator&&parseFloat(`${(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]}`.replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream;class fh{constructor(){this.enabled=!1,this._eventsAdded=!1}start(){if(this.enabled=!1,console.debug(`WakeLockManager::start() hasNativeWakeLock=${uh()}`),uh()&&!this._eventsAdded){this._eventsAdded=!0,this._wakeLock=void 0;const e=()=>{null!==this._wakeLock&&"visible"===document.visibilityState&&this.enable()};document.addEventListener("visibilitychange",e),document.addEventListener("fullscreenchange",e)}else hh()?this.noSleepTimer=void 0:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("title","MetaMask SDK - Listening for responses"),this.noSleepVideo.setAttribute("playsinline",""),this._addSourceToVideo(this.noSleepVideo,"webm","data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAVkhFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsghV17AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU1LjMzLjEwMFdBjUxhdmY1NS4zMy4xMDBzpJBlrrXf3DCDVB8KcgbMpcr+RImIQJBgAAAAAAAWVK5rAQAAAAAAD++uAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDiDgQEj44OEAmJaAOABAAAAAAAABrCBsLqBkK4BAAAAAAAPq9eBAnPFgQKcgQAitZyDdW5khohBX1ZPUkJJU4OBAuEBAAAAAAAAEZ+BArWIQOdwAAAAAABiZIEgY6JPbwIeVgF2b3JiaXMAAAAAAoC7AAAAAAAAgLUBAAAAAAC4AQN2b3JiaXMtAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAxMDExMDEgKFNjaGF1ZmVudWdnZXQpAQAAABUAAABlbmNvZGVyPUxhdmM1NS41Mi4xMDIBBXZvcmJpcyVCQ1YBAEAAACRzGCpGpXMWhBAaQlAZ4xxCzmvsGUJMEYIcMkxbyyVzkCGkoEKIWyiB0JBVAABAAACHQXgUhIpBCCGEJT1YkoMnPQghhIg5eBSEaUEIIYQQQgghhBBCCCGERTlokoMnQQgdhOMwOAyD5Tj4HIRFOVgQgydB6CCED0K4moOsOQghhCQ1SFCDBjnoHITCLCiKgsQwuBaEBDUojILkMMjUgwtCiJqDSTX4GoRnQXgWhGlBCCGEJEFIkIMGQcgYhEZBWJKDBjm4FITLQagahCo5CB+EIDRkFQCQAACgoiiKoigKEBqyCgDIAAAQQFEUx3EcyZEcybEcCwgNWQUAAAEACAAAoEiKpEiO5EiSJFmSJVmSJVmS5omqLMuyLMuyLMsyEBqyCgBIAABQUQxFcRQHCA1ZBQBkAAAIoDiKpViKpWiK54iOCISGrAIAgAAABAAAEDRDUzxHlETPVFXXtm3btm3btm3btm3btm1blmUZCA1ZBQBAAAAQ0mlmqQaIMAMZBkJDVgEACAAAgBGKMMSA0JBVAABAAACAGEoOogmtOd+c46BZDppKsTkdnEi1eZKbirk555xzzsnmnDHOOeecopxZDJoJrTnnnMSgWQqaCa0555wnsXnQmiqtOeeccc7pYJwRxjnnnCateZCajbU555wFrWmOmkuxOeecSLl5UptLtTnnnHPOOeecc84555zqxekcnBPOOeecqL25lpvQxTnnnE/G6d6cEM4555xzzjnnnHPOOeecIDRkFQAABABAEIaNYdwpCNLnaCBGEWIaMulB9+gwCRqDnELq0ehopJQ6CCWVcVJKJwgNWQUAAAIAQAghhRRSSCGFFFJIIYUUYoghhhhyyimnoIJKKqmooowyyyyzzDLLLLPMOuyssw47DDHEEEMrrcRSU2011lhr7jnnmoO0VlprrbVSSimllFIKQkNWAQAgAAAEQgYZZJBRSCGFFGKIKaeccgoqqIDQkFUAACAAgAAAAABP8hzRER3RER3RER3RER3R8RzPESVREiVREi3TMjXTU0VVdWXXlnVZt31b2IVd933d933d+HVhWJZlWZZlWZZlWZZlWZZlWZYgNGQVAAACAAAghBBCSCGFFFJIKcYYc8w56CSUEAgNWQUAAAIACAAAAHAUR3EcyZEcSbIkS9IkzdIsT/M0TxM9URRF0zRV0RVdUTdtUTZl0zVdUzZdVVZtV5ZtW7Z125dl2/d93/d93/d93/d93/d9XQdCQ1YBABIAADqSIymSIimS4ziOJElAaMgqAEAGAEAAAIriKI7jOJIkSZIlaZJneZaomZrpmZ4qqkBoyCoAABAAQAAAAAAAAIqmeIqpeIqoeI7oiJJomZaoqZoryqbsuq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq4LhIasAgAkAAB0JEdyJEdSJEVSJEdygNCQVQCADACAAAAcwzEkRXIsy9I0T/M0TxM90RM901NFV3SB0JBVAAAgAIAAAAAAAAAMybAUy9EcTRIl1VItVVMt1VJF1VNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVN0zRNEwgNWQkAkAEAkBBTLS3GmgmLJGLSaqugYwxS7KWxSCpntbfKMYUYtV4ah5RREHupJGOKQcwtpNApJq3WVEKFFKSYYyoVUg5SIDRkhQAQmgHgcBxAsixAsiwAAAAAAAAAkDQN0DwPsDQPAAAAAAAAACRNAyxPAzTPAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAA0DwP8DwR8EQRAAAAAAAAACzPAzTRAzxRBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAAsDwP8EQR0DwRAAAAAAAAACzPAzxRBDzRAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAEOAAABBgIRQasiIAiBMAcEgSJAmSBM0DSJYFTYOmwTQBkmVB06BpME0AAAAAAAAAAAAAJE2DpkHTIIoASdOgadA0iCIAAAAAAAAAAAAAkqZB06BpEEWApGnQNGgaRBEAAAAAAAAAAAAAzzQhihBFmCbAM02IIkQRpgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAGHAAAAgwoQwUGrIiAIgTAHA4imUBAIDjOJYFAACO41gWAABYliWKAABgWZooAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAYcAAACDChDBQashIAiAIAcCiKZQHHsSzgOJYFJMmyAJYF0DyApgFEEQAIAAAocAAACLBBU2JxgEJDVgIAUQAABsWxLE0TRZKkaZoniiRJ0zxPFGma53meacLzPM80IYqiaJoQRVE0TZimaaoqME1VFQAAUOAAABBgg6bE4gCFhqwEAEICAByKYlma5nmeJ4qmqZokSdM8TxRF0TRNU1VJkqZ5niiKommapqqyLE3zPFEURdNUVVWFpnmeKIqiaaqq6sLzPE8URdE0VdV14XmeJ4qiaJqq6roQRVE0TdNUTVV1XSCKpmmaqqqqrgtETxRNU1Vd13WB54miaaqqq7ouEE3TVFVVdV1ZBpimaaqq68oyQFVV1XVdV5YBqqqqruu6sgxQVdd1XVmWZQCu67qyLMsCAAAOHAAAAoygk4wqi7DRhAsPQKEhKwKAKAAAwBimFFPKMCYhpBAaxiSEFEImJaXSUqogpFJSKRWEVEoqJaOUUmopVRBSKamUCkIqJZVSAADYgQMA2IGFUGjISgAgDwCAMEYpxhhzTiKkFGPOOScRUoox55yTSjHmnHPOSSkZc8w556SUzjnnnHNSSuacc845KaVzzjnnnJRSSuecc05KKSWEzkEnpZTSOeecEwAAVOAAABBgo8jmBCNBhYasBABSAQAMjmNZmuZ5omialiRpmud5niiapiZJmuZ5nieKqsnzPE8URdE0VZXneZ4oiqJpqirXFUXTNE1VVV2yLIqmaZqq6rowTdNUVdd1XZimaaqq67oubFtVVdV1ZRm2raqq6rqyDFzXdWXZloEsu67s2rIAAPAEBwCgAhtWRzgpGgssNGQlAJABAEAYg5BCCCFlEEIKIYSUUggJAAAYcAAACDChDBQashIASAUAAIyx1lprrbXWQGettdZaa62AzFprrbXWWmuttdZaa6211lJrrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmstpZRSSimllFJKKaWUUkoppZRSSgUA+lU4APg/2LA6wknRWGChISsBgHAAAMAYpRhzDEIppVQIMeacdFRai7FCiDHnJKTUWmzFc85BKCGV1mIsnnMOQikpxVZjUSmEUlJKLbZYi0qho5JSSq3VWIwxqaTWWoutxmKMSSm01FqLMRYjbE2ptdhqq7EYY2sqLbQYY4zFCF9kbC2m2moNxggjWywt1VprMMYY3VuLpbaaizE++NpSLDHWXAAAd4MDAESCjTOsJJ0VjgYXGrISAAgJACAQUooxxhhzzjnnpFKMOeaccw5CCKFUijHGnHMOQgghlIwx5pxzEEIIIYRSSsaccxBCCCGEkFLqnHMQQgghhBBKKZ1zDkIIIYQQQimlgxBCCCGEEEoopaQUQgghhBBCCKmklEIIIYRSQighlZRSCCGEEEIpJaSUUgohhFJCCKGElFJKKYUQQgillJJSSimlEkoJJYQSUikppRRKCCGUUkpKKaVUSgmhhBJKKSWllFJKIYQQSikFAAAcOAAABBhBJxlVFmGjCRcegEJDVgIAZAAAkKKUUiktRYIipRikGEtGFXNQWoqocgxSzalSziDmJJaIMYSUk1Qy5hRCDELqHHVMKQYtlRhCxhik2HJLoXMOAAAAQQCAgJAAAAMEBTMAwOAA4XMQdAIERxsAgCBEZohEw0JweFAJEBFTAUBigkIuAFRYXKRdXECXAS7o4q4DIQQhCEEsDqCABByccMMTb3jCDU7QKSp1IAAAAAAADADwAACQXAAREdHMYWRobHB0eHyAhIiMkAgAAAAAABcAfAAAJCVAREQ0cxgZGhscHR4fICEiIyQBAIAAAgAAAAAggAAEBAQAAAAAAAIAAAAEBB9DtnUBAAAAAAAEPueBAKOFggAAgACjzoEAA4BwBwCdASqwAJAAAEcIhYWIhYSIAgIABhwJ7kPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99YAD+/6tQgKOFggADgAqjhYIAD4AOo4WCACSADqOZgQArADECAAEQEAAYABhYL/QACIBDmAYAAKOFggA6gA6jhYIAT4AOo5mBAFMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAGSADqOFggB6gA6jmYEAewAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAj4AOo5mBAKMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAKSADqOFggC6gA6jmYEAywAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAz4AOo4WCAOSADqOZgQDzADECAAEQEAAYABhYL/QACIBDmAYAAKOFggD6gA6jhYIBD4AOo5iBARsAEQIAARAQFGAAYWC/0AAiAQ5gGACjhYIBJIAOo4WCATqADqOZgQFDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggFPgA6jhYIBZIAOo5mBAWsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAXqADqOFggGPgA6jmYEBkwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIBpIAOo4WCAbqADqOZgQG7ADECAAEQEAAYABhYL/QACIBDmAYAAKOFggHPgA6jmYEB4wAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIB5IAOo4WCAfqADqOZgQILADECAAEQEAAYABhYL/QACIBDmAYAAKOFggIPgA6jhYICJIAOo5mBAjMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAjqADqOFggJPgA6jmYECWwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYICZIAOo4WCAnqADqOZgQKDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggKPgA6jhYICpIAOo5mBAqsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCArqADqOFggLPgA6jmIEC0wARAgABEBAUYABhYL/QACIBDmAYAKOFggLkgA6jhYIC+oAOo5mBAvsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAw+ADqOZgQMjADECAAEQEAAYABhYL/QACIBDmAYAAKOFggMkgA6jhYIDOoAOo5mBA0sAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA0+ADqOFggNkgA6jmYEDcwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIDeoAOo4WCA4+ADqOZgQObADECAAEQEAAYABhYL/QACIBDmAYAAKOFggOkgA6jhYIDuoAOo5mBA8MAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA8+ADqOFggPkgA6jhYID+oAOo4WCBA+ADhxTu2sBAAAAAAAAEbuPs4EDt4r3gQHxghEr8IEK"),this._addSourceToVideo(this.noSleepVideo,"mp4","data:video/mp4;base64,AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw"),this.noSleepVideo.addEventListener("loadedmetadata",(()=>{this.noSleepVideo&&(this.noSleepVideo.duration<=1?this.noSleepVideo.setAttribute("loop",""):this.noSleepVideo.addEventListener("timeupdate",(()=>{this.noSleepVideo&&this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())})))})))}_addSourceToVideo(e,t,n){const r=document.createElement("source");r.src=n,r.type=`video/${t}`,e.appendChild(r)}isEnabled(){return this.enabled}enable(){var e;if(this.enabled&&this.disable(),this.start(),uh())return navigator.wakeLock.request("screen").then((e=>{this._wakeLock=e,this.enabled=!0})).catch((()=>(this.enabled=!1,!1)));if(hh())return this.disable(),this.noSleepTimer=window.setInterval((()=>{document.hidden||(window.location.href=window.location.href.split("#")[0],window.setTimeout(window.stop,0))}),15e3),this.enabled=!0,Promise.resolve();if(this.noSleepVideo){const t=null===(e=this.noSleepVideo)||void 0===e?void 0:e.play();return this.enabled=!0,t.then((()=>!0)).catch((()=>!1))}return this.enabled=!0,Promise.resolve()}disable(){if(this.enabled){if(uh())this._wakeLock&&this._wakeLock.release(),this._wakeLock=void 0;else if(hh())this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=void 0);else try{if(!this.noSleepVideo)return;this.noSleepVideo.firstChild&&(this.noSleepVideo.removeChild(this.noSleepVideo.firstChild),this.noSleepVideo.load()),this.noSleepVideo.pause(),this.noSleepVideo.src="",this.noSleepVideo.remove()}catch(e){console.log(e)}this.enabled=!1}}}class lh{constructor({useDeepLink:e,preferredOpenLink:t,wakeLockStatus:n=dh.Temporary,debug:r=!1}){this.wakeLock=new fh,this.wakeLockStatus=dh.Temporary,this.wakeLockFeatureActive=!1,this.useDeeplink=!1,this.debug=!1,this.platformType=this.getPlatformType(),this.useDeeplink=e,this.preferredOpenLink=t,this.wakeLockStatus=n,this.debug=r}enableWakeLock(){if(this.wakeLockStatus===dh.Disabled)return;this.wakeLock.enable();const e=this.wakeLockStatus===dh.Temporary?2e3:2e4;this.wakeLockTimer=setTimeout((()=>{this.disableWakeLock()}),e),this.wakeLockFeatureActive||this.wakeLockStatus!==dh.UntilResponse||(this.wakeLockFeatureActive=!0,window.addEventListener("focus",(()=>this.disableWakeLock())))}disableWakeLock(){this.wakeLockStatus!==dh.Disabled&&(this.wakeLockTimer&&clearTimeout(this.wakeLockTimer),this.wakeLock.disable())}openDeeplink(e,t,n){this.debug&&(console.debug(`Platform::openDeepLink universalLink --\x3e ${e}`),console.debug(`Platform::openDeepLink deepLink --\x3e ${t}`)),this.isBrowser()&&this.enableWakeLock();try{if(this.preferredOpenLink)return void this.preferredOpenLink(e,n);if("undefined"!=typeof window){let n;n=this.useDeeplink?window.open(t,"_blank"):window.open(e,"_blank"),setTimeout((()=>{var e;return null===(e=null==n?void 0:n.close)||void 0===e?void 0:e.call(n)}),500)}}catch(e){console.log("Platform::openDeepLink() can't open link",e)}}isReactNative(){var e;return this.isNotBrowser()&&"undefined"!=typeof window&&(null===window||void 0===window?void 0:window.navigator)&&"ReactNative"===(null===(e=window.navigator)||void 0===e?void 0:e.product)}isMetaMaskInstalled(){const e=sh.getProvider()||(null===window||void 0===window?void 0:window.ethereum);return this.debug&&console.debug(`Platform::isMetaMaskInstalled isMetaMask=${null==e?void 0:e.isMetaMask} isConnected=${null==e?void 0:e.isConnected()}`),(null==e?void 0:e.isMetaMask)&&(null==e?void 0:e.isConnected())}isDesktopWeb(){return this.isBrowser()&&!this.isMobileWeb()}isMobile(){var e,t;const n=Ws.parse(window.navigator.userAgent);return"mobile"===(null===(e=null==n?void 0:n.platform)||void 0===e?void 0:e.type)||"tablet"===(null===(t=null==n?void 0:n.platform)||void 0===t?void 0:t.type)}isSecure(){return this.isReactNative()||this.isMobileWeb()}isMetaMaskMobileWebView(){return"undefined"!=typeof window&&(Boolean(window.ReactNativeWebView)&&Boolean(navigator.userAgent.endsWith("MetaMaskMobile")))}isMobileWeb(){return this.platformType===ps.MobileWeb}isNotBrowser(){var e;return"undefined"==typeof window||!(null===window||void 0===window?void 0:window.navigator)||"undefined"!=typeof global&&"ReactNative"===(null===(e=null===global||void 0===global?void 0:global.navigator)||void 0===e?void 0:e.product)||"ReactNative"===(null===navigator||void 0===navigator?void 0:navigator.product)}isNodeJS(){return this.isNotBrowser()&&!this.isReactNative()}isBrowser(){return!this.isNotBrowser()}isUseDeepLink(){return this.useDeeplink}getPlatformType(){return this.platformType?this.platformType:this.isReactNative()?ps.ReactNative:this.isNotBrowser()?ps.NonBrowser:this.isMetaMaskMobileWebView()?ps.MetaMaskMobileWebview:this.isMobile()?ps.MobileWeb:ps.DesktopWeb}}var Ah;!function(e){e.INPAGE="metamask-inpage",e.CONTENT_SCRIPT="metamask-contentscript",e.PROVIDER="metamask-provider"}(Ah||(Ah={}));const ph="https://metamask.app.link/connect",bh="metamask://connect";class mh extends o{constructor({name:e,remote:t,platformManager:n,debug:r}){super({objectMode:!0}),this._name=e,this.remote=t,this.debug=r,this.platformManager=n,this._onMessage=this._onMessage.bind(this),this.remote.on(ti.MESSAGE,this._onMessage)}_write(e,n,r){var i,o;return a(this,void 0,void 0,(function*(){const n=this.remote.isReady(),s=this.remote.isConnected(),a=this.remote.isPaused(),c=this.remote.isReady(),d=sh.getProvider(),u=this.remote.getChannelId(),h=this.remote.isAuthorized(),{method:f,data:l}=(e=>{var n;let r;return t.isBuffer(e)?(r=e.toJSON(),r._isBuffer=!0):r=e,{method:null===(n=null==r?void 0:r.data)||void 0===n?void 0:n.method,data:r}})(e);if(this.debug&&console.debug(`RPCMS::_write method='${f}' isRemoteReady=${n} channelId=${u} isSocketConnected=${s} isRemotePaused=${a} providerConnected=${d.isConnected()}`,e),!u)return this.debug&&f!==Ks&&console.warn("RPCMS::_write Invalid channel id -- undefined"),r();this.debug&&console.debug(`RPCMS::_write remote.isPaused()=${this.remote.isPaused()} authorized=${h} ready=${c} socketConnected=${s}`,e);try{if(this.remote.sendMessage(null==l?void 0:l.data).then((()=>{this.debug&&console.debug(`RCPMS::_write ${f} sent successfully`)})).catch((e=>{console.error("RCPMS::_write error sending message",e)})),!this.platformManager.isSecure())return this.debug&&console.log(`RCPMS::_write unsecure platform for method ${f} -- return callback`),r();if(!s&&!c)return this.debug&&console.debug(`RCPMS::_write invalid connection status targetMethod=${f} socketConnected=${s} ready=${c} providerConnected=${d.isConnected()}\n\n`),r();if(!s&&c)return console.warn("RCPMS::_write invalid socket status -- shouln't happen"),r();const e=null!==(o=null===(i=this.remote.getKeyInfo())||void 0===i?void 0:i.ecies.public)&&void 0!==o?o:"",t=encodeURI(`channelId=${u}&pubkey=${e}&comm=socket`);Ds[f]?(this.debug&&console.debug(`RCPMS::_write redirect link for '${f}' socketConnected=${s}`,`connect?${t}`),this.platformManager.openDeeplink(`${ph}?${t}`,`${bh}?${t}`,"_self")):this.remote.isPaused()?(this.debug&&console.debug(`RCPMS::_write MM is PAUSED! deeplink with connect! targetMethod=${f}`),this.platformManager.openDeeplink(`${ph}?redirect=true&${t}`,`${bh}?redirect=true&${t}`,"_self")):console.debug(`RCPMS::_write method ${f} doesn't need redirect.`)}catch(e){return this.debug&&console.error("RCPMS::_write error",e),r(new Error("RemoteCommunicationPostMessageStream - disconnected"))}return r()}))}_read(){}_onMessage(e){try{this.debug&&console.debug("[RCPMS] _onMessage ",e);if(!e||"object"!==typeof e)return;if("object"!==typeof(null==e?void 0:e.data))return;if(!(null==e?void 0:e.name))return;if((null==e?void 0:e.name)!==Ah.PROVIDER)return;if(t.isBuffer(e)){const n=t.from(e);this.push(n)}else this.push(e)}catch(e){this.debug&&console.debug("RCPMS ignore message error",e)}}start(){}}var gh;!function(e){e.TERMINATE="terminate",e.EXTENSION="extension"}(gh||(gh={}));const vh=({checkInstallationOnAllCalls:e=!1,communicationLayerPreference:t,injectProvider:n,shouldShimWeb3:r,platformManager:i,installer:o,sdk:s,remoteConnection:c,debug:d})=>{const u=(({name:e,remoteConnection:t,debug:n})=>{if(!t||!(null==t?void 0:t.getConnector()))throw new Error("Missing remote conenction parameter");return new mh({name:e,remote:null==t?void 0:t.getConnector(),platformManager:null==t?void 0:t.getPlatformManager(),debug:n})})({name:Ah.INPAGE,target:Ah.CONTENT_SCRIPT,platformManager:i,communicationLayerPreference:t,remoteConnection:c,debug:d}),h=i.getPlatformType(),f=!(!n||h===ps.NonBrowser||h===ps.ReactNative),l=sh.init({shouldSetOnWindow:f,connectionStream:u,shouldShimWeb3:r,debug:d});let A=!1;const p=e=>{A=e},b=()=>A,m=(t,n,r,u)=>a(void 0,void 0,void 0,(function*(){var a,h,f;if(A){null==c||c.showActiveModal();let e=b();for(;e;)yield ah(1e3),e=b();return d&&console.debug("initializeProvider::sendRequest() initial method completed -- prevent installation and call provider"),r(...n)}const l=i.isMetaMaskInstalled(),m=null==c?void 0:c.isConnected(),{selectedAddress:g}=sh.getProvider();if(u&&console.debug(`initializeProvider::sendRequest() method=${t} ongoing=${A} selectedAddress=${g} isInstalled=${l} checkInstallationOnAllCalls=${e} socketConnected=${m}`),(!l||l&&!m)&&t!==Ks){if(t===qs||e){p(!0);try{yield o.start({wait:!1})}catch(e){if(p(!1),gh.EXTENSION===e)return d&&console.debug(`initializeProvider extension provider detect: re-create ${t} on the active provider`),yield null===(a=s.getProvider())||void 0===a?void 0:a.request({method:t,params:n});throw d&&console.debug(`initializeProvider failed to start installer: ${e}`),e}const e=r(...n);try{yield new Promise(((e,t)=>{null==c||c.getConnector().once(ti.AUTHORIZED,(()=>{e(!0)})),s.once(ti.PROVIDER_UPDATE,(e=>{d&&console.debug("initializeProvider::sendRequest() PROVIDER_UPDATE --- remote provider request interupted",e),e===gh.EXTENSION?t(ti.PROVIDER_UPDATE):t(new Error("Connection Terminated"))}))}))}catch(e){if(p(!1),e===ti.PROVIDER_UPDATE)return yield null===(h=s.getProvider())||void 0===h?void 0:h.request({method:t,params:n});throw e}return p(!1),e}if(i.isSecure()&&Ds[t])return r(...n);if(s.isExtensionActive())return d&&console.debug(`initializeProvider::sendRequest() EXTENSION active - redirect request '${t}' to it`),yield null===(f=s.getProvider())||void 0===f?void 0:f.request({method:t,params:n});throw d&&console.debug(`initializeProvider::sendRequest() method=${t} --- skip --- not connected/installed`),new Error("MetaMask is not connected/installed, please call eth_requestAccounts to connect first.")}const v=yield r(...n);return d&&console.debug(`initializeProvider::sendRequest() method=${t} rpcResponse:`,v),v})),{request:g}=l;l.request=(...e)=>a(void 0,void 0,void 0,(function*(){return m(null==e?void 0:e[0].method,e,g,d)}));const{send:v}=l;return l.send=(...e)=>a(void 0,void 0,void 0,(function*(){return m(null==e?void 0:e[0],e,v,d)})),d&&console.debug("initializeProvider metamaskStream.start()"),u.start(),l};var yh,wh,_h,Mh;const Eh="sdk",Sh="NONE";class kh{constructor(e){var t;yh.set(this,void 0),wh.set(this,si),_h.set(this,void 0),Mh.set(this,void 0),d(this,yh,e.debug,"f"),d(this,wh,e.serverURL,"f"),d(this,Mh,e.metadata||void 0,"f"),d(this,_h,null===(t=e.enabled)||void 0===t||t,"f")}send({event:e}){c(this,_h,"f")&&ys({id:Eh,event:e,commLayerVersion:Sh,originationInfo:c(this,Mh,"f")},c(this,wh,"f")).catch((e=>{c(this,yh,"f")&&console.error(e)}))}}yh=new WeakMap,wh=new WeakMap,_h=new WeakMap,Mh=new WeakMap;const Ch=({link:e})=>(console.log("INSTALL MODAL",e),{unmount:()=>{}}),Ih=()=>(console.log("Please open the MetaMask wallet app and confirm the connection. Thank you!"),{unmount:()=>!1,updateOTPValue:e=>{""!==e&&console.info(`Choose the following value on your metamask mobile wallet: ${e}`)},mount:()=>!1});var xh="0.6.0";function Oh(e,t,n){return a(this,void 0,void 0,(function*(){return new Promise(((r,i)=>{if(!e.connector)return void i(new Error("No connector available"));!function(e,t,n){var r,i,o,s,a,c;if(e.installModal)return e.developerMode&&console.debug("RemoteConnection::showInstallModal() install modal already initialized",e.installModal),void(null===(i=(r=e.installModal).mount)||void 0===i||i.call(r,n));e.installModal=null===(s=(o=t.modals).install)||void 0===s?void 0:s.call(o,{link:n,installer:t.getMetaMaskInstaller(),terminate:()=>{e.developerMode&&console.debug("RemoteConnection::showInstallModal() terminate connection"),t.sdk.terminate()},debug:e.developerMode,connectWithExtension:()=>{var e;return null===(e=t.connectWithExtensionProvider)||void 0===e||e.call(t),!1}}),null===(c=null===(a=e.installModal)||void 0===a?void 0:a.mount)||void 0===c||c.call(a,n)}(e,t,`${ph}?${n}`),t.sdk.once(ti.PROVIDER_UPDATE,(t=>a(this,void 0,void 0,(function*(){e.developerMode&&console.debug("RemoteConnection::startConnection::on 'provider_update' -- resolving startConnection promise"),i(t)})))),e.connector.once(ti.CLIENTS_READY,(()=>a(this,void 0,void 0,(function*(){e.developerMode&&console.debug("RemoteConnection::startConnection::on 'clients_ready' -- resolving startConnection promise"),r()}))))}))}))}function Rh(e,t){var n,r,i,o,s,c;return a(this,void 0,void 0,(function*(){e.pendingModal?null===(r=null===(n=e.pendingModal)||void 0===n?void 0:n.mount)||void 0===r||r.call(n):e.pendingModal=null===(o=(i=t.modals).otp)||void 0===o?void 0:o.call(i,(()=>function(e,t){var n,r,i,o;null===(r=(n=e.modals).onPendingModalDisconnect)||void 0===r||r.call(n),null===(o=null===(i=t.pendingModal)||void 0===i?void 0:i.unmount)||void 0===o||o.call(i)}(t,e)));const d=yield function(e){return a(this,void 0,void 0,(function*(){for(;void 0===e.otpAnswer;)yield new Promise((e=>setTimeout((()=>e()),1e3)));return e.otpAnswer}))}(e);e.otpAnswer!==d&&(e.otpAnswer=d,null===(c=null===(s=e.pendingModal)||void 0===s?void 0:s.updateOTPValue)||void 0===c||c.call(s,d))}))}function Ph(e,t){var n,r,i,o,s,c,d,u;return a(this,void 0,void 0,(function*(){if(!e.connector)throw new Error("no connector defined");const h=sh.getProvider();e.authorized=!1,h.emit("connecting");const f=yield null===(n=e.connector)||void 0===n?void 0:n.originatorSessionConnect();e.developerMode&&console.debug("RemoteConnection::startConnection after startAutoConnect",f);let l=null!==(r=null==f?void 0:f.channelId)&&void 0!==r?r:"",A=null!==(o=null===(i=e.connector.getKeyInfo())||void 0===i?void 0:i.ecies.public)&&void 0!==o?o:"";if(!f){const t=yield e.connector.generateChannelIdConnect();l=null!==(s=t.channelId)&&void 0!==s?s:"",A=null!==(d=null===(c=e.connector.getKeyInfo())||void 0===c?void 0:c.ecies.public)&&void 0!==d?d:""}const p=encodeURI(`channelId=${l}&comm=${e.communicationLayerPreference}&pubkey=${A}`),b=`${ph}?${p}`;return e.universalLink=b,(null===(u=e.platformManager)||void 0===u?void 0:u.isSecure())?function(e,t){var n,r;return a(this,void 0,void 0,(function*(){const i=`${ph}?${t}`,o=`${bh}?${t}`;null===(r=null===(n=e.platformManager)||void 0===n?void 0:n.openDeeplink)||void 0===r||r.call(n,i,o,"_self")}))}(e,p):(null==f?void 0:f.lastActive)?Rh(e,t):Oh(e,t,p)}))}class Th{constructor(e){var t,n;this.state={connector:void 0,universalLink:void 0,analytics:void 0,developerMode:!1,authorized:!1,reconnection:!1,communicationLayerPreference:void 0,platformManager:void 0,pendingModal:void 0,installModal:void 0,otpAnswer:void 0},this.options=e;const r=!0===(null===(t=e.logging)||void 0===t?void 0:t.developerMode)||!0===(null===(n=e.logging)||void 0===n?void 0:n.sdk);this.state.developerMode=r,this.state.analytics=e.analytics,this.state.communicationLayerPreference=e.communicationLayerPreference,this.state.platformManager=e.platformManager,e.modals.install||(e.modals.install=Ch),e.modals.otp||(e.modals.otp=Ih),function(e,t){var n,r;const{dappMetadata:i,communicationLayerPreference:o,transports:s,_source:a,enableDebug:c=!1,platformManager:d,timer:u,ecies:h,storage:f,communicationServerUrl:l,logging:A}=t;e.developerMode&&console.debug("RemoteConnection::initializeConnector() intialize connector"),e.connector=new Rs({platformType:d.getPlatformType(),communicationLayerPreference:o,transports:s,dappMetadata:Object.assign(Object.assign({},i),{source:a}),analytics:c,communicationServerUrl:l,sdkVersion:xh,context:"dapp",ecies:h,storage:f,logging:A}),u&&(e.developerMode&&console.debug("RemoteConnection::setup reset background timer",u),null===(n=null==u?void 0:u.stopBackgroundTimer)||void 0===n||n.call(u),null===(r=null==u?void 0:u.runBackgroundTimer)||void 0===r||r.call(u,(()=>!1),1e4))}(this.state,this.options),function(e,t){var n;e.connector&&((null===(n=e.platformManager)||void 0===n?void 0:n.isSecure())||e.connector.on(ti.OTP,(n=>{var r,i,o,s,a,c;if(e.otpAnswer!==n){if(e.developerMode&&console.debug("RemoteConnection::on 'OTP' ",n),e.otpAnswer=n,!e.pendingModal){e.developerMode&&console.debug("RemoteConnection::on 'OTP' init pending modal");const n=()=>{var n,r,i,o,s,a;null===(r=(n=t.modals).onPendingModalDisconnect)||void 0===r||r.call(n),null===(o=null===(i=e.pendingModal)||void 0===i?void 0:i.unmount)||void 0===o||o.call(i),null===(a=null===(s=e.pendingModal)||void 0===s?void 0:s.updateOTPValue)||void 0===a||a.call(s,"")};e.pendingModal=null===(i=(r=t.modals).otp)||void 0===i?void 0:i.call(r,n)}null===(s=null===(o=e.pendingModal)||void 0===o?void 0:o.updateOTPValue)||void 0===s||s.call(o,n),null===(c=null===(a=e.pendingModal)||void 0===a?void 0:a.mount)||void 0===c||c.call(a)}})),e.connector.on(ti.SDK_RPC_CALL,(t=>a(this,void 0,void 0,(function*(){var n,r;e.developerMode&&console.debug("RemoteConnection::on 'sdk_rpc_call' requestParam",t);const i=sh.getProvider(),o=yield i.request(t);e.developerMode&&console.debug("RemoteConnection::on 'sdk_rpc_call' result",o),null===(r=null===(n=e.pendingModal)||void 0===n?void 0:n.unmount)||void 0===r||r.call(n)})))),e.connector.on(ti.AUTHORIZED,(()=>a(this,void 0,void 0,(function*(){var t,n,r,i,o;try{e.developerMode&&console.debug("RemoteConnection::on 'authorized' closing modals",e.pendingModal,e.installModal),null===(t=e.analytics)||void 0===t||t.send({event:ws.AUTHORIZED});const s=sh.getProvider();s._setConnected(),null===(r=null===(n=e.pendingModal)||void 0===n?void 0:n.unmount)||void 0===r||r.call(n),null===(o=null===(i=e.installModal)||void 0===i?void 0:i.unmount)||void 0===o||o.call(i,!1),e.otpAnswer=void 0,e.authorized=!0,e.developerMode&&console.debug("RCPMS::on 'authorized' provider.state",s.getState()),yield s.forceInitializeState()}catch(e){}})))),e.connector.on(ti.CLIENTS_DISCONNECTED,(()=>{var t,n,r;e.developerMode&&console.debug(`[RCPMS] received '${ti.CLIENTS_DISCONNECTED}'`),(null===(t=e.platformManager)||void 0===t?void 0:t.isSecure())||(sh.getProvider().handleDisconnect({terminate:!1}),null===(r=null===(n=e.pendingModal)||void 0===n?void 0:n.updateOTPValue)||void 0===r||r.call(n,""))})),e.connector.on(ti.TERMINATE,(()=>{var t,n,r,i,o;(null===(t=e.connector)||void 0===t?void 0:t.isAuthorized())||null===(n=e.analytics)||void 0===n||n.send({event:ws.REJECTED}),(null===(r=e.platformManager)||void 0===r?void 0:r.isBrowser())?alert("SDK Connection has been terminated from MetaMask."):console.info("SDK Connection has been terminated"),null===(o=null===(i=e.pendingModal)||void 0===i?void 0:i.unmount)||void 0===o||o.call(i),e.pendingModal=void 0,e.otpAnswer=void 0,e.authorized=!1,sh.getProvider().handleDisconnect({terminate:!0})})))}(this.state,this.options)}startConnection(){return a(this,void 0,void 0,(function*(){return Ph(this.state,this.options)}))}showActiveModal(){var e,t,n,r,i;(e=this.state).authorized?e.developerMode&&console.debug("RemoteConnection::showActiveModal() already authorized"):e.pendingModal?null===(n=(t=e.pendingModal).mount)||void 0===n||n.call(t):e.installModal&&(null===(i=(r=e.installModal).mount)||void 0===i||i.call(r,e.universalLink||""))}getUniversalLink(){if(!this.state.universalLink)throw new Error("connection not started. run startConnection() first.");return this.state.universalLink}getChannelConfig(){var e;return null===(e=this.state.connector)||void 0===e?void 0:e.getChannelConfig()}getKeyInfo(){var e;return null===(e=this.state.connector)||void 0===e?void 0:e.getKeyInfo()}getConnector(){if(!this.state.connector)throw new Error("invalid remote connector");return this.state.connector}getPlatformManager(){if(!this.state.platformManager)throw new Error("platformManager is not initialized");return this.state.platformManager}isConnected(){var e;return(null===(e=this.state.connector)||void 0===e?void 0:e.isReady())||!1}isAuthorized(){var e;return(null===(e=this.state.connector)||void 0===e?void 0:e.isAuthorized())||!1}isPaused(){var e;return null===(e=this.state.connector)||void 0===e?void 0:e.isPaused()}disconnect(e){var t,n,r;this.state.developerMode&&console.debug("RemoteConnection::disconnect()",e),(null==e?void 0:e.terminate)&&(sh.getProvider().handleDisconnect({terminate:!0}),null===(n=null===(t=this.state.pendingModal)||void 0===t?void 0:t.unmount)||void 0===n||n.call(t),this.state.otpAnswer=void 0),null===(r=this.state.connector)||void 0===r||r.disconnect(e)}}class Nh{constructor({debug:e,enabled:t}={debug:!1,enabled:!1}){this.debug=!1,this.enabled=!1,e&&(this.debug=e),this.enabled=t}persistChannelConfig(e){return a(this,void 0,void 0,(function*(){const t=JSON.stringify(e);this.debug&&console.debug(`StorageManagerRN::persistChannelConfig() enabled=${this.enabled}`,e),yield s.setItem(js,t)}))}getPersistedChannelConfig(){return a(this,void 0,void 0,(function*(){let e;try{if(this.debug&&console.debug(`StorageManagerRN::getPersistedChannelConfig() enabled=${this.enabled}`),e=yield s.getItem(js),this.debug&&console.debug("StorageManagerRN::getPersistedChannelConfig()",e),!e)return;const t=JSON.parse(e);return this.debug&&console.debug("StorageManagerRN::getPersisChannel channelConfig",t),t}catch(e){return void console.debug("Can't find existing channel config",e)}}))}terminate(){return a(this,void 0,void 0,(function*(){this.debug&&console.debug(`StorageManagerRN::terminate() enabled=${this.enabled}`),yield s.removeItem(js)}))}}class Lh extends Bs{constructor(e={storage:{enabled:!0},injectProvider:!0,forceInjectProvider:!1,enableDebug:!0,shouldShimWeb3:!0,dappMetadata:{name:"",url:""}}){var t,n;if(super(),this.extensionActive=!1,this._initialized=!1,this.debug=!1,this.setMaxListeners(50),!(null===(t=e.dappMetadata)||void 0===t?void 0:t.name)&&!(null===(n=e.dappMetadata)||void 0===n?void 0:n.url)){if("undefined"==typeof window||"undefined"==typeof document)throw new Error("You must provide dAppMetadata option (name and/or url)");e.dappMetadata={url:window.location.href,name:document.title}}this.options=e,this.init().then((()=>{this.debug&&console.debug("MetaMaskSDK() initialized")})).catch((e=>{console.error("MetaMaskSDK error during initialization",e)}))}init(){return a(this,void 0,void 0,(function*(){if(this._initialized)return this.debug&&console.info("SDK::init() already initialized"),this.sdkInitPromise;if(this.sdkInitPromise)return this.debug&&console.info("SDK::init() already initializing"),this.sdkInitPromise;try{this.sdkInitPromise=this._doInit(),yield this.sdkInitPromise}catch(e){throw console.error(e),e}return this.sdkInitPromise}))}_doInit(){var e,t;return a(this,void 0,void 0,(function*(){const{dappMetadata:n,injectProvider:r=!0,shouldShimWeb3:i=!0,checkInstallationImmediately:o,checkInstallationOnAllCalls:s,preferDesktop:c,openDeeplink:d,useDeeplink:u=!1,wakeLockType:h,communicationLayerPreference:f=As.SOCKET,extensionOnly:l,transports:A,_source:p,timer:b,enableDebug:m=!0,communicationServerUrl:g,modals:v,storage:y={enabled:!0},logging:w={}}=this.options,_=!0===(null==w?void 0:w.developerMode);this.debug=(null==w?void 0:w.sdk)||_,this.debug&&console.debug("SDK::_doInit() now",this.options);const M=Object.assign({},w);_&&(M.sdk=!0,M.eciesLayer=!0,M.keyExchangeLayer=!0,M.remoteLayer=!0,M.serviceLayer=!0),this.platformManager=new lh({useDeepLink:u,preferredOpenLink:d,wakeLockStatus:h,debug:this.debug});const E=this.platformManager.getPlatformType();var S;if(this.analytics=new kh({serverURL:null!=g?g:si,debug:this.debug,metadata:{url:null!==(e=n.url)&&void 0!==e?e:"",title:null!==(t=n.name)&&void 0!==t?t:"",platform:E,source:null!=p?p:""}}),!0!==(null==y?void 0:y.enabled)||y.storageManager||(y.storageManager=new Nh(y)),this.platformManager.isBrowser()&&!n.base64Icon){const e=(()=>{if("undefined"==typeof document)return;let e;const t=document.getElementsByTagName("link");for(let n=0;n<t.length;n++)"icon"!==t[n].getAttribute("rel")&&"shortcut icon"!==t[n].getAttribute("rel")||(e=t[n].getAttribute("href"));return e})();if(e)try{const t=yield(S=e,a(void 0,void 0,void 0,(function*(){const e=yield fetch(S),t=yield e.blob();return new Promise((e=>{const n=new FileReader;n.readAsDataURL(t),n.onloadend=()=>{const t=n.result;e(t)}}))})));n.base64Icon=t}catch(e){}}let k;this.dappMetadata=n;let C=!1;if("undefined"!=typeof window&&window.ethereum&&!this.platformManager.isMetaMaskMobileWebView()){C="extension"===localStorage.getItem(Fs);try{k=function({mustBeMetaMask:e}){if("undefined"==typeof window)throw new Error("window not available");const{ethereum:t}=window;if(!t)throw new Error("Ethereum not found in window object");if(Array.isArray(t.providers)){const n=e?t.providers.find((e=>e.isMetaMask)):t.providers[0];if(!n)throw new Error("No suitable provider found");return n}if(e&&!t.isMetaMask)throw new Error("MetaMask provider not found in Ethereum");return t}({mustBeMetaMask:!0}),window.extension=k}catch(e){delete window.extension}sh.destroy()}else if(this.platformManager.isMetaMaskMobileWebView())return this.analytics.send({event:ws.SDK_USE_INAPP_BROWSER}),this.activeProvider=window.ethereum,void(this._initialized=!0);if(k&&l)return _&&console.warn("EXTENSION ONLY --- prevent sdk initialization"),this.analytics.send({event:ws.SDK_USE_EXTENSION}),this.activeProvider=k,this.extensionActive=!0,void(this._initialized=!0);this.remoteConnection=new Th({communicationLayerPreference:f,analytics:this.analytics,dappMetadata:n,_source:p,enableDebug:m,timer:b,sdk:this,platformManager:this.platformManager,transports:A,communicationServerUrl:g,storage:y,getMetaMaskInstaller:()=>{if(!this.installer)throw new Error("Invalid SDK status -- installer not initialized");return this.installer},logging:M,connectWithExtensionProvider:void 0===k?void 0:this.connectWithExtensionProvider.bind(this),modals:Object.assign(Object.assign({},v),{onPendingModalDisconnect:this.terminate.bind(this)})}),this.installer=new ch({preferDesktop:null!=c&&c,remote:this.remoteConnection,platformManager:this.platformManager,debug:this.debug}),this.activeProvider=vh({communicationLayerPreference:f,platformManager:this.platformManager,sdk:this,checkInstallationOnAllCalls:s,injectProvider:r,shouldShimWeb3:i,installer:this.installer,remoteConnection:this.remoteConnection,debug:this.debug}),this.initEventListeners(),C?(this.debug&&console.debug("SDK::_doInit() preferExtension is detected -- connect with it."),this.connectWithExtensionProvider().catch((e=>{console.warn("Can't connect with MetaMask extension..."),localStorage.removeItem(Fs)}))):o&&(this.platformManager.isDesktopWeb()?(this.debug&&console.debug("SDK::_doInit() checkInstallationImmediately"),this.connect().catch((e=>{this.debug&&console.warn("error during autoconnect",e)}))):console.warn("SDK::_doInit() checkInstallationImmediately --- IGNORED --- only for web desktop")),this._initialized=!0}))}isExtensionActive(){return this.extensionActive}connect(){return a(this,void 0,void 0,(function*(){if(this._initialized||(this.debug&&console.log("SDK::connect() provider not ready -- wait for init()"),yield this.init()),this.debug&&console.debug("SDK::connect()",this.activeProvider),!this.activeProvider)throw new Error("SDK state invalid -- undefined provider");return this.activeProvider.request({method:"eth_requestAccounts",params:[]})}))}initEventListeners(){var e,t,n,r;null===(t=null===(e=this.remoteConnection)||void 0===e?void 0:e.getConnector())||void 0===t||t.on(ti.CONNECTION_STATUS,(e=>{this.emit(ti.CONNECTION_STATUS,e)})),null===(r=null===(n=this.remoteConnection)||void 0===n?void 0:n.getConnector())||void 0===r||r.on(ti.SERVICE_STATUS,(e=>{this.emit(ti.SERVICE_STATUS,e)}))}connectWithExtensionProvider(){var e,t;return a(this,void 0,void 0,(function*(){this.debug&&console.debug("SDK::connectWithExtensionProvider()"),this.sdkProvider=this.activeProvider,this.activeProvider=window.extension,window.ethereum=window.extension;try{yield null===(e=this.activeProvider)||void 0===e?void 0:e.request({method:"eth_requestAccounts"})}catch(e){return void console.warn("SDK::connectWithExtensionProvider() can't request accounts error",e)}localStorage.setItem(Fs,"extension"),this.extensionActive=!0,this.emit(ti.PROVIDER_UPDATE,gh.EXTENSION),null===(t=this.analytics)||void 0===t||t.send({event:ws.SDK_USE_EXTENSION})}))}resume(){var e,t,n;(null===(t=null===(e=this.remoteConnection)||void 0===e?void 0:e.getConnector())||void 0===t?void 0:t.isReady())||(this.debug&&console.debug("SDK::resume channel"),null===(n=this.remoteConnection)||void 0===n||n.startConnection())}disconnect(){var e;null===(e=this.remoteConnection)||void 0===e||e.disconnect()}isAuthorized(){var e;null===(e=this.remoteConnection)||void 0===e||e.isAuthorized()}terminate(){var e,t;if(!(null===(e=this.platformManager)||void 0===e?void 0:e.isMetaMaskMobileWebView())){if(this.extensionActive)return localStorage.removeItem(Fs),this.options.extensionOnly?void(this.debug&&console.warn("SDK::terminate() extensionOnly --- prevent switching providers")):(this.activeProvider=this.sdkProvider,window.ethereum=this.activeProvider,this.extensionActive=!1,void this.emit(ti.PROVIDER_UPDATE,gh.TERMINATE));this.emit(ti.PROVIDER_UPDATE,gh.TERMINATE),this.debug&&console.debug("SDK::terminate()",this.remoteConnection),null===(t=this.remoteConnection)||void 0===t||t.disconnect({terminate:!0,sendMessage:!0}),this._initialized=!1}}isInitialized(){return this._initialized}getProvider(){if(!this.activeProvider)throw new Error("SDK state invalid -- undefined provider");return this.activeProvider}getUniversalLink(){var e;const t=null===(e=this.remoteConnection)||void 0===e?void 0:e.getUniversalLink();if(!t)throw new Error("No Universal Link available, please call eth_requestAccounts first.");return t}_getChannelConfig(){var e;return null===(e=this.remoteConnection)||void 0===e?void 0:e.getChannelConfig()}_ping(){var e,t;null===(t=null===(e=this.remoteConnection)||void 0===e?void 0:e.getConnector())||void 0===t||t.ping()}_keyCheck(){var e,t;null===(t=null===(e=this.remoteConnection)||void 0===e?void 0:e.getConnector())||void 0===t||t.keyCheck()}_getServiceStatus(){var e,t;return null===(t=null===(e=this.remoteConnection)||void 0===e?void 0:e.getConnector())||void 0===t?void 0:t.getServiceStatus()}_getRemoteConnection(){return this.remoteConnection}_getDappMetadata(){return this.dappMetadata}_getKeyInfo(){var e;return null===(e=this.remoteConnection)||void 0===e?void 0:e.getKeyInfo()}_resetKeys(){var e,t;null===(t=null===(e=this.remoteConnection)||void 0===e?void 0:e.getConnector())||void 0===t||t.resetKeys()}_getConnection(){return this.remoteConnection}}export{_s as AutoConnectType,As as CommunicationLayerPreference,ui as ConnectionStatus,si as DEFAULT_SERVER_URL,Jr as ECIES,ti as EventType,ni as MessageType,Lh as MetaMaskSDK,gh as PROVIDER_UPDATE_TYPE,ps as PlatformType,Rs as RemoteCommunication,oh as SDKProvider,ys as SendAnalytics,ls as SocketService,ws as TrackingEvents,Lh as default};
//# sourceMappingURL=metamask-sdk.js.map
